!function(r){var t={};function e(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return r[n].call(a.exports,a,a.exports,e),a.l=!0,a.exports}e.m=r,e.c=t,e.d=function(r,t,n){e.o(r,t)||Object.defineProperty(r,t,{configurable:!1,enumerable:!0,get:n})},e.r=function(r){Object.defineProperty(r,"__esModule",{value:!0})},e.n=function(r){var t=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(t,"a",t),t},e.o=function(r,t){return Object.prototype.hasOwnProperty.call(r,t)},e.p="",e(e.s=87)}([function(r,t,e){"use strict";t.__=function(r,t){return t.tag=r,t}},function(r,t,e){"use strict";var n=e(6);function a(r,t){for(;;){var e=t,i=r,o=i.length||1,c=o-e.length|0;if(c){if(c<0){t=n.caml_array_sub(e,o,0|-c),r=i.apply(null,n.caml_array_sub(e,0,o));continue}return function(r,t){return function(e){return a(r,t.concat([e]))}}(i,e)}return i.apply(null,e)}}function i(r,t,e){if(e>7||e<0)return a(r,[t]);switch(e){case 0:case 1:return r(t);case 2:return function(e){return r(t,e)};case 3:return function(e,n){return r(t,e,n)};case 4:return function(e,n,a){return r(t,e,n,a)};case 5:return function(e,n,a,i){return r(t,e,n,a,i)};case 6:return function(e,n,a,i,o){return r(t,e,n,a,i,o)};case 7:return function(e,n,a,i,o,c){return r(t,e,n,a,i,o,c)}}}function o(r,t){var e=r.length;return 1===e?r(t):i(r,t,e)}function c(r,t,e,n){if(n>7||n<0)return a(r,[t,e]);switch(n){case 0:case 1:return a(r(t),[e]);case 2:return r(t,e);case 3:return function(n){return r(t,e,n)};case 4:return function(n,a){return r(t,e,n,a)};case 5:return function(n,a,i){return r(t,e,n,a,i)};case 6:return function(n,a,i,o){return r(t,e,n,a,i,o)};case 7:return function(n,a,i,o,c){return r(t,e,n,a,i,o,c)}}}function u(r,t,e){var n=r.length;return 2===n?r(t,e):c(r,t,e,n)}function f(r,t,e,n,i){var o=0;if(i>7||i<0)return a(r,[t,e,n]);switch(i){case 0:case 1:o=1;break;case 2:return a(r(t,e),[n]);case 3:return r(t,e,n);case 4:return function(a){return r(t,e,n,a)};case 5:return function(a,i){return r(t,e,n,a,i)};case 6:return function(a,i,o){return r(t,e,n,a,i,o)};case 7:return function(a,i,o,c){return r(t,e,n,a,i,o,c)}}return 1===o?a(r(t),[e,n]):void 0}function s(r,t,e,n){var a=r.length;return 3===a?r(t,e,n):f(r,t,e,n,a)}function _(r,t,e,n,i,o){var c=0;if(o>7||o<0)return a(r,[t,e,n,i]);switch(o){case 0:case 1:c=1;break;case 2:return a(r(t,e),[n,i]);case 3:return a(r(t,e,n),[i]);case 4:return r(t,e,n,i);case 5:return function(a){return r(t,e,n,i,a)};case 6:return function(a,o){return r(t,e,n,i,a,o)};case 7:return function(a,o,c){return r(t,e,n,i,a,o,c)}}return 1===c?a(r(t),[e,n,i]):void 0}function l(r,t,e,n,a){var i=r.length;return 4===i?r(t,e,n,a):_(r,t,e,n,a,i)}function m(r,t,e,n,i,o,c){var u=0;if(c>7||c<0)return a(r,[t,e,n,i,o]);switch(c){case 0:case 1:u=1;break;case 2:return a(r(t,e),[n,i,o]);case 3:return a(r(t,e,n),[i,o]);case 4:return a(r(t,e,n,i),[o]);case 5:return r(t,e,n,i,o);case 6:return function(a){return r(t,e,n,i,o,a)};case 7:return function(a,c){return r(t,e,n,i,o,a,c)}}return 1===u?a(r(t),[e,n,i,o]):void 0}function v(r,t,e,n,a,i){var o=r.length;return 5===o?r(t,e,n,a,i):m(r,t,e,n,a,i,o)}function d(r,t,e,n,i,o,c,u){var f=0;if(u>7||u<0)return a(r,[t,e,n,i,o,c]);switch(u){case 0:case 1:f=1;break;case 2:return a(r(t,e),[n,i,o,c]);case 3:return a(r(t,e,n),[i,o,c]);case 4:return a(r(t,e,n,i),[o,c]);case 5:return a(r(t,e,n,i,o),[c]);case 6:return r(t,e,n,i,o,c);case 7:return function(a){return r(t,e,n,i,o,c,a)}}return 1===f?a(r(t),[e,n,i,o,c]):void 0}function g(r,t,e,n,a,i,o){var c=r.length;return 6===c?r(t,e,n,a,i,o):d(r,t,e,n,a,i,o,c)}function h(r,t,e,n,i,o,c,u,f){var s=0;if(f>7||f<0)return a(r,[t,e,n,i,o,c,u]);switch(f){case 0:case 1:s=1;break;case 2:return a(r(t,e),[n,i,o,c,u]);case 3:return a(r(t,e,n),[i,o,c,u]);case 4:return a(r(t,e,n,i),[o,c,u]);case 5:return a(r(t,e,n,i,o),[c,u]);case 6:return a(r(t,e,n,i,o,c),[u]);case 7:return r(t,e,n,i,o,c,u)}return 1===s?a(r(t),[e,n,i,o,c,u]):void 0}function y(r,t,e,n,a,i,o,c){var u=r.length;return 7===u?r(t,e,n,a,i,o,c):h(r,t,e,n,a,i,o,c,u)}function p(r,t,e,n,i,o,c,u,f,s){var _=0;if(s>7||s<0)return a(r,[t,e,n,i,o,c,u,f]);switch(s){case 0:case 1:_=1;break;case 2:return a(r(t,e),[n,i,o,c,u,f]);case 3:return a(r(t,e,n),[i,o,c,u,f]);case 4:return a(r(t,e,n,i),[o,c,u,f]);case 5:return a(r(t,e,n,i,o),[c,u,f]);case 6:return a(r(t,e,n,i,o,c),[u,f]);case 7:return a(r(t,e,n,i,o,c,u),[f])}return 1===_?a(r(t),[e,n,i,o,c,u,f]):void 0}function b(r,t,e,n,a,i,o,c,u){var f=r.length;return 8===f?r(t,e,n,a,i,o,c,u):p(r,t,e,n,a,i,o,c,u,f)}t.app=a,t.curry_1=i,t._1=o,t.__1=function(r){return 1===r.length?r:function(t){return o(r,t)}},t.curry_2=c,t._2=u,t.__2=function(r){return 2===r.length?r:function(t,e){return u(r,t,e)}},t.curry_3=f,t._3=s,t.__3=function(r){return 3===r.length?r:function(t,e,n){return s(r,t,e,n)}},t.curry_4=_,t._4=l,t.__4=function(r){return 4===r.length?r:function(t,e,n,a){return l(r,t,e,n,a)}},t.curry_5=m,t._5=v,t.__5=function(r){return 5===r.length?r:function(t,e,n,a,i){return v(r,t,e,n,a,i)}},t.curry_6=d,t._6=g,t.__6=function(r){return 6===r.length?r:function(t,e,n,a,i,o){return g(r,t,e,n,a,i,o)}},t.curry_7=h,t._7=y,t.__7=function(r){return 7===r.length?r:function(t,e,n,a,i,o,c){return y(r,t,e,n,a,i,o,c)}},t.curry_8=p,t._8=b,t.__8=function(r){return 8===r.length?r:function(t,e,n,a,i,o,c,u){return b(r,t,e,n,a,i,o,c,u)}}},function(r,t,e){"use strict";var n=e(1),a=e(45),i=e(11),o=e(43),c=e(18),u=e(9),f=e(16),s=e(17),_=e(3),l=e(41),m=f.create("Pervasives.Exit");function v(r,t){return r+t}function d(r){for(var t=r.length,e=0;;){var n=e;if(n>=t)return v(r,".");var a=u.get(r,n);if(a>=48){if(a>=58)return r;e=n+1|0}else{if(45!==a)return r;e=n+1|0}}}var g=a.stdin,h=a.stdout,y=a.stderr;function p(r,t,e){return a.caml_ml_open_descriptor_out(s.not_implemented("caml_sys_open not implemented by bucklescript yet\n"))}function b(){for(var r=a.caml_ml_out_channels_list(0);;){var t=r;if(!t)return 0;try{a.caml_ml_flush(t[0])}catch(r){}r=t[1]}}function w(r,t){return a.caml_ml_output(r,t,0,t.length)}function x(r,t){return a.caml_ml_output(r,t,0,t.length)}function k(r,t,e){return a.caml_ml_open_descriptor_in(s.not_implemented("caml_sys_open not implemented by bucklescript yet\n"))}function M(r,t,e,n){for(;;){var a=n,i=e;if(a<=0)return 0;var o=s.not_implemented("caml_ml_input not implemented by bucklescript yet\n");if(!o)throw _.end_of_file;n=a-o|0,e=i+o|0}}function S(r,t,e,n){if(e<0||n<0||e>(t.length-n|0))throw[_.invalid_argument,"really_input"];return M(0,0,e,n)}function C(r){var t=function(r,t,e){for(;;){var n=e,a=t;if(!n)return r;var i=n[0],o=i.length;u.caml_blit_bytes(i,0,r,a-o|0,o),e=n[1],t=a-o|0}};return u.bytes_to_string(function(e,n){for(;;){var i=n,o=e,c=s.not_implemented("caml_ml_input_scan_line not implemented by bucklescript yet\n");if(!c){if(o)return t(u.caml_create_string(i),i,o);throw _.end_of_file}if(c>0){var f=u.caml_create_string(c-1|0);if(s.not_implemented("caml_ml_input not implemented by bucklescript yet\n"),a.caml_ml_input_char(r),o){var l=(i+c|0)-1|0;return t(u.caml_create_string(l),l,[f,o])}return f}var m=u.caml_create_string(0|-c);s.not_implemented("caml_ml_input not implemented by bucklescript yet\n"),n=i-c|0,e=[m,o]}}(0,0))}var P=[b];function T(){return n._1(P[0],0)}var A=Number.MAX_VALUE,D=Number.MIN_VALUE,V=a.caml_ml_flush,U=a.caml_ml_output_char,N=a.caml_ml_output_char,L=a.caml_ml_input_char,B=a.caml_ml_input_char,F=[function(r,t){return s.not_implemented("caml_ml_seek_out_64 not implemented by bucklescript yet\n")},function(){return s.not_implemented("caml_ml_pos_out_64 not implemented by bucklescript yet\n")},function(){return s.not_implemented("caml_ml_channel_size_64 not implemented by bucklescript yet\n")},function(r,t){return s.not_implemented("caml_ml_seek_in_64 not implemented by bucklescript yet\n")},function(){return s.not_implemented("caml_ml_pos_in_64 not implemented by bucklescript yet\n")},function(){return s.not_implemented("caml_ml_channel_size_64 not implemented by bucklescript yet\n")}];t.invalid_arg=function(r){throw[_.invalid_argument,r]},t.failwith=function(r){throw[_.failure,r]},t.Exit=m,t.min=function(r,t){return i.caml_lessequal(r,t)?r:t},t.max=function(r,t){return i.caml_greaterequal(r,t)?r:t},t.abs=function(r){return r>=0?r:0|-r},t.max_int=2147483647,t.min_int=-2147483648,t.lnot=function(r){return-1^r},t.infinity=1/0,t.neg_infinity=-1/0,t.nan=NaN,t.max_float=A,t.min_float=D,t.epsilon_float=2.220446049250313e-16,t.$caret=v,t.char_of_int=function(r){if(r<0||r>255)throw[_.invalid_argument,"char_of_int"];return r},t.string_of_bool=function(r){return r?"true":"false"},t.bool_of_string=function(r){switch(r){case"false":return 0;case"true":return 1;default:throw[_.invalid_argument,"bool_of_string"]}},t.string_of_int=function(r){return""+r},t.string_of_float=function(r){return d(c.caml_format_float("%.12g",r))},t.$at=function r(t,e){return t?[t[0],r(t[1],e)]:e},t.stdin=g,t.stdout=h,t.stderr=y,t.print_char=function(r){return a.caml_ml_output_char(h,r)},t.print_string=function(r){return x(h,r)},t.print_bytes=function(r){return w(h,r)},t.print_int=function(r){return x(h,""+r)},t.print_float=function(r){return x(h,d(c.caml_format_float("%.12g",r)))},t.print_endline=function(r){return console.log(r),0},t.print_newline=function(){return a.caml_ml_output_char(h,10),a.caml_ml_flush(h)},t.prerr_char=function(r){return a.caml_ml_output_char(y,r)},t.prerr_string=function(r){return x(y,r)},t.prerr_bytes=function(r){return w(y,r)},t.prerr_int=function(r){return x(y,""+r)},t.prerr_float=function(r){return x(y,d(c.caml_format_float("%.12g",r)))},t.prerr_endline=function(r){return console.error(r),0},t.prerr_newline=function(){return a.caml_ml_output_char(y,10),a.caml_ml_flush(y)},t.read_line=function(){return a.caml_ml_flush(h),C(g)},t.read_int=function(){return c.caml_int_of_string((a.caml_ml_flush(h),C(g)))},t.read_float=function(){return c.caml_float_of_string((a.caml_ml_flush(h),C(g)))},t.open_out=function(r){return p()},t.open_out_bin=function(r){return p()},t.open_out_gen=p,t.flush=V,t.flush_all=b,t.output_char=U,t.output_string=x,t.output_bytes=w,t.output=function(r,t,e,n){if(e<0||n<0||e>(t.length-n|0))throw[_.invalid_argument,"output"];return a.caml_ml_output(r,t,e,n)},t.output_substring=function(r,t,e,n){if(e<0||n<0||e>(t.length-n|0))throw[_.invalid_argument,"output_substring"];return a.caml_ml_output(r,t,e,n)},t.output_byte=N,t.output_binary_int=function(r,t){return s.not_implemented("caml_ml_output_int not implemented by bucklescript yet\n")},t.output_value=function(r,t){return s.not_implemented("caml_output_value not implemented by bucklescript yet\n")},t.seek_out=function(r,t){return s.not_implemented("caml_ml_seek_out not implemented by bucklescript yet\n")},t.pos_out=function(){return s.not_implemented("caml_ml_pos_out not implemented by bucklescript yet\n")},t.out_channel_length=function(){return s.not_implemented("caml_ml_channel_size not implemented by bucklescript yet\n")},t.close_out=function(r){return a.caml_ml_flush(r),s.not_implemented("caml_ml_close_channel not implemented by bucklescript yet\n")},t.close_out_noerr=function(r){try{a.caml_ml_flush(r)}catch(r){}try{return s.not_implemented("caml_ml_close_channel not implemented by bucklescript yet\n")}catch(r){return 0}},t.set_binary_mode_out=function(r,t){return s.not_implemented("caml_ml_set_binary_mode not implemented by bucklescript yet\n")},t.open_in=function(r){return k()},t.open_in_bin=function(r){return k()},t.open_in_gen=k,t.input_char=L,t.input_line=C,t.input=function(r,t,e,n){if(e<0||n<0||e>(t.length-n|0))throw[_.invalid_argument,"input"];return s.not_implemented("caml_ml_input not implemented by bucklescript yet\n")},t.really_input=S,t.really_input_string=function(r,t){var e=u.caml_create_string(t);return S(0,e,0,t),u.bytes_to_string(e)},t.input_byte=B,t.input_binary_int=function(){return s.not_implemented("caml_ml_input_int not implemented by bucklescript yet\n")},t.input_value=function(){return s.not_implemented("caml_input_value not implemented by bucklescript yet\n")},t.seek_in=function(r,t){return s.not_implemented("caml_ml_seek_in not implemented by bucklescript yet\n")},t.pos_in=function(){return s.not_implemented("caml_ml_pos_in not implemented by bucklescript yet\n")},t.in_channel_length=function(){return s.not_implemented("caml_ml_channel_size not implemented by bucklescript yet\n")},t.close_in=function(){return s.not_implemented("caml_ml_close_channel not implemented by bucklescript yet\n")},t.close_in_noerr=function(){try{return s.not_implemented("caml_ml_close_channel not implemented by bucklescript yet\n")}catch(r){return 0}},t.set_binary_mode_in=function(r,t){return s.not_implemented("caml_ml_set_binary_mode not implemented by bucklescript yet\n")},t.LargeFile=F,t.string_of_format=function(r){return r[1]},t.$caret$caret=function(r,t){return[l.concat_fmt(r[0],t[0]),v(r[1],v("%,",t[1]))]},t.exit=function(r){return T(),o.caml_sys_exit(r)},t.at_exit=function(r){var t=P[0];return P[0]=function(){return n._1(r,0),n._1(t,0)},0},t.valid_float_lexem=d,t.unsafe_really_input=M,t.do_at_exit=T},function(r,t,e){"use strict";var n=["Out_of_memory",0],a=["Sys_error",-1],i=["Failure",-2],o=["Invalid_argument",-3],c=["End_of_file",-4],u=["Division_by_zero",-5],f=["Not_found",-6],s=["Match_failure",-7],_=["Stack_overflow",-8],l=["Sys_blocked_io",-9],m=["Assert_failure",-10],v=["Undefined_recursive_module",-11];n.tag=248,a.tag=248,i.tag=248,o.tag=248,c.tag=248,u.tag=248,f.tag=248,s.tag=248,_.tag=248,l.tag=248,m.tag=248,v.tag=248,t.out_of_memory=n,t.sys_error=a,t.failure=i,t.invalid_argument=o,t.end_of_file=c,t.division_by_zero=u,t.not_found=f,t.match_failure=s,t.stack_overflow=_,t.sys_blocked_io=l,t.assert_failure=m,t.undefined_recursive_module=v},function(r,t,e){"use strict";var n=e(10),a=e(7),i=e(12),o=e(0),c=e(1),u=e(26),f=e(6),s=e(8),_=e(39),l=e(2),m=e(25);function v(r){switch(r){case 0:case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 9;case 6:return 16}}function d(r){return 1!==r?4:2}function g(r){return 1!==r?m.float_:m.unsigned_short}var h=[v,d,g],y=[1];function p(){var r=y[0];return y[0]=r+1|0,r}function b(r){switch(0|r.tag){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6}}function w(r,t,e){var n=[r[1],c._3(u.Gl[40],t,e,r[0]),r[2]];return r[3]=[n],n}function x(r,t){var e=r[2];switch(0|e.tag){case 0:return t.uniform1f(r[1],e[0][0]),0;case 1:return t.uniform1i(r[1],e[0][0]),0;case 2:var n=e[0][0];return t.uniform2f(r[1],f.caml_array_get(n,0),f.caml_array_get(n,1)),0;case 3:var a=e[0][0];return t.uniform3f(r[1],f.caml_array_get(a,0),f.caml_array_get(a,1),f.caml_array_get(a,2)),0;case 4:var i=e[0][0];return t.uniform4f(r[1],f.caml_array_get(i,0),f.caml_array_get(i,1),f.caml_array_get(i,2),f.caml_array_get(i,3)),0;case 5:var o=e[0][0];return t.uniformMatrix3fv(r[1],!1,o),0;case 6:var c=e[0][0];return t.uniformMatrix4fv(r[1],!1,c),0}}var k=[b,function(r){switch(r){case 0:return o.__(0,[[0]]);case 1:return o.__(1,[[0]]);case 2:return o.__(2,[[n.Vec2[6](0)]]);case 3:return o.__(3,[[n.Vec3[10](0)]]);case 4:return o.__(4,[[n.Vec4[3](0)]]);case 5:return o.__(5,[[n.Mat3[7](0)]]);case 6:return o.__(6,[[n.Mat4[4](0)]])}},function(r,t){return[r,b(t),t,0]},w,function(r,t,e){return c._3(u.Gl[40],r,t,e)},function(r,t,e){return[r,e,t]},function(r,t){return r.tag?l.failwith("Uniform not float"):(r[0][0]=t,0)},function(r,t){return 2===r.tag?(r[0][0]=t,0):l.failwith("Uniform not vec2f")},function(r,t){return 3===r.tag?(r[0][0]=t,0):l.failwith("Uniform not vec3f")},function(r,t){return 4===r.tag?(r[0][0]=t,0):l.failwith("Uniform not vec4f")},function(r,t){return 5===r.tag?(r[0][0]=t,0):l.failwith("Uniform not mat3")},x];function M(r,t,e,n,a,i){return[c._3(u.Gl[41],t,e,r[0]),n,a,i,g(r[1])]}function S(r,t){return t.vertexAttribPointer(r[0],r[1],r[4],!1,r[2],r[3]),0}var C=[function(r,t){return[r,t]},M,S];function P(r,t,e){var n=c._2(u.Gl[8],r,t);return u.Gl[11](r,n,e),c._2(u.Gl[12],r,n),+(1===u.Gl[48](r,n,1))?[n]:(console.log("Shader compilation failed: "+c._2(u.Gl[49],r,n)),console.log(e),0)}var T=[function(r){return[r]},P];function A(r,t,e){var n=P(r,m.vertex_shader,t),a=P(r,m.fragment_shader,e);if(n){if(a){var i=a[0],o=n[0],f=c._1(u.Gl[7],r);return c._3(u.Gl[9],r,f,o),c._2(u.Gl[10],r,o),c._3(u.Gl[9],r,f,i),c._2(u.Gl[10],r,i),c._2(u.Gl[13],r,f),+(1===u.Gl[47](r,f,1))?[f]:(console.log("GlProgram linking failed"),0)}return 0}return 0}function D(r,t,e){var n=a.fold_left(function(r,t){return r+s.imul(v(t[1]),d(t[1]))|0},0,r),i=[0];return a.map(function(r){var a=v(r[1]),o=s.imul(a,d(r[1])),c=M(r,t,e,a,n,i[0]);return i[0]=i[0]+o|0,c},r)}function V(r,t){var e=A(t,r[0][0],r[1][0]);if(e){var n=e[0],i=a.map(function(r){return w(r,t,n)},r[3]),o=D(r[2],t,n);return[[p(),n,o,i]]}return 0}var U=[function(r,t,e,n){return[r,t,e,n,a.fold_left(function(r,t){return r+v(t[1])|0},0,e)]},A,D,V,function(r,t){return[r[0],r[1],r[2],t]}];function N(r,t,e,n){var a=-1+e,i=a+r,o=1-n,c=o-t;return[a,c,i,c,i,o,a,o]}function L(r,t,e){var n=t?t[0]:0;return[r?r[0]:N(2,2,0,0),n,[["position",2],0],2,0]}function B(r,t){return r[2]=t,r[5]=t.length,r[4]=1,0}function F(r,t){var e=r[4];return e?B(e[0],t):(r[0]=t,0)}function I(r,t){var e;switch(r[5]=r[2].length,r[6]){case 0:e=m.static_draw;break;case 1:e=m.dynamic_draw;break;case 2:e=m.stream_draw}return t.bufferData(m.array_buffer,c._2(u.Gl[24][1],1,r[2]),e),0}function z(r,t,e){var n=r[4];if(n)return n[0];var a,i=c._1(u.Gl[15],t);switch(t.bindBuffer(m.array_buffer,i),r[1]){case 0:a=m.static_draw;break;case 1:a=m.dynamic_draw;break;case 2:a=m.stream_draw}t.bufferData(m.array_buffer,c._2(u.Gl[24][1],1,r[0]),a);var o=[p(),i,r[0],r[3],0,r[0].length,r[1]];return e[1]=o[0],r[4]=[o],o}var E=[function(r,t,e){return[r,e,t,a.fold_left(function(r,t){return r+v(t[1])|0},0,t),0]},function(r){return a.map(function(r){return[r[0],r[1]]},r[2])},N,function(){return[["position",2],0]},L,B,F,I,z,function(r,t){return r.deleteBuffer(t[1]),0}];function q(r){var t=f.caml_make_vect(s.imul(r,6),0);return function(e){for(;;){var n=e;if(!(n<r))return 0;var a=n<<2,i=s.imul(n,6);f.caml_array_set(t,i,0+a|0),f.caml_array_set(t,i+1|0,1+a|0),f.caml_array_set(t,i+2|0,2+a|0),f.caml_array_set(t,i+3|0,0+a|0),f.caml_array_set(t,i+4|0,2+a|0),f.caml_array_set(t,i+5|0,3+a|0),e=n+1|0}}(0),t}function R(r,t){return r[2]=t,r[4]=t.length,r[3]=1,0}function G(r,t){var e=r[2];return e?R(e[0],t):(r[0]=t,0)}function H(r){var t,e=r[6];switch(r[4]=r[2].length,r[5]){case 0:t=m.static_draw;break;case 1:t=m.dynamic_draw;break;case 2:t=m.stream_draw}return e.bufferData(m.element_array_buffer,c._2(u.Gl[24][1],3,r[2]),t),0}function O(r,t,e){var n=r[2];if(n)return n[0];var a,i=c._1(u.Gl[15],t);switch(t.bindBuffer(m.element_array_buffer,i),r[1]){case 0:a=m.static_draw;break;case 1:a=m.dynamic_draw;break;case 2:a=m.stream_draw}t.bufferData(m.element_array_buffer,c._2(u.Gl[24][1],3,r[0]),a);var o=[p(),i,r[0],0,r[0].length,r[1],t];return e[2]=o[0],r[2]=[o],o}var K=[function(r,t){return[r,t,0]},function(){return[[0,1,2,0,2,3],0,0]},q,R,G,H,O,function(r,t){return r.deleteBuffer(t[1]),0}],j=[function(r,t){return[r,t]},function(r,t){var e=r?r[0]:0;return[L(0,[e]),[[q(1),e,0]]]},function(r,t){F(r[0],t);var e=r[0][3]<<2,n=r[1];return n?G(n[0],q(s.div(t.length,e))):0}];function W(r,t,e){return[r,t,e,0]}function $(r,t){var e=r[3];if(e)return e[0];var n,a=c._1(u.Gl[17],t),i=0!==r[2]?m.nearest:m.linear;switch(c._3(u.Gl[19],t,m.texture_2d,a),c._4(u.Gl[20],t,m.texture_2d,m.texture_wrap_s,m.clamp_to_edge),c._4(u.Gl[20],t,m.texture_2d,m.texture_wrap_t,m.clamp_to_edge),c._4(u.Gl[20],t,m.texture_2d,m.texture_min_filter,i),c._4(u.Gl[20],t,m.texture_2d,m.texture_mag_filter,i),r[1]){case 0:n=6409;break;case 1:n=6406;break;case 2:n=m.rgb;break;case 3:n=m.rgba}r[1]||t.pixelStorei(3317,1);var o=r[0];if("number"!=typeof o)if(o.tag){var f=o[0];t.texImage2D(m.texture_2d,0,n,o[1],o[2],0,n,m.unsigned_byte,f?c._2(u.Gl[24][1],5,f[0]):null)}else u.Gl[30](t,m.texture_2d,0,o[0]);var s=[p(),a,r[0],0,n,t];return r[3]=[s],s}function X(r,t){var e=r[3];if(e){var n=e[0];return c._3(u.Gl[19],t,m.texture_2d,n[1]),n}return $(r,t)}function Q(r){var t=r[5];c._3(u.Gl[19],t,m.texture_2d,r[1]);var e=r[2];if("number"!=typeof e)if(e.tag){var n=e[0];t.texImage2D(m.texture_2d,0,r[4],e[1],e[2],0,r[4],m.unsigned_byte,n?c._2(u.Gl[24][1],5,n[0]):null)}else u.Gl[30](t,m.texture_2d,0,e[0]);return r[3]=0,0}var Y=[W,function(r,t){var e=r[3];if(e){var n=e[0];return n[2]=t,n[3]=1,0}return r[0]=t,0},function(r){var t=r[3],e=t?t[0][2]:r[0];return"number"!=typeof e&&e.tag?[[e[1],e[2]]]:0},6409,6406,3317,function(r,t,e,n){var a=r?r[0]:128,i=t?t[0]:128,c=e?e[0]:0;return W(o.__(1,[0,a,i]),3,c)},function(r,t,e,n){var a=r?r[0]:128,i=t?t[0]:128,c=e?e[0]:0;return W(o.__(1,[0,a,i]),2,c)},function(r,t,e,n){var a=r?r[0]:128,i=t?t[0]:128,c=e?e[0]:0;return W(o.__(1,[0,a,i]),1,c)},$,X,function(r,t,e,n){var a=r[0];if("number"==typeof a)return l.failwith("Need int data texture to resize");if(a.tag){if(a[1]<e||a[2]<n){var _,v=a[0],d=l.max(e,n),g=function(r){for(;;){var t=r;if(d<=t)return t;r=t<<1}}(1),h=X(r,t),y=function(r,t){var e=r.length;return i.init(t,function(t){return t<e?f.caml_array_get(r,t):0})};if(v){var p=v[0],b=r[1];if(2!==b)if(b>=3){var w=y(p,s.imul(g,g)<<2);h[2]=o.__(1,[[w],g,g]),r[0]=h[2],_=c._2(u.Gl[24][1],5,w)}else{var x=y(p,s.imul(g,g));h[2]=o.__(1,[[x],g,g]),r[0]=h[2],_=c._2(u.Gl[24][1],5,x)}else{var k=y(p,s.imul(s.imul(g,g),3));h[2]=o.__(1,[[k],g,g]),r[0]=h[2],_=c._2(u.Gl[24][1],5,k)}}else h[2]=o.__(1,[0,g,g]),r[0]=h[2],_=null;return t.texImage2D(m.texture_2d,0,h[4],g,g,0,h[4],m.unsigned_byte,_),0}return 0}return l.failwith("Need int data texture to resize")},Q];function Z(r,t,e){var n=r[2];if(n)return n[0];var a=$(r[1],t),i=c._3(u.Gl[40],t,e,r[0]),o=[p(),a,i];return r[2]=[o],o}var J=[function(r,t){return[r,t,0]},Z,function(r,t,e){return c._3(u.Gl[40],t,e,r)},function(r,t,e){if(r[2])return l.failwith("Init from ref already inited");var n=$(r[1],t),a=[p(),n,e];return r[2]=[a],a}],rr=[36160,36064,function(r,t){return[r,t,0]},function(r,t){var e=r[2];if(e)return e[0];var n=t.createFramebuffer(),a=[r[0],r[1],n];return r[2]=[a],a},function(r,t,e){var n=$(e,t);return t.bindFramebuffer(36160,r[2]),t.framebufferTexture2D(36160,36064,m.texture_2d,n[1],0),0}];function tr(r){var t=r.getError();if(0===t)return 0;if(t>=1287)return 37442!==t?[t]:6;if(!(t>=1280))return[t];switch(t-1280|0){case 0:return 1;case 1:return 2;case 2:return 3;case 3:case 4:return[t];case 5:return 5;case 6:return 4}}function er(r){var t=tr(r);if("number"!=typeof t)return["Other error: "+l.string_of_int(t[0])];switch(t){case 0:return 0;case 1:return["Invalid enum"];case 2:return["Invalid value"];case 3:return["Invalid operation"];case 4:return["Invalid framebuffer operation"];case 5:return["Out of memory"];case 6:return["Context lost webgl"]}}var nr=[tr,er],ar=window;function ir(r,t){var e=c._1(u.Gl[2][5],[]);c._3(u.Gl[2][6],e,r,t);var n=e[0].getContext("webgl",{preserveDrawingBuffer:1,antialias:1,stencil:1});return n.enable(2884),c._5(u.Gl[38],n,0,0,r,t),[n,[0,0,0,[]],0,0,r,t,[65],e]}function or(r,t,e){var n=r[0],i=r[1];return i[0]!==t[0]&&(c._2(u.Gl[14],n,t[1]),a.iter(function(r){return S(r,n),n.enableVertexAttribArray(r[0]),0},t[2]),i[0]=t[0]),i[1]!==e[0]&&(n.bindBuffer(m.array_buffer,e[1]),i[1]=e[0]),c._4(u.Gl[52],n,m.triangles,0,e[5])}function cr(r,t,e,n,o){var c,u=r[0],s=r[1],_=s[0]!==t[0]?(u.useProgram(t[1]),s[0]=t[0],1):0;a.iter(function(r){return x(r,u)},t[3]),s[1]!==e[0]?(u.bindBuffer(m.array_buffer,e[1]),e[4]&&I(e,u),s[1]=e[0],c=1):c=0,(_||c)&&a.iter(function(r){return S(r,u),u.enableVertexAttribArray(r[0]),0},t[2]),s[2]!==n[0]&&(u.bindBuffer(m.element_array_buffer,n[1]),n[3]&&H(n),s[2]=n[0]);var l=s[3].length;s[3]=i.mapi(function(r,t){var e=r>(l-1|0)||f.caml_array_get(s[3],r)!==t[0]?(u.uniform1i(t[2],r),u.activeTexture(m.texture0+r|0),u.bindTexture(m.texture_2d,t[1][1]),1):0;return t[1][3]&&(e||(u.activeTexture(m.texture0+r|0),u.bindTexture(m.texture_2d,t[1][1])),Q(t[1])),t[0]},o),u.drawElements(m.triangles,n[4],m.unsigned_short,0);var v=er(u);return v?(console.log(v[0]),0):0}var ur=[ar,function(){return[0|ar.innerWidth,0|ar.innerHeight]},2884,ir,function(r,t,e){return c._3(u.Gl[2][6],r[7],t,e),c._5(u.Gl[38],r[0],0,0,t,e),r[4]=t,r[5]=e,0},function(r,t,e,n,a,i,o){var f=ir(r,t),s=[c._1(e,f)];return u.Gl[5](f[7],0,0,0,[function(r,t){return f[6][0]=r,!t&&a?(s[0]=c._2(a[0],s[0],f),0):0}],[function(){return 0}],[function(){return i?c._1(i[0],s[0]):0}],function(r){return f[2]=r/1e3,f[3]+=f[2],s[0]=c._2(n,s[0],f),0},0)},function(r,t,e,n,a){return r.colorMask(_.to_js_boolean(t),_.to_js_boolean(e),_.to_js_boolean(n),_.to_js_boolean(a)),0},function(r,t){return r.depthMask(_.to_js_boolean(t)),0},function(r,t,e,n,a){return c._5(u.Gl[6],r[0],t,e,n,a),c._2(u.Gl[39],r[0],m.color_buffer_bit)},function(r){return c._2(u.Gl[39],r[0],m.stencil_buffer_bit)},function(r,t){return r[0].bindFramebuffer(36160,t[2]),c._5(u.Gl[38],r[0],0,0,t[0],t[1])},function(r){return r[0].bindFramebuffer(36160,null),c._5(u.Gl[38],r[0],0,0,r[4],r[5])},or,cr],fr=[function(r,t,e,n,o,c){var u=V(t,r);if(u){var f=u[0],s=z(e,r,c),_=n?[O(n[0],r,c)]:0,m=a.map(function(t){return Z(t,r,f[1])},o);return[f,s,_,i.of_list(m)]}return l.failwith("Program creation failed")},function(r,t,e,n){return[r,t,e,n]},function(r,t){var e=r[2];return e?cr(t,r[0],r[1],e[0],r[3]):or(t,r[0],r[1])}];t.Constants=0,t.Gl=0,t.GlType=h,t.curRId=y,t.rId=p,t.Uniform=k,t.VertexAttrib=C,t.Shader=T,t.Program=U,t.VertexBuffer=E,t.IndexBuffer=K,t.VertexObject=j,t.Texture=Y,t.ProgramTexture=J,t.FrameBuffer=rr,t.Scissor=[3089],t.Stencil=[2960,519,514,517,7680,7681],t.$$Error=nr,t.Canvas=ur,t.DrawState=fr},function(r,t,e){"use strict";var n=e(4),a=e(10),i=e(7),o=e(37),c=e(12),u=e(0),f=e(1),s=e(70),_=e(14),l=e(26),m=e(6),v=e(8),d=e(2),g=e(69),h=e(25),y=e(68),p=[0];function b(){var r=p[0];return p[0]=r+1|0,r}var w=n.VertexBuffer[4](0,0,0),x=n.IndexBuffer[1](0),k=[function(r,t,e){var n=r?r[0]:u.__(0,[0]),i=t?t[0]:u.__(0,[0]),o=e[32];return[0,o?o[0]:d.failwith("Provided node does not draw to texture"),[e[2]],[u.__(5,[[a.Mat3[7](0)]])],n,i]},function(r,t,e){return[0,e,0,0,r?r[0]:u.__(0,[0]),t?t[0]:u.__(0,[0])]}];function M(r){var t=function(e,n){e[35]=n,e[36]=[r];var a=e[0];if(a){var o=a[0];_.mem(r[2],o)?d.failwith("Node with key already exist: "+o):_.add(r[2],o,e)}var c=e[1];if(c){var u=c[0];if(_.mem(r[3],u)){var f=_.find(r[3],u);_.replace(r[3],u,[e,f])}else _.add(r[3],u,[e,0])}return i.iter(function(r){return t(r,[e])},e[17]),i.iter(function(r){return t(r,[e])},e[18])};return t(r[5],0)}function S(r,t){var e=function(t,n,a,o,c){_.iter(function(r,e){return e[0]=[t[2],e[0]],0},t[28]);var u,f=t[25];if(f){var s=f[0];s[0]=[t[2],s[0]]}else{var l=t[21];if(l){var v=l[0][4];if(v){var g=v[0];g[0]=[t[2],g[0]]}else d.failwith("Could not find vo")}else d.failwith("Could not find vo")}if(_.iter(function(r,e){return e[0]=[t[2],e[0]],0},t[23]),t[15]&&(r[17]=[t[2],r[17]]),t[12]||t[14])u=0;else{var h=[t[10],0];if(!o&&n){var y=n[0];y[8]=[h,y[8]]}u=[h]}var p=[0,0,a,o,c,0,t,0,0,u,0,0,0,0,n];if(m.caml_array_set(r[15],t[2],[p]),p[12]=i.map(function(r){return e(r,[p],1,1,0)},t[17]),t[5][3]>=2){var b=i.fold_left(function(r,t){return[e(t,[p],a,0,r),r]},0,t[18]);i.fold_left(function(r,t){return t[5]=r,[t,r]},0,b),p[13]=i.rev(b)}else p[13]=i.map(function(r){return e(r,[p],a,0,0)},t[18]);var w=function(r){return i.iter(function(t){return r[8]=[t,r[8]],0},p[8]),i.iter(w,r[13])};if(i.iter(w,c),!p[3]){var x=p[14];if(x){var k=x[0];i.iter(function(r){return k[8]=[r,k[8]],0},p[8])}}return p};r[15]=m.caml_make_vect(p[0],0);var n=e(t,0,0,0,0);return r[17]=i.sort(function(r,t){return 0!=+(r>t)?1:-1},r[17]),n}function C(r){var t=r[0];if(t)return t[0]+" id:"+d.string_of_int(r[2]);var e=r[1];return e?"cls: "+e[0]+" id:"+d.string_of_int(r[2]):"id:"+d.string_of_int(r[2])}function P(r,t,e,a,o,c){var u=i.fold_left(function(r,t){return[n.Uniform[2](t[0]+"Mat",t[1]),r]},0,r),f=t?[n.Uniform[2]("elapsedScene",t[0]),u]:u,s=e?[n.Uniform[2]("pixelSize",e[0]),f]:f,_=a?[n.Uniform[2]("layout",a[0]),s]:s,l=o?[n.Uniform[2]("texTrans",o[0]),_]:_;return i.append(l,c)}function T(r,t){var e=t[0];if(e)return e[0];var a=r[4][0],o=r[4][1],c=i.map(function(r){if(_.mem(t[6],r)){var e=_.find(t[6],r);return n.Uniform[2](r,e[1])}if(_.mem(t[7],r)){var a=_.find(t[7],r);return n.Uniform[2](r,n.Uniform[1](a))}return d.failwith("Could not find uniform from list key")},t[5]),u=n.Program[0](t[1],t[2],t[3],c),f=n.Program[3](u,a),s=f?f[0]:d.failwith("Could not init program"),l=_.create(0,i.length(t[8])),m=_.create(0,_.length(t[9])),v=_.create(0,i.length(t[8]));_.iter(function(r,t){var e=n.ProgramTexture[1](t[1],a,s[1]);return _.add(m,r,e),_.add(l,r,e[2]),t[0][3]?_.add(v,r,n.Uniform[4](a,s[1],r+"Mat")):0},t[9]),_.iter(function(r,t){return _.add(l,r,n.ProgramTexture[2](r,a,s[1])),t?_.add(v,r,n.Uniform[4](a,s[1],r+"Mat")):0},t[10]);var g,h=t[11]?[n.Uniform[4](a,s[1],"layout")]:0,y=t[11]?[n.Uniform[4](a,s[1],"pixelSize")]:0,p=t[11]?[n.Uniform[4](a,s[1],"elapsed")]:0,b=t[11]?[n.Uniform[4](a,s[1],"texTrans")]:0,w=t[4];if(w){var x=w[0],k=n.VertexBuffer[8](x[1],a,o),M=x[2];g=[[k,M?[n.IndexBuffer[6](M[0],a,o)]:0]]}else g=0;return[s,m,l,v,g,h,y,p,b]}function A(r,t,e){var a,o=T(r,e),u=r[4][0],f=r[4][1],s=i.fold_left(function(r,a){var i=r[1],o=r[0];if(o){var c=o[1],u=o[0];if(_.mem(t[28],a)){var f=_.find(t[28],a);return[c,[n.Uniform[5](n.Uniform[0](f[1]),f[1],u[1]),i]]}return _.mem(e[6],a)?[c,[u,i]]:d.failwith("Could not find uniform by name: "+a)}return d.failwith("Scene program uniform mismatch between inited program and node creating drawstate")},[o[0][3],0],e[5])[1],l=t[33],m=o[8],v=l&&m?[n.Uniform[5](5,l[0],m[0]),s]:s,g=t[31],h=o[7],y=g&&h?[n.Uniform[5](0,g[0],h[0]),v]:v,p=t[30],b=o[6],w=p&&b?[n.Uniform[5](2,p[0],b[0]),y]:y,x=t[29],k=o[5],M=x&&k?[n.Uniform[5](5,x[0],k[0]),w]:w,S=i.fold_left(function(r,e){if(_.mem(t[24],e)){var a=_.find(t[24],e);return[n.Uniform[5](5,a[1],_.find(o[3],e)),r]}return r},M,e[8]),C=i.map(function(r){if(_.mem(t[23],r)){var e=_.find(t[23],r);return n.ProgramTexture[3](n.ProgramTexture[0](r,e[1]),u,_.find(o[2],r))}return _.mem(o[1],r)?_.find(o[1],r):d.failwith("Could not find texture")},e[8]),P=t[25];if(P){var A=P[0],D=A[2];a=[n.VertexBuffer[8](A[1],u,f),D?[n.IndexBuffer[6](D[0],u,f)]:0]}else{var V=o[4];a=V?V[0]:d.failwith("Neither node nor program has vertexobject")}return t[3]=[n.DrawState[1](n.Program[4](o[0],i.rev(S)),a[0],a[1],c.of_list(C))],0}function D(r,t){var e,a=r[4][1],o=i.fold_left(function(r,e){var n=_.find(t[23],e)[3];return n?[[e,n[0]],r]:r},0,t[22]),c=i.map(function(r){var e=_.find(t[28],r);return n.Uniform[2](r,e[1])},t[27]),u=P(o,t[31],t[30],t[29],t[33],c),f=i.map(function(r){var e=_.find(t[23],r);return n.ProgramTexture[0](r,e[1])},t[22]),s=t[19],l=s?s[0]:d.failwith("Vertex shader not found on: "+C(t)),m=t[20],v=m?m[0]:d.failwith("Fragment shader not found on: "+C(t)),g=t[25];if(g){var h=g[0];e=[h[1],h[2]]}else e=d.failwith("Could not find vo");var y=t[26],p=y?y[0]:d.failwith("Program or attribs is required");return t[3]=[n.DrawState[0](r[4][0],n.Program[0](l,v,p,u),e[0],e[1],f,a)],0}function V(r,t){if(t[11]){var e=t[21];return e?A(r,t,e[0]):D(r,t)}return 0}function U(r){var t=function(r,e){var n=i.fold_left(function(r,e){return t(e,r)},e,r[18]),a=i.fold_left(function(r,e){return t(e,r)},n,r[17]);return r[11]&&0===r[3]?[r,a]:a};return r[18]=t(r[5],0),0}function N(r,t){return r[1]=i.fold_left(function(r,t){return[t,r]},r[1],t),0}function L(r){return r[6][15]?0:(r[0]=1,i.iter(function(r){return r[0]?0:L(r)},r[13]))}function B(r){for(;;){var t=r;if(t[6][15])return 0;t[0]=1,i.iter(function(r){return r[0]?0:L(r)},t[13]);var e=t[14];if(e){var n=e[0];if(n[2]){if(n[0])return 0;r=n;continue}return n[0]?0:F(n)}return 0}}function F(r){if(r[6][15]||r[0])return 0;if(r[0]=1,i.iter(function(r){return r[0]?0:F(r)},r[4]),i.iter(function(r){return r[0]?0:L(r)},r[13]),i.iter(function(r){return r[0]?0:F(r)},r[5]),r[2]){var t=r[14];if(t){var e=t[0];e[0]||(e[2]?B(e):F(e))}else d.failwith("Dependency without parent")}var n=r[14];if(!n)return 0;var a=n[0];if(a[1])return 0;for(var o=a;;){var c=o;c[1]=1;var u=c[14];if(!u)return 0;var f=u[0];if(f[1])return 0;o=f}}function I(r){for(var t=function(r){var t=r[9];return t?(t[0][1]=1,0):0},e=function(n){for(;;){var a=n,i=a[4],o=i?[i[0]]:a[14];if(!o)return d.failwith("Could not find covering parent for: "+C(r[6])+". Maybe add a background node?");var c=o[0];if(c[6][11]){var u=1-(c[6][12]||c[6][14])&&s.Rect[3](c[6][7],r[6][7]),f=[r[6][7],r[6][9],c,0,u,1-(c[6][15]||c[0])];return c[10]=[f,c[10]],c[6][15]?[f,e(f[2])]:(c[0],f[4]?[f,0]:(t(f[2]),[f,e(f[2])]))}n=c}},n=r[11];;){var a=n;if(a){var o=a[1],c=a[0];if(o){if(c[2][6][15]){n=o;continue}if(c[2][0]){if(c[4])return 0;t(c[2]),n=o;continue}if(c[5]=1,c[4])return 0;t(c[2]),n=o;continue}return c[2][6][15]?(r[11]=i.append(r[11],e(c[2])),0):c[2][0]?c[4]?0:(t(c[2]),r[11]=i.append(r[11],e(c[2])),0):(c[5]=1,c[4]?0:(t(c[2]),r[11]=i.append(r[11],e(c[2])),0))}return r[11]=e(r),0}}function z(r){if(r){var t=r[0];return z(t[14]),i.fold_left(function(r,t){return t[6][15]?r:(t[0]||F(t),r+1|0)},0,i.append(t[4],t[5]))>0&&!t[6][15]&&!t[0]?F(t):0}return 0}function E(r,t,e){var a=r[4][1],o=m.caml_array_get(r[15],e[2]),_=o?o[0]:d.failwith("Root update node not found"),v=[i.fold_left(function(t,e){var n=m.caml_array_get(r[15],e);if(n){var a=n[0];return F(a),[a,t]}return d.failwith("Could not find update node with id: "+d.string_of_int(e))},0,t),[0,0]];i.iter(function(r){return i.iter(function(r){return z([r])},r)},v);var g=function(r){return r[0]?((r[6][12]||r[6][14])&&I(r),i.iter(g,r[13])):r[1]?i.iter(g,r[13]):0};g(_);var h=[0],y=[0],p=function(t,e,o){var f=o||t[6][15];t[1]&&(t[1]=0);var _,l=i.fold_left(function(r,t){return p(t,r,f)},e,t[12]);if(t[6][11]){if(f){t[0]=0,i.iter(function(r){return r[5]=0,0},t[10]);var m=i.fold_left(function(r,t){return t[1]||t[0]?p(t,r,f):r},l,t[13]);return i.iter(function(r){return r[1]=0,0},t[8]),m}var v,d=i.filter(function(r){return r[1]})(t[8]),g=function(r){for(;;){var t=r;if(t){var e=t[1],n=t[0];if(i.exists(function(r){return function(t){return s.Rect[3](t[0],r[0])}}(n),e)){r=e;continue}return[n,g(e)]}return 0}},b=g(d);if(b)if(0!==h[0]&&function(r){var t=h[0];if(!t)return 0;for(var e=r,n=t[0];;){var a=n,i=e;if(i){if(a){if(s.Rect[2](i[0][0],a[0][0]))return 0;n=a[1],e=i[1];continue}return 0}return a?0:1}}(b))v=l;else{var w=c.concat(i.map(function(r){var t=r[0];return[t[0],t[1]-t[3],t[0],t[1],t[0]+t[2],t[1],t[0]+t[2],t[1]-t[3]]},b)),x=n.VertexBuffer[4]([w],[1],0),k=n.IndexBuffer[0](n.IndexBuffer[2](i.length(b)),1),M=[n.VertexBuffer[8](x,r[4][0],a),n.IndexBuffer[6](k,r[4][0],a)];h[0]=[b],v=[u.__(2,[M]),l]}else h[0]?(h[0]=0,v=[1,l]):v=l;if(t[0]){t[0]=0,t[6][3]||V(r,t[6]);var S=0!==y[0]?(y[0]=0,[0,v]):v,C=t[6][32]?[[u.__(3,[t[6]]),S],1]:[S,0],P=[u.__(0,[t[6]]),C[0]],T=i.fold_left(function(r,t){return p(t,r,f)},P,t[13]),A=C[1]?[2,T]:T;return i.iter(function(r){return r[1]=0,0},b),i.iter(function(r){return r[5]=0,0},t[10]),A}var D=i.filter(function(r){return r[5]})(t[10]),U=function(r){for(;;){var t=r;if(t){var e=t[1],n=t[0];if(n[5]=0,i.exists(function(r){return function(t){return s.Rect[3](t[0],r[0])}}(n),e)){r=e;continue}return[n,U(e)]}return 0}},N=U(D),L=i.fold_left(function(r,e){return y[0]?function(r){var t=y[0];return t?s.Rect[2](t[0],r):0}(e[1])?[u.__(0,[t[6]]),0]:(y[0]=[e[1]],[u.__(0,[t[6]]),[u.__(1,[e[1]]),[0,r]]]):(y[0]=[e[1]],[u.__(0,[t[6]]),[u.__(1,[e[1]]),r]])},v,N),B=i.fold_left(function(r,t){return t[0]||t[1]?p(t,r,f):r},L,t[13]);return i.iter(function(r){return r[1]=0,0},b),B}t[0]?(t[0]=0,_=t[6][32]?[[u.__(3,[t[6]]),l],1]:[l,0]):_=[l,0];var F=i.fold_left(function(r,t){return t[0]||t[1]?p(t,r,f):r},_[0],t[13]);return _[1]?[2,F]:F};f._2(l.Gl[14],r[4][0],r[14][1][1]),a[0]=r[14][1][0];var b=p(_,0,0),w=0!==y[0]?[0,b]:b,x=0!==h[0]?[1,w]:w,k=function(r){return r[0]?(r[0]=0,i.iter(k,r[13])):r[1]?(r[1]=0,i.iter(k,r[13])):0};return function(r){for(;;){var t=r;if(!t)return 0;var e=t[0];e[1]&&(e[1]=0,i.iter(k,e[13])),e[0]&&(e[0]=0,i.iter(k,e[13])),r=e[14]}}(_[14]),i.rev(x)}function q(r,t){if(_.mem(r[13],t))return _.find(r[13],t);var e=n.FrameBuffer[3](n.FrameBuffer[2](t[0],t[1]),r[4][0]);return _.add(r[13],t,e),e}function R(r,t,e){var a=t[32];if(a){var i=a[0],o=e[0];o&&(e[1]=[o[0],e[1]]);var c=q(r,[1024,1024]);r[4][0].bindFramebuffer(n.FrameBuffer[0],c[2]);var u=0|t[7][2],s=0|t[7][3];return f._5(l.Gl[38],r[4][0],0,0,u,s),n.FrameBuffer[4](c,r[4][0],i),t[34]&&n.Canvas[8](r[4],0,0,0,0),e[0]=[[c,i,u,s]],0}return d.failwith("Node is not drawToTexture")}function G(r,t){var e=t[1];if(e){var a=e[0],i=a[0];return n.FrameBuffer[4](i,r[4][0],a[1]),n.Canvas[10](r[4],i),t[1]=e[1],t[0]=[a],f._5(l.Gl[38],r[4][0],0,0,a[2],a[3])}return t[0]=0,n.Canvas[11](r[4]),f._5(l.Gl[38],r[4][0],0,0,r[4][4],r[4][5])}function H(r,t){var e=t[3];if(e){var a=e[0],o=t[31];o&&n.Uniform[6](o[0],r[4][3]);var c,u=t[0],f=t[1];if(u){var s=u[0];c=i.exists(function(r){return+(s===r)},0)}else if(f){var _=f[0];c=i.exists(function(r){return+(_===r)},0)}else c=0;if(t[12]){var l=r[4][0];l.enable(h.blend);var m=0!==t[13]?1:h.src_alpha;return l.blendFunc(m,h.one_minus_src_alpha),n.DrawState[2](a,r[4]),l.disable(h.blend),0}return c?(n.DrawState[2](a,r[4]),n.Canvas[11](r[4]),n.DrawState[2](a,r[4])):n.DrawState[2](a,r[4])}return d.failwith("Drawstate not found")}function O(r,t,e){for(var a=r[4][0],o=r[4][3],c=[0,0],u=t;;){var f=u;if(!f)return 0;var s=f[0];if("number"==typeof s)switch(s){case 0:a.disable(n.Scissor[0]);break;case 1:a.disable(n.Stencil[0]);break;case 2:e||G(r,c)}else switch(0|s.tag){case 0:var _=s[0];if(e){var l=r[8],m=_[29],v=_[32];if(l&&m){var d=m[0];5===d.tag&&(v||y.draw(l[0][0],d[0][0],o+_[2]))}}else if(_[16])i.exists(function(r){return function(t){return+(t===r)}}(_),r[11])||(r[11]=[_,r[11]]);else{var h=_[4];h?h[0](_,r[0]):H(r,_)}break;case 1:var p=s[0];a.enable(n.Scissor[0]),a.scissor(0|p[0],0|p[1],0|p[2],0|p[3]);break;case 2:var b=s[0];a.enable(n.Stencil[0]),n.Canvas[9](r[4]),a.stencilFunc(n.Stencil[1],1,255),a.stencilOp(n.Stencil[4],n.Stencil[4],n.Stencil[5]),a.stencilMask(255),n.Canvas[6](a,0,0,0,0),n.Canvas[7](a,0),g.draw(r[14],b[0],b[1]),n.Canvas[6](a,1,1,1,1),n.Canvas[7](a,1),a.stencilFunc(n.Stencil[3],1,255),a.stencilMask(0);break;case 3:e||R(r,s[0],c)}u=f[1]}}function K(r,t,e){console.log("====\nDrawlist",i.fold_left(function(t,e){var n=m.caml_array_get(r[15],e);return n?t+", "+C(n[0][6]):t},"",t[0]));for(var n=e;;){var a=n;if(!a)return 0;var o=a[0];if("number"==typeof o)switch(o){case 0:console.log("Clear rect");break;case 1:console.log("Clear stencil");break;case 2:console.log("Unbind draw texture")}else switch(0|o.tag){case 0:console.log("Draw node: "+C(o[0]));break;case 1:console.log("Set rect: ",o[0]);break;case 2:console.log("Draw stencil: ",o[0][0][2]);break;case 3:console.log("Bind draw texture: "+C(o[0]))}n=a[1]}}function j(r,t){return _.mem(r[2],t)?[_.find(r[2],t)]:0}function W(r,t){return t[15]=1,r[17]=i.sort_uniq(function(r,t){return 0!=+(r>t)?1:-1},[t[2],r[17]]),N(r,[r[5][2],0])}function $(r,t){return t[15]=0,r[17]=i.filter(function(r){return+(r!==t[2])})(r[17]),N(r,[t[2],0])}function X(r){var t=r[4][4],e=r[4][5],o=function(r,n,a){!function(r,n,a){var i=r[6],o=function(r){switch(0|r.tag){case 0:return n*r[0];case 1:return t*r[0];case 2:return r[0]}},c=function(r){switch(0|r.tag){case 0:return a*r[0];case 1:return e*r[0];case 2:return r[0]}},u=r[5][2];if(!u)return 0;var f=u[0];switch(0|f.tag){case 0:var s=f[0];switch(0|s.tag){case 0:var _=s[0],l=n*_,m=a*_;return i[2]=l,i[3]=l,i[4]=m,i[5]=m,0;case 1:var v=s[0],d=t*v,g=e*v;return i[2]=d,i[3]=d,i[4]=g,i[5]=g,0;case 2:var h=s[0];return i[2]=h,i[3]=h,i[4]=h,i[5]=h,0}break;case 1:var y=o(f[0]),p=c(f[1]);return i[2]=y,i[3]=y,i[4]=p,i[5]=p,0;case 2:var b=o(f[0]),w=c(f[1]),x=o(f[2]),k=c(f[3]);i[2]=x,i[3]=b,i[4]=k,i[5]=w}}(r,n,a);var i,o=r[6],c=r[5][0];switch(0|c.tag){case 0:var u,f,s=c[1],_=c[0];switch(0|_.tag){case 0:u=n*_[0];break;case 1:u=t*_[0];break;case 2:u=_[0]}switch(0|s.tag){case 0:f=a*s[0];break;case 1:f=t*s[0];break;case 2:f=s[0]}i=[u,f];break;case 1:var l,m=c[0];switch(0|m.tag){case 0:l=n*m[0];break;case 1:l=t*m[0];break;case 2:l=m[0]}i=[l,l/c[1]];break;case 2:var v,d=c[0];switch(0|d.tag){case 0:v=a*d[0];break;case 1:v=e*d[0];break;case 2:v=d[0]}i=[v*c[1],v];break;case 3:var g=c[0];if(r[5][2]){var h=n-o[2]-o[3],y=a-o[4]-o[5];i=g<h/y?[y*g+o[2]+o[3],a]:[n,h/g+o[4]+o[5]]}else i=g<n/a?[a*g,a]:[n,n/g]}return o[0]=i[0],o[1]=i[1],o[6]=o[0]-o[2]-o[3],o[7]=o[1]-o[4]-o[5],0},c=function(u,f){var s,l=u[5],v=u[6],g=l[1];if(g){var h=g[0];switch(0|h.tag){case 0:var y=h[0],p=v[0]*y,b=v[1]*y;s=[v[0]-2*p,v[1]-2*b,v[8]+p,v[9]+b];break;case 1:var w=h[0],x=t*w,k=e*w;s=[v[0]-2*x,v[1]-2*k,v[8]+x,v[9]+k];break;case 2:var M=h[0];s=[v[0]-2*M,v[1]-2*M,v[8]+M,v[9]+M]}}else s=[v[0],v[1],v[8],v[9]];var S=s[3],C=s[2],P=s[0]-v[2]-v[3],T=s[1]-v[4]-v[5];switch(i.iter(function(r){return o(r,P,T)},u[17]),i.iter(function(r){return o(r,P,T)},u[18]),i.iter(function(r){return r[6][8]=C,r[6][9]=S,0},u[17]),l[3]){case 0:var A,D=l[4];if(D){var V=D[0];switch(0|V.tag){case 0:A=P*V[0];break;case 1:A=t*V[0];break;case 2:A=V[0]}}else A=0;switch(l[5]){case 0:var U=i.fold_left(function(r,t){return r+t[6][0]},0,u[18])+A*(i.length(u[18])-1|0),N=(P-U)/2;i.fold_left(function(r,t){return t[6][8]=r+t[6][2],r+A+t[6][0]},C+N,u[18]);break;case 1:i.fold_left(function(r,t){return t[6][8]=r+t[6][2],r+A+t[6][0]},C,u[18]);break;case 2:i.fold_right(function(r,t){var e=t-r[6][0];return r[6][8]=e+r[6][2],e-A},u[18],C+P)}switch(l[6]){case 0:i.iter(function(r){return r[6][9]=S+r[6][4],0},u[18]);break;case 1:i.iter(function(r){return r[6][9]=S+(T-r[6][1])/2+r[6][4],0},u[18]);break;case 2:i.iter(function(r){return r[6][9]=S+T-r[6][1]+r[6][4],0},u[18])}break;case 1:var L,B=l[4];if(B){var F=B[0];switch(0|F.tag){case 0:L=T*F[0];break;case 1:L=e*F[0];break;case 2:L=F[0]}}else L=0;switch(l[5]){case 0:i.iter(function(r){return r[6][8]=C+(P-r[6][0])/2+r[6][2],0},u[18]);break;case 1:i.iter(function(r){return r[6][8]=C+r[6][2],0},u[18]);break;case 2:i.iter(function(r){return r[6][8]=C+P-r[6][0]+r[6][2],0},u[18])}switch(l[6]){case 0:i.fold_left(function(r,t){return t[6][9]=r+t[6][4],r+t[6][1]+L},S,u[18]);break;case 1:var I=i.fold_left(function(r,t){return r+t[6][1]},0,u[18])+L*(i.length(u[18])-1|0);i.fold_left(function(r,t){return t[6][9]=r+t[6][4],r+t[6][1]+L},S+(T-I)/2,u[18]);break;case 2:i.fold_right(function(r,t){var e=t-r[6][1];return r[6][9]=e+r[6][4],e-L},u[18],S+T)}break;case 2:switch(l[5]){case 0:i.iter(function(r){return r[6][8]=C+(P-r[6][0])/2+r[6][2],0},u[18]);break;case 1:i.iter(function(r){return r[6][8]=C+r[6][2],0},u[18]);break;case 2:i.iter(function(r){return r[6][8]=C+P-r[6][0]+r[6][2],0},u[18])}switch(l[6]){case 0:i.iter(function(r){return r[6][9]=S+r[6][4],0},u[18]);break;case 1:i.iter(function(r){return r[6][9]=S+(T-r[6][1])/2+r[6][4],0},u[18]);break;case 2:i.iter(function(r){return r[6][9]=S+T-r[6][1]+r[6][4],0},u[18])}}var z=Math.floor(v[8]+.5),E=Math.floor(v[9]+.5),q=Math.floor(v[6]+(v[8]-z)+.5),R=Math.floor(v[7]+(v[9]-E)+.5),G=Math.floor(v[0]+(v[8]-z)+.5),H=Math.floor(v[1]+(v[9]-E)+.5);u[7][0]=z,u[7][1]=E,u[7][2]=q,u[7][3]=R,u[8][0]=Math.floor(v[8]-v[2]+.5),u[8][1]=Math.floor(v[9]-v[4]+.5),u[8][2]=G,u[8][3]=H,u[9][0]=z,u[9][1]=e-E-R,u[9][2]=q,u[9][3]=R,u[10][0]=z/t*2-1,u[10][1]=1-E/e*2,u[10][2]=q/t*2,u[10][3]=R/e*2;var O,K=u[29];if(K){var j=K[0],W=q/t,$=R/e,X=u[32],Q=u[33];if(X){var Y=X[0];if(n.Texture[11](Y,r[4][0],0|u[7][2],0|u[7][3]),Q){var Z=(2*z+q)/t-1,J=(-2*E-R)/e+1,rr=a.Mat3[6](W,$,Z,J);n.Uniform[10](j,rr);var tr=a.Mat3[6](1,1,0,0);n.Uniform[10](Q[0],tr),O=[[z,E,q,R]]}else{var er=a.Mat3[6](1,1,0,0);n.Uniform[10](j,er),O=[[z,E,q,R]]}}else{var nr,ar=(2*z+q)/t-1,ir=(-2*E-R)/e+1;if(f){var or=f[0];nr=a.Mat3[6](q/or[2],R/or[3],(2*(z-or[0])+q)/or[2]-1,(-2*(E-or[1])-R)/or[3]+1)}else nr=a.Mat3[6](W,$,ar,ir);n.Uniform[10](j,nr),O=f}}else O=f;var cr=u[30];return cr&&n.Uniform[7](cr[0],a.Vec2[5](q,R)),i.iter(function(r){return c(r,0)},u[17]),i.iter(function(r){return c(r,O)},u[18]),_.iter(function(t,e){var i=e[0],o=i[2];if(o){var c=m.caml_array_get(r[15],o[0]),f=c?c[0][6]:d.failwith("Could not find texNode"),s=n.Texture[2](i[1]),_=s?s[0]:d.failwith("Could not get size of texture"),l=f[7][2]/_[0]/2*(f[7][2]/u[7][2]),v=f[7][3]/_[1]/2*(f[7][3]/u[7][3]),g=a.Mat3[6](l,v,l,v);return n.Uniform[10](e[1],g)}return 0},u[24])};return o(r[5],t,e),r[5][6][8]=0,r[5][6][9]=0,c(r[5],0)}function Q(r,t,e){var n=function(r,t){if(i.exists(function(t){return+(t===r[2])},e))return t;var a=i.fold_left(function(r,t){return[t[2],r]},t,r[17]);return i.fold_left(function(r,t){return n(t,r)},a,r[18])};return i.rev(i.fold_left(function(t,e){var a=m.caml_array_get(r[15],e),i=a?a[0][6]:d.failwith("Could not find node");return n(i,t)},0,t))}function Y(r,t){var e=m.caml_array_get(r[15],t);if(!e)return d.failwith("Could not find node");for(var n=e[0][6];;){var a=n;if(a[15])return 1;var i=a[35];if(!i)return 0;n=i[0]}}function Z(r){return r[0]||r[1],i.iter(function(r){return r[1],0},r[8]),i.iter(function(r){return r[5],0},r[10]),i.iter(Z,r[12]),i.iter(Z,r[13])}function J(r){var t=function(e){for(;;){var n=e;if(n){var a=n[1],i=n[0];if(i[5]+=r[4][2],1!==i[6]&&v.mod_(i[7],i[6])||i[1](r,i),i[7]=i[7]+1|0,i[5]>=i[4]){i[2](r);var o=i[3];o&&f._1(o[0],r),e=a;continue}return[i,t(a)]}return 0}};r[12]=t(r[12]);var e=i.sort_uniq(function(r,t){return 0!=+(r<t)?-1:0!=+(r>t)?1:0},r[1]);r[1]=0;var n,a=r[17],o=[e,a],c=function(t,e){var n=Q(r,[t,0],r[17]);return i.iter(function(t){if(_.mem(r[10],t))return 0;if(_.add(r[10],t,1),c(t,0),i.exists(function(r){return+(r===t)},e))return 0;var n=m.caml_array_get(r[15],t);if(n){var a=n[0],u=E(r,[t,0],a[6]);return O(r,u,0),r[8]?(console.log("==\nDep drawlist: "+C(a[6])),K(r,o,u),Z(a)):0}return d.failwith("Could not find dep node")},n)};if(_.mem(r[9],o))n=0;else{var u=i.filter(function(t){return 1-Y(r,t)})(e);_.add(r[9],o,1),i.iter(function(t){var n=m.caml_array_get(r[15],t);return n?n[0][2]?c(t,0):c(t,e):d.failwith("Could not find node")},u),n=[u]}if(!_.mem(r[7],o)){var s=n?n[0]:i.filter(function(t){return 1-Y(r,t)})(e),l=E(r,s,r[5]);_.add(r[7],o,l),r[8]&&K(r,o,_.find(r[7],o))}var g=i.partition(function(r){return r[16]},r[11]),y=g[1];if(r[11]=g[0],i.length(y)>0){var p=i.map(function(t){var e=t[4];return e&&e[0](t,r[0]),t[2]},y),b=E(r,p,r[5]);O(r,b,0)}if(O(r,_.find(r[7],o),0),r[8]){var w=m.caml_array_get(r[15],r[5][2]);w&&Z(w[0]);var x=r[4][0];x.enable(h.blend),x.blendFunc(h.src_alpha,h.one_minus_src_alpha),O(r,_.find(r[7],o),1),x.disable(h.blend)}var k=r[19];if(k){var M=k[0];if(r[19]=k[1],_.mem(r[10],M))return 0;_.add(r[10],M,1);var S=m.caml_array_get(r[15],M);if(S){var P=S[0],T=E(r,[M,0],P[6]);return O(r,T,0),r[8]?(console.log("==\nQueued dep drawlist: "+C(P[6])),K(r,[0,0],T),Z(P)):0}return d.failwith("Could not find dep node")}var A=r[18];return A?(r[18]=A[1],V(r,A[0])):0}function rr(r,t){for(var e=t;;){var a=e;if(!a)return 0;var i=a[0];if("number"!=typeof i&&2===i.tag){var o=i[0];n.VertexBuffer[9](r[4][0],o[0]),n.IndexBuffer[7](r[4][0],o[1])}e=a[1]}}function tr(r){var t=n.Canvas[1](0);return n.Canvas[4](r[4],t[0],t[1]),_.iter(function(t,e){return rr(r,e)},r[7]),_.clear(r[7]),_.clear(r[9]),_.clear(r[10]),X(r),N(r,[r[5][2],0]),J(r)}var er=[function(r,t){return[0,r,t]},function(r,t){var e=r?r[0]:0;return[0,n.VertexBuffer[4](0,[e],0),[n.IndexBuffer[0](n.IndexBuffer[2](1),e)]]},function(r,t,e){n.VertexBuffer[6](t[1],e);var a=t[1][3]<<2,i=t[2];return i&&n.IndexBuffer[4](i[0],n.IndexBuffer[2](v.div(e.length,a))),N(r,t[0])}];function nr(r,t,e){return n.Uniform[6](t[1],e),N(r,t[0])}var ar=[function(r){return[0,u.__(0,[[r]])]},function(){return[0,u.__(0,[[0]])]},function(){return[0,u.__(0,[[1]])]},nr];function ir(r,t,e){return n.Uniform[7](t[1],e),N(r,t[0])}var or=[function(){return[0,u.__(2,[[a.Vec2[6](0)]])]},function(r,t){return[0,u.__(2,[[a.Vec2[5](r,t)]])]},function(r){return[0,u.__(2,[[a.Vec2[1](r)]])]},ir,function(r,t,e){return n.Uniform[7](t[1],a.Vec2[1](e)),N(r,t[0])},function(r){var t=r[1];return 2===t.tag?t[0][0]:d.failwith("Could not get vec2 uniform")}];function cr(r,t,e){return n.Uniform[8](t[1],e),N(r,t[0])}var ur=[function(){return[0,u.__(3,[[a.Vec3[10](0)]])]},function(r,t,e){return[0,u.__(3,[[a.Vec3[1](r,t,e)]])]},function(r){return[0,u.__(3,[[a.Vec3[3](r)]])]},function(r){return[0,u.__(3,[[r]])]},cr,function(r,t,e){return n.Uniform[8](t[1],a.Vec3[3](e)),N(r,t[0])},function(r,t){return n.Uniform[8](r[1],t)},function(r){var t=r[1];return 3===t.tag?t[0][0]:d.failwith("Could not get vec3 uniform")}],fr=[function(){return[0,u.__(4,[[a.Vec4[3](0)]])]},function(r,t,e,n){return[0,u.__(4,[[a.Vec4[1](r,t,e,n)]])]},function(r){return[0,u.__(4,[[a.Vec4[4](r)]])]},function(r,t,e){return n.Uniform[9](t[1],e),N(r,t[0])},function(r,t,e){return n.Uniform[9](t[1],a.Vec4[4](e)),N(r,t[0])}];function sr(r,t,e){return n.Uniform[10](t[1],e),N(r,t[0])}var _r=[function(){return[0,u.__(5,[[a.Mat3[7](0)]])]},function(r){return[0,u.__(5,[[r]])]},sr];t.currNodeId=p,t.nextNodeId=b,t.quadVertices=w,t.quadIndices=x,t.makeLayout=function(r,t,e,n,a,i,o,c){return[r?r[0]:u.__(0,[u.__(0,[1]),u.__(0,[1])]),t,e,a?a[0]:0,n,i?i[0]:0,o?o[0]:0]},t.SceneVO=[function(r,t){return[0,r,t]}],t.SceneTex=k,t.makeProgram=function(r,t,e,a,c,u,f,s,_,l,m,v,d){var g=e?e[0]:0,h=a?a[0]:0,y=c?c[0]:0,p=u?u[0]:0,b=_?_[0]:1,w=l?l[0]:0,x=m?m[0]:0,k=v?v[0]:0;return[0,r,t,f,s,i.append(i.map(function(r){return r[0]},g),i.map(function(r){return r[0]},h)),o.listToTbl(g),o.listToTbl(h),i.append(i.map(function(r){return r[0]},y),i.map(function(r){return r[0]},p)),o.listToTbl(i.map(function(r){var t=r[1],e=r[0];return[e,[t,n.ProgramTexture[0](e,t[1])]]},y)),o.listToTbl(p),b,w,x,k]},t.defaultVo=function(){return[0,w,[x]]},t.makeNode=function(r,t,e,c,f,l,m,v,g,h,y,p,k,M,S,C,P,T,A,D,V,U,N,L,B,F,I,z,E,q,R,G){var H,O=m?m[0]:0,K=v?v[0]:0,j=y?y[0]:0,W=p?p[0]:1,$=k?k[0]:0,X=M?M[0]:0,Q=S?S[0]:u.__(0,[u.__(0,[1]),u.__(0,[1])]),Y=T?T[0]:0,Z=D?D[0]:0,J=V?V[0]:0,rr=U?U[0]:1,tr=N?N[0]:0,er=L?L[0]:0,nr=B?B[0]:0,ar=F?F[0]:0,ir=I?I[0]:0,or=z?z[0]:0,cr=E?E[0]:0,ur=q?q[0]:0,fr=R?R[0]:0,sr=i.map(function(r){return r[0]},K),_r=o.listToTbl(K);if(f){var lr=f[0],mr=_.create(0,i.length(lr[8]));i.iter(function(r){if(_.mem(_r,r)){var t=_.find(_r,r),e=t[3];return e?_.add(mr,r,[t,e[0]]):0}var n=_.find(lr[9],r)[0];return n[3]?_.add(mr,r,[n,u.__(5,[[a.Mat3[7](0)]])]):0},lr[8]),H=mr}else{var vr=_.create(0,_.length(_r));_.iter(function(r,t){var e=t[3];return e?_.add(vr,r,[t,e[0]]):0},_r),H=vr}var dr,gr=i.map(function(r){return r[0]},j),hr=o.listToTbl(j);if(f){var yr=f[0];i.iter(function(r){return _.mem(yr[7],r)||_.mem(yr[6],r)?0:d.failwith("Uniform with key not supported by program: "+r)},gr),_.iter(function(r,t){return _.mem(hr,r)?0:d.failwith("Required uniform: "+r+" not defined")},yr[7]),i.iter(function(r){return _.mem(yr[10],r)||_.mem(yr[9],r)?0:d.failwith("Texture with key not supported by program: "+r)},sr),_.iter(function(r,t){return _.mem(_r,r)?0:d.failwith("Required texture: "+r+" not defined")},yr[10])}if(f){var pr=f[0];dr=[pr[11],pr[12],pr[13],pr[14]]}else dr=[0,0,0,0];var br,wr=W||dr[0]?[u.__(5,[[a.Mat3[7](0)]])]:0,xr=$||dr[1]?[u.__(2,[[a.Vec2[6](0)]])]:0,kr=X||dr[2]?[u.__(0,[[0]])]:0;br=h?[h[0]]:f&&f[0][4]?0:[[0,w,[x]]];var Mr,Sr,Cr=f?g?d.failwith("Attribs not usable when program is provided"):0:g||(br?[n.VertexBuffer[1](br[0][1])]:d.failwith("Attribs, program or vo is required")),Pr=[Q,C,P,Y,A,Z,J];if("number"==typeof cr)switch(cr){case 0:Mr=0;break;case 1:Mr=[n.Texture[6](0,0,0,0)];break;case 2:Mr=[n.Texture[7](0,0,0,0)];break;case 3:Mr=[n.Texture[8](0,0,0,0)]}else switch(0|cr.tag){case 0:var Tr=cr[0];Mr=[n.Texture[6]([Tr],[Tr],0,0)];break;case 1:var Ar=cr[0];Mr=[n.Texture[7]([Ar],[Ar],0,0)];break;case 2:Mr=[cr[0]]}var Dr=0;return"number"==typeof cr&&0===cr?Sr=0:Dr=1,1===Dr&&(Sr=0!==ur?[u.__(5,[[a.Mat3[7](0)]])]:0!==dr[3]?[u.__(5,[[a.Mat3[7](0)]])]:0),[r,t,b(),0,l,Pr,[0,0,0,0,0,0,0,0,0,0],s.Rect[1](0),s.Rect[1](0),s.Rect[1](0),s.Rect[1](0),rr,er,nr,ar,ir,tr,or,O,e,c,f,sr,_r,H,br,Cr,gr,hr,wr,xr,kr,Mr,Sr,fr,0,0]},t.setNodeParentsSceneKeyCls=M,t.buildUpdateTree=S,t.make=function(r,t,e,n,a,i){var o=n?n[0]:0,c=a?a[0]:1,u=0!==o?[[y.make(r)]]:0,f=[t,0,_.create(0,30),_.create(0,30),r,e,0,_.create(0,30),u,_.create(0,30),_.create(0,10),0,0,_.create(0,1),g.make(r),[],0,0,0,0,c];return M(f),f[16]=[S(f,f[5])],f},t.nodeDescr=C,t.nodeIdDescr=function(r,t){var e=m.caml_array_get(r[15],t);return e?C(e[0][6]):d.failwith("Could not find node with id: "+d.string_of_int(t))},t.createDrawStateUniforms=P,t.initSceneProgram=T,t.createProgramDrawState=A,t.createNodeDrawState=D,t.createDrawState=V,t.queueDrawStates=U,t.queueUpdates=N,t.makeAnim=function(r,t,e,n,a,i,o,c){return[n,r,t,o,e,0,i?i[0]:1,0,a]},t.clearAnim=function(r,t){return r[12]=i.filter(function(r){var e=r[0];return e?+(e[0]!==t):1})(r[12]),0},t.setChildToUpdate=L,t.setDepParentToUpdate=B,t.setToUpdate=F,t.actRectUntilCovered=I,t.setAdjecentStackedToUpdate=z,t.createDrawList=E,t.getFBuffer=q,t.debugNodes=0,t.bindDrawTexture=R,t.unbindDrawTexture=G,t.draw=H,t.Gl=0,t.processDrawList=O,t.logDrawList=K,t.getSceneNodesToUpdate=function(r,t){var e=function(t,n,a){var o=i.fold_left(function(r,t){return e(t,r,0)},0,t[17]),c=a||+(i.length(o)>0)||i.exists(function(r){return+(t[2]===r)},r),u=i.fold_left(function(r,t){return e(t,r,c)},n,t[18]),f=c&&t[11]?[t,u]:u;return i.fold_left(function(r,t){return[t,r]},f,o)};return e(t,0,0)},t.getNode=j,t.getNodeUnsafe=function(r,t){var e=j(r,t);return e?e[0]:d.failwith("Could not find node: "+t)},t.hideNode=W,t.hideNodeByKey=function(r,t){var e=j(r,t);return e?W(r,e[0]):d.failwith("Could not find node: "+t)},t.showNode=$,t.showNodeByKey=function(r,t){var e=j(r,t);return e?$(r,e[0]):d.failwith("Could not find node: "+t)},t.calcLayout=X,t.collectDeps=Q,t.isNodeHidden=Y,t.checkForCleanState=Z,t.update=J,t.cleanUpDrawList=rr,t.queueDeps=function(r,t){var e=function(t){var n=Q(r,t,0);return n?i.append(e(n),n):0};return r[19]=e([t,0]),0},t.doResize=tr,t.run=function(r,t,e,a,i,o,c,u){var s=n.Canvas[3](r,t),_=[f._1(e,s)],m=f._2(a,s,_[0]);X(m);var v=[0];return l.Gl[5](s[7],0,0,0,[function(r,t){return s[6][0]=r,!t&&o?(_[0]=f._2(o[0],_[0],s),0):0}],[function(){return 0}],[function(){return v[0]=[s[3]],0}],function(r){s[2]=r/1e3,s[3]+=s[2],m[6]||(N(m,[m[5][2],0]),J(m),m[20]&&U(m),m[6]=1),_[0]=f._3(i,_[0],m,s);var t=v[0];return t&&t[0]>s[3]-.7?(v[0]=0,c&&f._1(c[0],_[0]),tr(m)):0},0)},t.doAnim=function(r,t){return r[12]=[t,r[12]],0},t.SVertexObject=er,t.makeSceneUniform=function(r){return[0,r]},t.UFloat=ar,t.UVec2f=or,t.UVec3f=ur,t.UVec4f=fr,t.UMat3f=_r,t.setUniformFloat=function(r,t,e,n){return nr(r,_.find(t[28],e),n)},t.setUniformVec2f=function(r,t,e,n){return ir(r,_.find(t[28],e),n)},t.setUniformVec3f=function(r,t,e,n){return cr(r,_.find(t[28],e),n)},t.setUniformMat3f=function(r,t,e,n){return sr(r,_.find(t[28],e),n)}},function(r,t,e){"use strict";var n=e(3);t.caml_array_sub=function(r,t,e){for(var n=new Array(e),a=0,i=t;a<e;)n[a]=r[i],a=a+1|0,i=i+1|0;return n},t.caml_array_concat=function(r){var t=function(r,t){for(;;){var e=t,n=r;if(!e)return n;t=e[1],r=e[0].length+n|0}}(0,r),e=new Array(t);return function(r,t,e){for(;;){var n=e,a=t;if(!n)return 0;for(var i=n[0],o=i.length,c=a,u=0;u<o;)r[c]=i[u],c=c+1|0,u=u+1|0;e=n[1],t=c}}(e,0,r),e},t.caml_make_vect=function(r,t){for(var e=new Array(r),n=0,a=r-1|0;n<=a;++n)e[n]=t;return e},t.caml_array_blit=function(r,t,e,n,a){if(n<=t){for(var i=0,o=a-1|0;i<=o;++i)e[i+n|0]=r[i+t|0];return 0}for(var c=a-1|0;c>=0;--c)e[c+n|0]=r[c+t|0];return 0},t.caml_array_get=function(r,t){if(t<0||t>=r.length)throw[n.invalid_argument,"index out of bounds"];return r[t]},t.caml_array_set=function(r,t,e){if(t<0||t>=r.length)throw[n.invalid_argument,"index out of bounds"];return r[t]=e,0}},function(r,t,e){"use strict";var n=e(1),a=e(11),i=e(2),o=e(3);function c(r){for(var t=0,e=r;;){var n=e,a=t;if(!n)return a;e=n[1],t=a+1|0}}function u(r,t){for(;;){var e=t,n=r;if(!n)return e;t=[n[0],e],r=n[1]}}function f(r){return r?i.$at(r[0],f(r[1])):0}function s(r){return function(t){for(var e=0,a=t;;){var i=a,o=e;if(!i)return u(o,0);var c=i[1],f=i[0];n._1(r,f)?(a=c,e=[f,o]):a=c}}}function _(r,t){for(;;){var e=t,n=r;if(n){if(e){t=e[1],r=n-1|0;continue}throw[o.assert_failure,["list.ml",223,11]]}return e}}function l(r,t){var e=function(t,e){var i=0;if(2!==t)if(3!==t)i=1;else if(e){var o=e[1];if(o){var c=o[1];if(c){var f=c[0],s=o[0],l=e[0];return n._2(r,l,s)<=0?n._2(r,s,f)<=0?[l,[s,[f,0]]]:n._2(r,l,f)<=0?[l,[f,[s,0]]]:[f,[l,[s,0]]]:n._2(r,l,f)<=0?[s,[l,[f,0]]]:n._2(r,s,f)<=0?[s,[f,[l,0]]]:[f,[s,[l,0]]]}i=1}else i=1}else i=1;else if(e){var m=e[1];if(m){var v=m[0],d=e[0];return n._2(r,d,v)<=0?[d,[v,0]]:[v,[d,0]]}i=1}else i=1;if(1===i)for(var g=t>>1,h=t-g|0,y=_(g,e),p=a(g,e),b=a(h,y),w=0;;){var x=w,k=b,M=p;if(M){if(k){var S=k[0],C=M[0];if(n._2(r,C,S)>0){w=[C,x],p=M[1];continue}w=[S,x],b=k[1];continue}return u(M,x)}return u(k,x)}},a=function(t,a){var i=0;if(2!==t)if(3!==t)i=1;else if(a){var o=a[1];if(o){var c=o[1];if(c){var f=c[0],s=o[0],l=a[0];return n._2(r,l,s)>0?n._2(r,s,f)>0?[l,[s,[f,0]]]:n._2(r,l,f)>0?[l,[f,[s,0]]]:[f,[l,[s,0]]]:n._2(r,l,f)>0?[s,[l,[f,0]]]:n._2(r,s,f)>0?[s,[f,[l,0]]]:[f,[s,[l,0]]]}i=1}else i=1}else i=1;else if(a){var m=a[1];if(m){var v=m[0],d=a[0];return n._2(r,d,v)>0?[d,[v,0]]:[v,[d,0]]}i=1}else i=1;if(1===i)for(var g=t>>1,h=t-g|0,y=_(g,a),p=e(g,a),b=e(h,y),w=0;;){var x=w,k=b,M=p;if(M){if(k){var S=k[0],C=M[0];if(n._2(r,C,S)<=0){w=[C,x],p=M[1];continue}w=[S,x],b=k[1];continue}return u(M,x)}return u(k,x)}},i=c(t);return i<2?t:e(i,t)}var m=i.$at,v=f,d=s,g=l,h=l;t.length=c,t.hd=function(r){if(r)return r[0];throw[o.failure,"hd"]},t.tl=function(r){if(r)return r[1];throw[o.failure,"tl"]},t.nth=function(r,t){if(t<0)throw[o.invalid_argument,"List.nth"];for(var e=r,n=t;;){var a=e;if(a){if(n){n=n-1|0,e=a[1];continue}return a[0]}throw[o.failure,"nth"]}},t.rev=function(r){return u(r,0)},t.append=m,t.rev_append=u,t.concat=v,t.flatten=f,t.iter=function(r,t){for(;;){var e=t;if(!e)return 0;n._1(r,e[0]),t=e[1]}},t.iteri=function(r,t){for(var e=0,a=r,i=t;;){var o=i,c=e;if(!o)return 0;n._2(a,c,o[0]),i=o[1],e=c+1|0}},t.map=function r(t,e){return e?[n._1(t,e[0]),r(t,e[1])]:0},t.mapi=function(r,t){return function r(t,e,a){return a?[n._2(e,t,a[0]),r(t+1|0,e,a[1])]:0}(0,r,t)},t.rev_map=function(r,t){for(var e=0,a=t;;){var i=a,o=e;if(!i)return o;a=i[1],e=[n._1(r,i[0]),o]}},t.fold_left=function(r,t,e){for(;;){var a=e,i=t;if(!a)return i;e=a[1],t=n._2(r,i,a[0])}},t.fold_right=function r(t,e,a){return e?n._2(t,e[0],r(t,e[1],a)):a},t.iter2=function(r,t,e){for(;;){var a=e,i=t;if(i){if(a){n._2(r,i[0],a[0]),e=a[1],t=i[1];continue}throw[o.invalid_argument,"List.iter2"]}if(a)throw[o.invalid_argument,"List.iter2"];return 0}},t.map2=function r(t,e,a){if(e){if(a)return[n._2(t,e[0],a[0]),r(t,e[1],a[1])];throw[o.invalid_argument,"List.map2"]}if(a)throw[o.invalid_argument,"List.map2"];return 0},t.rev_map2=function(r,t,e){for(var a=0,i=t,c=e;;){var u=c,f=i,s=a;if(f){if(u){c=u[1],i=f[1],a=[n._2(r,f[0],u[0]),s];continue}throw[o.invalid_argument,"List.rev_map2"]}if(u)throw[o.invalid_argument,"List.rev_map2"];return s}},t.fold_left2=function(r,t,e,a){for(;;){var i=a,c=e,u=t;if(c){if(i){a=i[1],e=c[1],t=n._3(r,u,c[0],i[0]);continue}throw[o.invalid_argument,"List.fold_left2"]}if(i)throw[o.invalid_argument,"List.fold_left2"];return u}},t.fold_right2=function r(t,e,a,i){if(e){if(a)return n._3(t,e[0],a[0],r(t,e[1],a[1],i));throw[o.invalid_argument,"List.fold_right2"]}if(a)throw[o.invalid_argument,"List.fold_right2"];return i},t.for_all=function(r,t){for(;;){var e=t;if(e){if(n._1(r,e[0])){t=e[1];continue}return 0}return 1}},t.exists=function(r,t){for(;;){var e=t;if(!e)return 0;if(n._1(r,e[0]))return 1;t=e[1]}},t.for_all2=function(r,t,e){for(;;){var a=e,i=t;if(i){if(a){if(n._2(r,i[0],a[0])){e=a[1],t=i[1];continue}return 0}throw[o.invalid_argument,"List.for_all2"]}if(a)throw[o.invalid_argument,"List.for_all2"];return 1}},t.exists2=function(r,t,e){for(;;){var a=e,i=t;if(i){if(a){if(n._2(r,i[0],a[0]))return 1;e=a[1],t=i[1];continue}throw[o.invalid_argument,"List.exists2"]}if(a)throw[o.invalid_argument,"List.exists2"];return 0}},t.mem=function(r,t){for(;;){var e=t;if(e){if(a.caml_compare(e[0],r)){t=e[1];continue}return 1}return 0}},t.memq=function(r,t){for(;;){var e=t;if(!e)return 0;if(e[0]===r)return 1;t=e[1]}},t.find=function(r,t){for(;;){var e=t;if(!e)throw o.not_found;var a=e[0];if(n._1(r,a))return a;t=e[1]}},t.filter=d,t.find_all=s,t.partition=function(r,t){for(var e=0,a=0,i=t;;){var o=i,c=a,f=e;if(!o)return[u(f,0),u(c,0)];var s=o[1],_=o[0];n._1(r,_)?(i=s,e=[_,f]):(i=s,a=[_,c])}},t.assoc=function(r,t){for(;;){var e=t;if(e){var n=e[0];if(a.caml_compare(n[0],r)){t=e[1];continue}return n[1]}throw o.not_found}},t.assq=function(r,t){for(;;){var e=t;if(!e)throw o.not_found;var n=e[0];if(n[0]===r)return n[1];t=e[1]}},t.mem_assoc=function(r,t){for(;;){var e=t;if(e){if(a.caml_compare(e[0][0],r)){t=e[1];continue}return 1}return 0}},t.mem_assq=function(r,t){for(;;){var e=t;if(!e)return 0;if(e[0][0]===r)return 1;t=e[1]}},t.remove_assoc=function r(t,e){if(e){var n=e[1],i=e[0];return a.caml_compare(i[0],t)?[i,r(t,n)]:n}return 0},t.remove_assq=function r(t,e){if(e){var n=e[1],a=e[0];return a[0]===t?n:[a,r(t,n)]}return 0},t.split=function r(t){if(t){var e=t[0],n=r(t[1]);return[[e[0],n[0]],[e[1],n[1]]]}return[0,0]},t.combine=function r(t,e){if(t){if(e)return[[t[0],e[0]],r(t[1],e[1])];throw[o.invalid_argument,"List.combine"]}if(e)throw[o.invalid_argument,"List.combine"];return 0},t.sort=g,t.stable_sort=l,t.fast_sort=h,t.sort_uniq=function(r,t){var e=function(t,e){var i=0;if(2!==t)if(3!==t)i=1;else if(e){var o=e[1];if(o){var c=o[1];if(c){var f=c[0],s=o[0],l=e[0],m=n._2(r,l,s);if(m){if(m<0){var v=n._2(r,s,f);if(v){if(v<0)return[l,[s,[f,0]]];var d=n._2(r,l,f);return d?d<0?[l,[f,[s,0]]]:[f,[l,[s,0]]]:[l,[s,0]]}return[l,[s,0]]}var g=n._2(r,l,f);if(g){if(g<0)return[s,[l,[f,0]]];var h=n._2(r,s,f);return h?h<0?[s,[f,[l,0]]]:[f,[s,[l,0]]]:[s,[l,0]]}return[s,[l,0]]}var y=n._2(r,s,f);return y?y<0?[s,[f,0]]:[f,[s,0]]:[s,0]}i=1}else i=1}else i=1;else if(e){var p=e[1];if(p){var b=p[0],w=e[0],x=n._2(r,w,b);return x?x<0?[w,[b,0]]:[b,[w,0]]:[w,0]}i=1}else i=1;if(1===i)for(var k=t>>1,M=t-k|0,S=_(k,e),C=a(k,e),P=a(M,S),T=0;;){var A=T,D=P,V=C;if(V){if(D){var U=D[1],N=D[0],L=V[1],B=V[0],F=n._2(r,B,N);if(F){if(F>0){T=[B,A],C=L;continue}T=[N,A],P=U;continue}T=[B,A],P=U,C=L;continue}return u(V,A)}return u(D,A)}},a=function(t,a){var i=0;if(2!==t)if(3!==t)i=1;else if(a){var o=a[1];if(o){var c=o[1];if(c){var f=c[0],s=o[0],l=a[0],m=n._2(r,l,s);if(m){if(m>0){var v=n._2(r,s,f);if(v){if(v>0)return[l,[s,[f,0]]];var d=n._2(r,l,f);return d?d>0?[l,[f,[s,0]]]:[f,[l,[s,0]]]:[l,[s,0]]}return[l,[s,0]]}var g=n._2(r,l,f);if(g){if(g>0)return[s,[l,[f,0]]];var h=n._2(r,s,f);return h?h>0?[s,[f,[l,0]]]:[f,[s,[l,0]]]:[s,[l,0]]}return[s,[l,0]]}var y=n._2(r,s,f);return y?y>0?[s,[f,0]]:[f,[s,0]]:[s,0]}i=1}else i=1}else i=1;else if(a){var p=a[1];if(p){var b=p[0],w=a[0],x=n._2(r,w,b);return x?x>0?[w,[b,0]]:[b,[w,0]]:[w,0]}i=1}else i=1;if(1===i)for(var k=t>>1,M=t-k|0,S=_(k,a),C=e(k,a),P=e(M,S),T=0;;){var A=T,D=P,V=C;if(V){if(D){var U=D[1],N=D[0],L=V[1],B=V[0],F=n._2(r,B,N);if(F){if(F<0){T=[B,A],C=L;continue}T=[N,A],P=U;continue}T=[B,A],P=U,C=L;continue}return u(V,A)}return u(D,A)}},i=c(t);return i<2?t:e(i,t)},t.merge=function r(t,e,a){if(e){if(a){var i=a[0],o=e[0];return n._2(t,o,i)<=0?[o,r(t,e[1],a)]:[i,r(t,e,a[1])]}return e}return a}},function(r,t,e){"use strict";var n=e(3);function a(r){return(255&r)<<24|(65280&r)<<8|(16711680&r)>>>8|(4278190080&r)>>>24}var i=Math.imul||function(r,t){return((r>>16)*(t|=0)<<16)+(65535&r)*t|0},o=a;t.div=function(r,t){if(0===t)throw n.division_by_zero;return r/t|0},t.mod_=function(r,t){if(0===t)throw n.division_by_zero;return r%t},t.caml_bswap16=function(r){return(255&r)<<8|(65280&r)>>>8},t.caml_int32_bswap=a,t.caml_nativeint_bswap=o,t.imul=i},function(r,t,e){"use strict";var n=e(3);function a(r,t,e,n,a){if(a>0){if(r===e){var i=r,o=t,c=n,u=a;if(o<c){for(var f=(i.length-c|0)-1|0,s=u-1|0,_=f>s?s:f;_>=0;--_)i[c+_|0]=i[o+_|0];return 0}if(o>c){for(var l=(i.length-o|0)-1|0,m=u-1|0,v=l>m?m:l,d=0;d<=v;++d)i[c+d|0]=i[o+d|0];return 0}return 0}var g=r.length-t|0;if(a<=g){for(var h=0,y=a-1|0;h<=y;++h)e[n+h|0]=r[t+h|0];return 0}for(var p=0,b=g-1|0;p<=b;++p)e[n+p|0]=r[t+p|0];for(var w=g,x=a-1|0;w<=x;++w)e[n+w|0]=0;return 0}return 0}function i(r){var t=r,e=r.length,n="",i=e;if(e<=4096&&e===t.length)return String.fromCharCode.apply(null,t);for(var o=0;i>0;){var c=i<1024?i:1024,u=new Array(c);a(t,o,u,0,c),n+=String.fromCharCode.apply(null,u),i=i-c|0,o=o+c|0}return n}t.bytes_of_string=function(r){for(var t=r.length,e=new Array(t),n=0,a=t-1|0;n<=a;++n)e[n]=r.charCodeAt(n);return e},t.bytes_to_string=i,t.caml_is_printable=function(r){return r>31?+(r<127):0},t.caml_string_of_char_array=function(r){for(var t=r.length,e=new Array(t),n=0,a=t-1|0;n<=a;++n)e[n]=r[n];return i(e)},t.caml_string_get=function(r,t){if(t>=r.length||t<0)throw[n.invalid_argument,"index out of bounds"];return r.charCodeAt(t)},t.caml_string_compare=function(r,t){return r===t?0:r<t?-1:1},t.caml_create_string=function(r){if(r<0)throw[n.invalid_argument,"String.create"];return new Array(r)},t.caml_fill_string=function(r,t,e,n){if(e>0){for(var a=t,i=(e+t|0)-1|0;a<=i;++a)r[a]=n;return 0}return 0},t.caml_blit_string=function(r,t,e,n,a){if(a>0){var i=r.length-t|0;if(a<=i){for(var o=0,c=a-1|0;o<=c;++o)e[n+o|0]=r.charCodeAt(t+o|0);return 0}for(var u=0,f=i-1|0;u<=f;++u)e[n+u|0]=r.charCodeAt(t+u|0);for(var s=i,_=a-1|0;s<=_;++s)e[n+s|0]=0;return 0}return 0},t.caml_blit_bytes=a,t.caml_string_get16=function(r,t){return r.charCodeAt(t)+(r.charCodeAt(t+1|0)<<8)|0},t.caml_string_get32=function(r,t){return((r.charCodeAt(t)+(r.charCodeAt(t+1|0)<<8)|0)+(r.charCodeAt(t+2|0)<<16)|0)+(r.charCodeAt(t+3|0)<<24)|0},t.string_of_char=function(r){return String.fromCharCode(r)},t.get=function(r,t){if(t<0||t>=r.length)throw[n.invalid_argument,"index out of bounds"];return r.charCodeAt(t)}},function(r,t,e){"use strict";var n=e(6),a=e(2),i=[function(r){return r},function(r){return 2!==r.length&&a.failwith("Array does not have 2 elements for vec2"),r},function(r){return n.caml_array_get(r,0)},function(r){return n.caml_array_get(r,1)},function(r,t,e){return n.caml_array_set(r,0,t),n.caml_array_set(r,1,e)},function(r,t){return[r,t]},function(){return[0,0]},function(r){return"vec2("+a.string_of_float(n.caml_array_get(r,0))+","+a.string_of_float(n.caml_array_get(r,1))+")"}],o=[function(r){return r},function(r,t,e){return[r,t,e]},function(r,t){return[n.caml_array_get(r,0),n.caml_array_get(r,1),t]},function(r){return 3!==r.length&&a.failwith("Array does not have 3 elements for vec3"),r},function(r){return n.caml_array_get(r,0)},function(r){return n.caml_array_get(r,1)},function(r){return n.caml_array_get(r,2)},function(r,t){return n.caml_array_set(r,0,t)},function(r,t){return n.caml_array_set(r,1,t)},function(r,t){return n.caml_array_set(r,2,t)},function(){return[0,0,0]},function(r){var t=Math.sqrt(n.caml_array_get(r,0)*n.caml_array_get(r,0)+n.caml_array_get(r,1)*n.caml_array_get(r,1)+n.caml_array_get(r,2)*n.caml_array_get(r,2));return[n.caml_array_get(r,0)/t,n.caml_array_get(r,1)/t,n.caml_array_get(r,2)/t]},function(r,t){return[n.caml_array_get(r,0)*n.caml_array_get(t,0)+n.caml_array_get(r,1)*n.caml_array_get(t,1)+n.caml_array_get(r,2)*n.caml_array_get(t,2)]},function(r,t){return[n.caml_array_get(r,1)*n.caml_array_get(t,2)-n.caml_array_get(r,2)*n.caml_array_get(t,1),n.caml_array_get(r,2)*n.caml_array_get(t,0)-n.caml_array_get(r,0)*n.caml_array_get(t,2),n.caml_array_get(r,0)*n.caml_array_get(t,1)-n.caml_array_get(r,1)*n.caml_array_get(t,0)]},function(r){return"vec3("+a.string_of_float(n.caml_array_get(r,0))+","+a.string_of_float(n.caml_array_get(r,1))+","+a.string_of_float(n.caml_array_get(r,2))+")"}],c=[function(r){return r},function(r,t,e,n){return[r,t,e,n]},function(r,t){return[n.caml_array_get(r,0),n.caml_array_get(r,1),n.caml_array_get(r,2),t]},function(){return[0,0,0,0]},function(r){return 4!==r.length&&a.failwith("Array does not have 4 elements for vec4"),r},function(r){return"vec4("+a.string_of_float(n.caml_array_get(r,0))+","+a.string_of_float(n.caml_array_get(r,1))+","+a.string_of_float(n.caml_array_get(r,2))+","+a.string_of_float(n.caml_array_get(r,3))+")"}],u=[function(r){return r},function(r){return 9!==r.length&&a.failwith("Array does not have 9 elements for mat3"),r},function(r,t){return[n.caml_array_get(r,0)*n.caml_array_get(t,0)+n.caml_array_get(r,1)*n.caml_array_get(t,1)+n.caml_array_get(r,2)*n.caml_array_get(t,2),n.caml_array_get(r,3)*n.caml_array_get(t,0)+n.caml_array_get(r,4)*n.caml_array_get(t,1)+n.caml_array_get(r,5)*n.caml_array_get(t,2),n.caml_array_get(r,6)*n.caml_array_get(t,0)+n.caml_array_get(r,7)*n.caml_array_get(t,1)+n.caml_array_get(r,8)*n.caml_array_get(t,2)]},function(r,t){return[n.caml_array_get(r,0)*n.caml_array_get(t,0)+n.caml_array_get(r,1)*n.caml_array_get(t,3)+n.caml_array_get(r,2)*n.caml_array_get(t,6),n.caml_array_get(r,0)*n.caml_array_get(t,1)+n.caml_array_get(r,1)*n.caml_array_get(t,4)+n.caml_array_get(r,2)*n.caml_array_get(t,7),n.caml_array_get(r,0)*n.caml_array_get(t,2)+n.caml_array_get(r,1)*n.caml_array_get(t,5)+n.caml_array_get(r,2)*n.caml_array_get(t,8),n.caml_array_get(r,3)*n.caml_array_get(t,0)+n.caml_array_get(r,4)*n.caml_array_get(t,3)+n.caml_array_get(r,5)*n.caml_array_get(t,6),n.caml_array_get(r,3)*n.caml_array_get(t,1)+n.caml_array_get(r,4)*n.caml_array_get(t,4)+n.caml_array_get(r,5)*n.caml_array_get(t,7),n.caml_array_get(r,3)*n.caml_array_get(t,2)+n.caml_array_get(r,4)*n.caml_array_get(t,5)+n.caml_array_get(r,5)*n.caml_array_get(t,8),n.caml_array_get(r,6)*n.caml_array_get(t,0)+n.caml_array_get(r,7)*n.caml_array_get(t,3)+n.caml_array_get(r,8)*n.caml_array_get(t,6),n.caml_array_get(r,6)*n.caml_array_get(t,1)+n.caml_array_get(r,7)*n.caml_array_get(t,4)+n.caml_array_get(r,8)*n.caml_array_get(t,7),n.caml_array_get(r,6)*n.caml_array_get(t,2)+n.caml_array_get(r,7)*n.caml_array_get(t,5)+n.caml_array_get(r,8)*n.caml_array_get(t,8)]},function(r,t){return[r,0,0,0,t,0,0,0,1]},function(r,t){return[1,0,r,0,1,t,0,0,1]},function(r,t,e,n){return[r,0,e,0,t,n,0,0,1]},function(){return[1,0,0,0,1,0,0,0,1]}],f=[function(r){return r},function(r,t){return[n.caml_array_get(r,0)*n.caml_array_get(t,0)+n.caml_array_get(r,1)*n.caml_array_get(t,4)+n.caml_array_get(r,2)*n.caml_array_get(t,8)+n.caml_array_get(r,3)*n.caml_array_get(t,12),n.caml_array_get(r,0)*n.caml_array_get(t,1)+n.caml_array_get(r,1)*n.caml_array_get(t,5)+n.caml_array_get(r,2)*n.caml_array_get(t,9)+n.caml_array_get(r,3)*n.caml_array_get(t,13),n.caml_array_get(r,0)*n.caml_array_get(t,2)+n.caml_array_get(r,1)*n.caml_array_get(t,6)+n.caml_array_get(r,2)*n.caml_array_get(t,10)+n.caml_array_get(r,3)*n.caml_array_get(t,14),n.caml_array_get(r,0)*n.caml_array_get(t,3)+n.caml_array_get(r,1)*n.caml_array_get(t,7)+n.caml_array_get(r,2)*n.caml_array_get(t,11)+n.caml_array_get(r,3)*n.caml_array_get(t,15),n.caml_array_get(r,4)*n.caml_array_get(t,0)+n.caml_array_get(r,5)*n.caml_array_get(t,4)+n.caml_array_get(r,6)*n.caml_array_get(t,8)+n.caml_array_get(r,7)*n.caml_array_get(t,12),n.caml_array_get(r,4)*n.caml_array_get(t,1)+n.caml_array_get(r,5)*n.caml_array_get(t,5)+n.caml_array_get(r,6)*n.caml_array_get(t,9)+n.caml_array_get(r,7)*n.caml_array_get(t,13),n.caml_array_get(r,4)*n.caml_array_get(t,2)+n.caml_array_get(r,5)*n.caml_array_get(t,6)+n.caml_array_get(r,6)*n.caml_array_get(t,10)+n.caml_array_get(r,7)*n.caml_array_get(t,14),n.caml_array_get(r,4)*n.caml_array_get(t,3)+n.caml_array_get(r,5)*n.caml_array_get(t,7)+n.caml_array_get(r,6)*n.caml_array_get(t,11)+n.caml_array_get(r,7)*n.caml_array_get(t,15),n.caml_array_get(r,8)*n.caml_array_get(t,0)+n.caml_array_get(r,9)*n.caml_array_get(t,3)+n.caml_array_get(r,10)*n.caml_array_get(t,8)+n.caml_array_get(r,11)*n.caml_array_get(t,12),n.caml_array_get(r,8)*n.caml_array_get(t,1)+n.caml_array_get(r,9)*n.caml_array_get(t,4)+n.caml_array_get(r,10)*n.caml_array_get(t,9)+n.caml_array_get(r,11)*n.caml_array_get(t,13),n.caml_array_get(r,8)*n.caml_array_get(t,2)+n.caml_array_get(r,9)*n.caml_array_get(t,5)+n.caml_array_get(r,10)*n.caml_array_get(t,10)+n.caml_array_get(r,11)*n.caml_array_get(t,14),n.caml_array_get(r,8)*n.caml_array_get(t,3)+n.caml_array_get(r,9)*n.caml_array_get(t,5)+n.caml_array_get(r,10)*n.caml_array_get(t,11)+n.caml_array_get(r,11)*n.caml_array_get(t,15),n.caml_array_get(r,12)*n.caml_array_get(t,0)+n.caml_array_get(r,13)*n.caml_array_get(t,3)+n.caml_array_get(r,14)*n.caml_array_get(t,8)+n.caml_array_get(r,15)*n.caml_array_get(t,12),n.caml_array_get(r,12)*n.caml_array_get(t,1)+n.caml_array_get(r,13)*n.caml_array_get(t,4)+n.caml_array_get(r,14)*n.caml_array_get(t,9)+n.caml_array_get(r,15)*n.caml_array_get(t,13),n.caml_array_get(r,12)*n.caml_array_get(t,2)+n.caml_array_get(r,13)*n.caml_array_get(t,5)+n.caml_array_get(r,14)*n.caml_array_get(t,10)+n.caml_array_get(r,15)*n.caml_array_get(t,14),n.caml_array_get(r,12)*n.caml_array_get(t,3)+n.caml_array_get(r,13)*n.caml_array_get(t,5)+n.caml_array_get(r,14)*n.caml_array_get(t,11)+n.caml_array_get(r,15)*n.caml_array_get(t,15)]},function(r,t,e){return[r,0,0,0,0,t,0,0,0,0,e,0,0,0,0,1]},function(r,t,e){return[1,0,0,r,0,1,0,t,0,0,1,e,0,0,0,1]},function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}];t.Vec2=i,t.Vec3=o,t.Vec4=c,t.Mat3=u,t.Mat4=f},function(r,t,e){"use strict";var n=e(0),a=e(3);function i(r,t){return r<t?-1:r===t?0:1}function o(r,t){for(;;){var e=t,n=r;if(n===e)return 0;var c=typeof n,u=typeof e;if("string"===c)return n<e?-1:n===e?0:1;var f=+("number"===u);if(0!=+("number"===c))return 0!==f?i(n,e):-1;if(0!==f)return 1;if("boolean"===c||"undefined"===c||null===n)return n===e?0:n<e?-1:1;if("function"===c||"function"===u)throw[a.invalid_argument,"compare: functional value"];var s=0|n.tag,_=0|e.tag;if(250!==s)if(250!==_){if(248===s)return i(n[1],e[1]);if(251===s)throw[a.invalid_argument,"equal: abstract value"];if(s!==_)return s<_?-1:1;var l=0|n.length,m=0|e.length;if(l===m)for(var v=n,d=e,g=0,h=l;;){var y=g;if(y===h)return 0;var p=o(v[y],d[y]);if(0!==p)return p;g=y+1|0}else if(l<m)for(var b=n,w=e,x=0,k=l;;){var M=x;if(M===k)return-1;var S=o(b[M],w[M]);if(0!==S)return S;x=M+1|0}else for(var C=n,P=e,T=0,A=m;;){var D=T;if(D===A)return 1;var V=o(C[D],P[D]);if(0!==V)return V;T=D+1|0}}else t=e[0];else r=n[0]}}function c(r,t){for(;;){var e=t,n=r;if(n===e)return 1;var i=typeof n;if("string"===i||"number"===i||"boolean"===i||"undefined"===i||null===n)return 0;var o=typeof e;if("function"===i||"function"===o)throw[a.invalid_argument,"equal: functional value"];if("number"===o||"undefined"===o||null===e)return 0;var u=0|n.tag,f=0|e.tag;if(250!==u)if(250!==f){if(248===u)return+(n[1]===e[1]);if(251===u)throw[a.invalid_argument,"equal: abstract value"];if(u!==f)return 0;var s=0|n.length;if(s!==(0|e.length))return 0;for(var _=n,l=e,m=0,v=s;;){var d=m;if(d===v)return 1;if(!c(_[d],l[d]))return 0;m=d+1|0}}else t=e[0];else r=n[0]}}var u=i,f=i;t.caml_obj_block=function(r,t){var e=new Array(t);return e.tag=r,e},t.caml_obj_dup=function(r){for(var t=0|r.length,e=new Array(t),n=0,a=t-1|0;n<=a;++n)e[n]=r[n];return e.tag=0|r.tag,e},t.caml_obj_truncate=function(r,t){var e=0|r.length;if(t<=0||t>e)throw[a.invalid_argument,"Obj.truncate"];if(e!==t){for(var n=t,i=e-1|0;n<=i;++n)r[n]=0;return r.length=t,0}return 0},t.caml_lazy_make_forward=function(r){return n.__(250,[r])},t.caml_update_dummy=function(r,t){for(var e=0,n=(0|t.length)-1|0;e<=n;++e)r[e]=t[e];var a=0|t.tag;return 0!==a?(r.tag=a,0):0},t.caml_int_compare=i,t.caml_int32_compare=u,t.caml_nativeint_compare=f,t.caml_compare=o,t.caml_equal=c,t.caml_notequal=function(r,t){return 1-c(r,t)},t.caml_greaterequal=function(r,t){return+(o(r,t)>=0)},t.caml_greaterthan=function(r,t){return+(o(r,t)>0)},t.caml_lessthan=function(r,t){return+(o(r,t)<0)},t.caml_lessequal=function(r,t){return+(o(r,t)<=0)}},function(r,t,e){"use strict";var n=e(1),a=e(40),i=e(6),o=e(16),c=e(3);function u(r,t,e){for(var n=i.caml_make_vect(r,[]),a=0,o=r-1|0;a<=o;++a)n[a]=i.caml_make_vect(t,e);return n}function f(r){var t=r.length;return t?i.caml_array_sub(r,0,t):[]}function s(r,t,e,n,a){if(a<0||t<0||t>(r.length-a|0)||n<0||n>(e.length-a|0))throw[c.invalid_argument,"Array.blit"];return i.caml_array_blit(r,t,e,n,a)}var _=o.create("Array.Bottom");function l(r,t){var e=function(e,a,o,c,u,f,_){for(var l=e+a|0,m=c+u|0,v=e,d=i.caml_array_get(t,e),g=c,h=i.caml_array_get(o,c),y=_;;){var p=y,b=h,w=g,x=d,k=v;if(n._2(r,x,b)<=0){i.caml_array_set(f,p,x);var M=k+1|0;if(M<l){y=p+1|0,d=i.caml_array_get(t,M),v=M;continue}return s(o,w,f,p+1|0,m-w|0)}i.caml_array_set(f,p,b);var S=w+1|0;if(!(S<m))return s(t,k,f,p+1|0,l-k|0);y=p+1|0,h=i.caml_array_get(o,S),g=S}},a=function(e,a,o,c){for(var u=0,f=c-1|0;u<=f;++u){for(var s=i.caml_array_get(t,e+u|0),_=(o+u|0)-1|0;_>=o&&n._2(r,i.caml_array_get(a,_),s)>0;)i.caml_array_set(a,_+1|0,i.caml_array_get(a,_)),_=_-1|0;i.caml_array_set(a,_+1|0,s)}return 0},o=function(r,n,i,c){if(c<=5)return a(r,n,i,c);var u=c/2|0,f=c-u|0;return o(r+u|0,n,i+u|0,f),o(r,t,r+f|0,u),e(r+f|0,u,n,i+u|0,f,n,i)},c=t.length;if(c<=5)return a(0,t,0,c);var u=c/2|0,f=c-u|0,_=i.caml_make_vect(f,i.caml_array_get(t,0));return o(u,_,0,f),o(0,t,f,u),e(f,u,_,0,f,t,0)}var m=u,v=i.caml_array_concat,d=l;t.init=function(r,t){if(r){if(r<0)throw[c.invalid_argument,"Array.init"];for(var e=i.caml_make_vect(r,n._1(t,0)),a=1,o=r-1|0;a<=o;++a)e[a]=n._1(t,a);return e}return[]},t.make_matrix=u,t.create_matrix=m,t.append=function(r,t){var e=r.length;return e?t.length?r.concat(t):i.caml_array_sub(r,0,e):f(t)},t.concat=v,t.sub=function(r,t,e){if(e<0||t>(r.length-e|0))throw[c.invalid_argument,"Array.sub"];return i.caml_array_sub(r,t,e)},t.copy=f,t.fill=function(r,t,e,n){if(t<0||e<0||t>(r.length-e|0))throw[c.invalid_argument,"Array.fill"];for(var a=t,i=(t+e|0)-1|0;a<=i;++a)r[a]=n;return 0},t.blit=s,t.to_list=function(r){for(var t=r.length-1|0,e=0;;){var n=e,a=t;if(a<0)return n;e=[r[a],n],t=a-1|0}},t.of_list=function(r){if(!r)return[];for(var t=i.caml_make_vect(function(r,t){for(;;){var e=t,n=r;if(!e)return n;t=e[1],r=n+1|0}}(0,r),r[0]),e=1,n=r[1];;){var a=n,o=e;if(!a)return t;t[o]=a[0],n=a[1],e=o+1|0}},t.iter=function(r,t){for(var e=0,a=t.length-1|0;e<=a;++e)n._1(r,t[e]);return 0},t.map=function(r,t){var e=t.length;if(e){for(var a=i.caml_make_vect(e,n._1(r,t[0])),o=1,c=e-1|0;o<=c;++o)a[o]=n._1(r,t[o]);return a}return[]},t.iteri=function(r,t){for(var e=0,a=t.length-1|0;e<=a;++e)n._2(r,e,t[e]);return 0},t.mapi=function(r,t){var e=t.length;if(e){for(var a=i.caml_make_vect(e,n._2(r,0,t[0])),o=1,c=e-1|0;o<=c;++o)a[o]=n._2(r,o,t[o]);return a}return[]},t.fold_left=function(r,t,e){for(var a=t,i=0,o=e.length-1|0;i<=o;++i)a=n._2(r,a,e[i]);return a},t.fold_right=function(r,t,e){for(var a=e,i=t.length-1|0;i>=0;--i)a=n._2(r,t[i],a);return a},t.sort=function(r,t){for(var e=function(e,a){var o=1+((a+a|0)+a|0)|0,c=o;if((o+2|0)<e)return n._2(r,i.caml_array_get(t,o),i.caml_array_get(t,o+1|0))<0&&(c=o+1|0),n._2(r,i.caml_array_get(t,c),i.caml_array_get(t,o+2|0))<0&&(c=o+2|0),c;if((o+1|0)<e&&n._2(r,i.caml_array_get(t,o),i.caml_array_get(t,o+1|0))<0)return o+1|0;if(o<e)return o;throw[_,a]},o=function(o,c,u){try{for(var f=o,s=c,l=u;;){var m=s,v=e(f,m);if(!(n._2(r,i.caml_array_get(t,v),l)>0))return i.caml_array_set(t,m,l);i.caml_array_set(t,m,i.caml_array_get(t,v)),s=v}}catch(r){var d=a.internalToOCamlException(r);if(d[0]===_)return i.caml_array_set(t,d[1],u);throw d}},u=function(r,n){try{for(var o=r,c=n;;){var u=c,f=e(o,u);i.caml_array_set(t,u,i.caml_array_get(t,f)),c=f}}catch(r){var s=a.internalToOCamlException(r);if(s[0]===_)return s[1];throw s}},f=function(e,a){for(;;){var o=e,u=(o-1|0)/3|0;if(o===u)throw[c.assert_failure,["array.ml",168,4]];if(n._2(r,i.caml_array_get(t,u),a)<0){if(i.caml_array_set(t,o,i.caml_array_get(t,u)),u>0){e=u;continue}return i.caml_array_set(t,0,a)}return i.caml_array_set(t,o,a)}},s=t.length,l=((s+1|0)/3|0)-1|0;l>=0;--l)o(s,l,i.caml_array_get(t,l));for(var m=s-1|0;m>=2;--m){var v=i.caml_array_get(t,m);i.caml_array_set(t,m,i.caml_array_get(t,0)),f(u(m,0),v)}if(s>1){var d=i.caml_array_get(t,1);return i.caml_array_set(t,1,i.caml_array_get(t,0)),i.caml_array_set(t,0,d)}return 0},t.stable_sort=l,t.fast_sort=d},function(r,t,e){"use strict";var n=e(10),a=e(12),i=e(6),o=e(35),c=e(2),u=[a.copy,function(r,t){return i.caml_array_set(r,0,(i.caml_array_get(r,0)+t)%360)},function(r,t){return i.caml_array_set(r,2,c.min(i.caml_array_get(r,2)+t,1))},function(r,t){return i.caml_array_set(r,1,c.min(i.caml_array_get(r,1)+t,1))},function(r,t){return i.caml_array_set(r,2,t)},function(r){var t,e=i.caml_array_get(r,0),n=i.caml_array_get(r,1),a=i.caml_array_get(r,2),o=n,c=e,u=c>o?c>a?o>a?[a,c,0]:[o,c,0]:[o,a,2]:c>a?[a,o,1]:o>a?[c,o,1]:[c,a,2],f=u[1],s=u[0],_=(s+f)/2,l=s===f?0:_<.5?(f-s)/(f+s):(f-s)/(2-f-s);if(0===l)t=0;else switch(u[2]){case 0:t=(o-a)/(f-s)*60;break;case 1:t=60*(2+(a-c)/(f-s));break;case 2:t=60*(4+(c-o)/(f-s))}return[0!=+(t<0)?t+360:t,l,_]},function(r){var t=i.caml_array_get(r,0),e=i.caml_array_get(r,1),n=i.caml_array_get(r,2),a=e;if(0===a)return[n,n,n];var o=n<.5?n*(1+a):n+a-n*a,c=2*n-o,u=t/360,f=function(r){return r<0?r+1:r>1?r-1:r},s=f(u+.333),_=f(u),l=f(u-.333),m=function(r){var t=6*r;return t<1?c+(o-c)*t:2*r<1?o:3*r<2?c+(o-c)*(.666-r)*6:c};return[m(s),m(_),m(l)]}];t.from255=function(r,t,e){return[r/255,t/255,e/255]},t.fromFloats=function(r,t,e){return[r,t,e]},t.fromArray=function(r){return 3!==r.length&&(console.log(r),c.failwith("Color array needs 3 elements")),r},t.toArray=function(r){return r},t.toVec3=function(r){return n.Vec3[3](r)},t.toGlsl=function(r){return"vec3("+c.string_of_float(i.caml_array_get(r,0))+","+c.string_of_float(i.caml_array_get(r,1))+","+c.string_of_float(i.caml_array_get(r,2))+")"},t.black=function(){return[0,0,0]},t.white=function(){return[1,1,1]},t.compare=function(r,t){var e=o.caml_float_compare(i.caml_array_get(r,0),i.caml_array_get(t,0));if(0!==e)return e;var n=o.caml_float_compare(i.caml_array_get(r,1),i.caml_array_get(t,1));return 0!==n?n:o.caml_float_compare(i.caml_array_get(r,2),i.caml_array_get(t,2))},t.Hsl=u},function(r,t,e){"use strict";var n=e(12),a=e(0),i=e(1),o=e(34),c=e(11),u=e(77),f=e(6),s=e(2),_=e(75),l=e(17),m=e(3),v=[0],d=a.__(246,[function(){return o.State[1](0)}]);function g(r,t){var e,n=r?r[0]:v[0],a=function(r,t){for(;;){var e=r;if(e>=t)return e;if(e<<1<e)return e;r=e<<1}}(16,t);if(n){var i=0|d.tag;e=o.State[3](250===i?d[0]:246===i?_.force_lazy_block(d):d)}else e=0;return[0,f.caml_make_vect(a,0),e,a]}function h(r){r[0]=0;for(var t=0,e=r[1].length-1|0;t<=e;++t)f.caml_array_set(r[1],t,0);return 0}function y(r){var t=r[1].length;return r.length<4||t===r[3]?h(r):(r[0]=0,r[1]=f.caml_make_vect(r[3],0),0)}function p(r){return[r[0],n.copy(r[1]),r[2],r[3]]}function b(r){return r[0]}function w(r,t){var e=t[1],n=e.length,a=n<<1;if(a>=n){var o=f.caml_make_vect(a,0);t[1]=o;for(var c=function(e){if(e){var n=e[0];c(e[2]);var a=i._2(r,t,n);return f.caml_array_set(o,a,[n,e[1],f.caml_array_get(o,a)])}return 0},u=0,s=n-1|0;u<=s;++u)c(f.caml_array_get(e,u));return 0}return 0}function x(r,t){return r.length>=3?u.caml_hash(10,100,r[2],t)&(r[1].length-1|0):l.not_implemented("caml_hash_univ_param not implemented by bucklescript yet\n")%r[1].length}function k(r,t){for(var e=function(t){for(;;){var e=t;if(!e)return 0;i._2(r,e[0],e[1]),t=e[2]}},n=t[1],a=0,o=n.length-1|0;a<=o;++a)e(f.caml_array_get(n,a));return 0}function M(r,t,e){for(var n=function(t,e){for(;;){var n=e,a=t;if(!a)return n;e=i._3(r,a[0],a[1],n),t=a[2]}},a=t[1],o=e,c=0,u=a.length-1|0;c<=u;++c)o=n(f.caml_array_get(a,c),o);return o}function S(r,t){for(;;){var e=t,n=r;if(!e)return n;t=e[2],r=n+1|0}}function C(r){var t=n.fold_left(function(r,t){return s.max(r,S(0,t))},0,r[1]),e=f.caml_make_vect(t+1|0,0);return n.iter(function(r){var t=S(0,r);return f.caml_array_set(e,t,f.caml_array_get(e,t)+1|0)},r[1]),[r[0],r[1].length,t,e]}var P=u.caml_hash;t.create=g,t.clear=h,t.reset=y,t.copy=p,t.add=function(r,t,e){var n=x(r,t),a=[t,e,f.caml_array_get(r[1],n)];return f.caml_array_set(r[1],n,a),r[0]=r[0]+1|0,r[0]>r[1].length<<1?w(x,r):0},t.find=function(r,t){var e=f.caml_array_get(r[1],x(r,t));if(!e)throw m.not_found;if(!c.caml_compare(t,e[0]))return e[1];var n=e[2];if(!n)throw m.not_found;if(!c.caml_compare(t,n[0]))return n[1];var a=n[2];if(!a)throw m.not_found;if(!c.caml_compare(t,a[0]))return a[1];for(var i=t,o=a[2];;){var u=o;if(u){if(c.caml_compare(i,u[0])){o=u[2];continue}return u[1]}throw m.not_found}},t.find_all=function(r,t){var e=function(r){for(;;){var n=r;if(n){var a=n[2];if(c.caml_compare(n[0],t)){r=a;continue}return[n[1],e(a)]}return 0}};return e(f.caml_array_get(r[1],x(r,t)))},t.mem=function(r,t){for(var e=f.caml_array_get(r[1],x(r,t));;){var n=e;if(n){if(c.caml_compare(n[0],t)){e=n[2];continue}return 1}return 0}},t.remove=function(r,t){var e=function(n){if(n){var a=n[2],i=n[0];return c.caml_compare(i,t)?[i,n[1],e(a)]:(r[0]=r[0]-1|0,a)}return 0},n=x(r,t);return f.caml_array_set(r[1],n,e(f.caml_array_get(r[1],n)))},t.replace=function(r,t,e){var n=function(r){if(r){var a=r[2],i=r[0];return c.caml_compare(i,t)?[i,r[1],n(a)]:[t,e,a]}throw m.not_found},a=x(r,t),i=f.caml_array_get(r[1],a);try{return f.caml_array_set(r[1],a,n(i))}catch(n){if(n===m.not_found)return f.caml_array_set(r[1],a,[t,e,i]),r[0]=r[0]+1|0,r[0]>r[1].length<<1?w(x,r):0;throw n}},t.iter=k,t.fold=M,t.length=b,t.randomize=function(){return v[0]=1,0},t.stats=C,t.Make=function(r){var t=r[0],e=function(t,e){return i._1(r[1],e)&(t[1].length-1|0)};return[function(r){return g([0],r)},h,y,p,function(r,t,n){var a=e(r,t),i=[t,n,f.caml_array_get(r[1],a)];return f.caml_array_set(r[1],a,i),r[0]=r[0]+1|0,r[0]>r[1].length<<1?w(e,r):0},function(r,n){var a=function(e){if(e){var o=e[2],c=e[0];return i._2(t,c,n)?(r[0]=r[0]-1|0,o):[c,e[1],a(o)]}return 0},o=e(r,n);return f.caml_array_set(r[1],o,a(f.caml_array_get(r[1],o)))},function(r,n){var a=f.caml_array_get(r[1],e(r,n));if(!a)throw m.not_found;var o=a[2];if(i._2(t,n,a[0]))return a[1];if(!o)throw m.not_found;var c=o[2];if(i._2(t,n,o[0]))return o[1];if(!c)throw m.not_found;if(i._2(t,n,c[0]))return c[1];for(var u=n,s=c[2];;){var _=s;if(!_)throw m.not_found;if(i._2(t,u,_[0]))return _[1];s=_[2]}},function(r,n){var a=function(r){for(;;){var e=r;if(!e)return 0;var o=e[2];if(i._2(t,e[0],n))return[e[1],a(o)];r=o}};return a(f.caml_array_get(r[1],e(r,n)))},function(r,n,a){var o=function(r){if(r){var e=r[2],c=r[0];return i._2(t,c,n)?[n,a,e]:[c,r[1],o(e)]}throw m.not_found},c=e(r,n),u=f.caml_array_get(r[1],c);try{return f.caml_array_set(r[1],c,o(u))}catch(t){if(t===m.not_found)return f.caml_array_set(r[1],c,[n,a,u]),r[0]=r[0]+1|0,r[0]>r[1].length<<1?w(e,r):0;throw t}},function(r,n){for(var a=f.caml_array_get(r[1],e(r,n));;){var o=a;if(!o)return 0;if(i._2(t,o[0],n))return 1;a=o[2]}},k,M,b,C]},t.MakeSeeded=function(r){var t=function(t,e){return i._2(r[1],t[2],e)&(t[1].length-1|0)};return[g,h,y,p,function(r,e,n){var a=t(r,e),i=[e,n,f.caml_array_get(r[1],a)];return f.caml_array_set(r[1],a,i),r[0]=r[0]+1|0,r[0]>r[1].length<<1?w(t,r):0},function(e,n){var a=function(t){if(t){var o=t[2],c=t[0];return i._2(r[0],c,n)?(e[0]=e[0]-1|0,o):[c,t[1],a(o)]}return 0},o=t(e,n);return f.caml_array_set(e[1],o,a(f.caml_array_get(e[1],o)))},function(e,n){var a=f.caml_array_get(e[1],t(e,n));if(!a)throw m.not_found;var o=a[2];if(i._2(r[0],n,a[0]))return a[1];if(!o)throw m.not_found;var c=o[2];if(i._2(r[0],n,o[0]))return o[1];if(!c)throw m.not_found;if(i._2(r[0],n,c[0]))return c[1];for(var u=n,s=c[2];;){var _=s;if(!_)throw m.not_found;if(i._2(r[0],u,_[0]))return _[1];s=_[2]}},function(e,n){var a=function(t){for(;;){var e=t;if(!e)return 0;var o=e[2];if(i._2(r[0],e[0],n))return[e[1],a(o)];t=o}};return a(f.caml_array_get(e[1],t(e,n)))},function(e,n,a){var o=function(t){if(t){var e=t[2],c=t[0];return i._2(r[0],c,n)?[n,a,e]:[c,t[1],o(e)]}throw m.not_found},c=t(e,n),u=f.caml_array_get(e[1],c);try{return f.caml_array_set(e[1],c,o(u))}catch(r){if(r===m.not_found)return f.caml_array_set(e[1],c,[n,a,u]),e[0]=e[0]+1|0,e[0]>e[1].length<<1?w(t,e):0;throw r}},function(e,n){for(var a=f.caml_array_get(e[1],t(e,n));;){var o=a;if(!o)return 0;if(i._2(r[0],o[0],n))return 1;a=o[2]}},k,M,b,C]},t.hash=function(r){return u.caml_hash(10,100,0,r)},t.seeded_hash=function(r,t){return u.caml_hash(10,100,r,t)},t.hash_param=function(r,t,e){return u.caml_hash(r,t,0,e)},t.seeded_hash_param=P},function(r,t,e){"use strict";var n=e(7),a=e(24),i=e(8),o=e(9);function c(r){var t=r-9|0;return t>4||t<0?23!==t?0:1:2!==t?1:0}var u=o.caml_string_compare,f=a.fill,s=a.blit_string;t.make=function(r,t){return o.bytes_to_string(a.make(r,t))},t.init=function(r,t){return o.bytes_to_string(a.init(r,t))},t.copy=function(r){return o.bytes_to_string(a.copy(o.bytes_of_string(r)))},t.sub=function(r,t,e){return o.bytes_to_string(a.sub(o.bytes_of_string(r),t,e))},t.fill=f,t.blit=s,t.concat=function(r,t){if(t){var e=t[0],a=[0],c=[0];n.iter(function(r){return a[0]=a[0]+1|0,c[0]=c[0]+r.length|0,0},t);var u=o.caml_create_string(c[0]+i.imul(r.length,a[0]-1|0)|0);o.caml_blit_string(e,0,u,0,e.length);var f=[e.length];return n.iter(function(t){return o.caml_blit_string(r,0,u,f[0],r.length),f[0]=f[0]+r.length|0,o.caml_blit_string(t,0,u,f[0],t.length),f[0]=f[0]+t.length|0,0},t[1]),o.bytes_to_string(u)}return""},t.iter=function(r,t){return a.iter(r,o.bytes_of_string(t))},t.iteri=function(r,t){return a.iteri(r,o.bytes_of_string(t))},t.map=function(r,t){return o.bytes_to_string(a.map(r,o.bytes_of_string(t)))},t.mapi=function(r,t){return o.bytes_to_string(a.mapi(r,o.bytes_of_string(t)))},t.trim=function(r){return""===r||!c(r.charCodeAt(0))&&!c(r.charCodeAt(r.length-1|0))?r:o.bytes_to_string(a.trim(o.bytes_of_string(r)))},t.escaped=function(r){return function(t){for(;;){var e=t;if(e>=r.length)return 0;var n=r.charCodeAt(e);if(!(n>=32))return 1;var a=n-34|0;if(a>58||a<0){if(a>=93)return 1;t=e+1|0}else{if(a>57||a<1)return 1;t=e+1|0}}}(0)?o.bytes_to_string(a.escaped(o.bytes_of_string(r))):r},t.index=function(r,t){return a.index(o.bytes_of_string(r),t)},t.rindex=function(r,t){return a.rindex(o.bytes_of_string(r),t)},t.index_from=function(r,t,e){return a.index_from(o.bytes_of_string(r),t,e)},t.rindex_from=function(r,t,e){return a.rindex_from(o.bytes_of_string(r),t,e)},t.contains=function(r,t){return a.contains(o.bytes_of_string(r),t)},t.contains_from=function(r,t,e){return a.contains_from(o.bytes_of_string(r),t,e)},t.rcontains_from=function(r,t,e){return a.rcontains_from(o.bytes_of_string(r),t,e)},t.uppercase=function(r){return o.bytes_to_string(a.uppercase(o.bytes_of_string(r)))},t.lowercase=function(r){return o.bytes_to_string(a.lowercase(o.bytes_of_string(r)))},t.capitalize=function(r){return o.bytes_to_string(a.capitalize(o.bytes_of_string(r)))},t.uncapitalize=function(r){return o.bytes_to_string(a.uncapitalize(o.bytes_of_string(r)))},t.compare=u},function(r,t,e){"use strict";var n=[0];function a(){return n[0]+=1,n[0]}t.caml_set_oo_id=function(r){return r[1]=n[0],n[0]+=1,r},t.get_id=a,t.create=function(r){var t=[r,a()];return t.tag=248,t},t.isCamlExceptionOrOpenVariant=function(r){if(void 0===r)return 0;if(248===r.tag)return 1;var t=r[0];return void 0!==t?+(248===t.tag):0}},function(r,t,e){"use strict";t.not_implemented=function(r){throw new Error(r)}},function(r,t,e){"use strict";var n=e(1),a=e(8),i=e(27),o=e(42),c=e(3);function u(r){throw[c.failure,r]}function f(r){return r>=65?r>=97?r>=123?-1:r-87|0:r>=91?-1:r-55|0:r>57||r<48?-1:r-48|0}function s(r){switch(r){case 0:return 8;case 1:return 16;case 2:return 10;case 3:return 2}}function _(r){var t=1,e=2,n=0;"-"===r[n]&&(t=-1,n=n+1|0);var a=r.charCodeAt(n),i=r.charCodeAt(n+1|0);return 48===a&&(i>=89?98!==i?111!==i?120===i&&(e=1,n=n+2|0):(e=0,n=n+2|0):(e=3,n=n+2|0):66!==i?79!==i?i>=88&&(e=1,n=n+2|0):(e=0,n=n+2|0):(e=3,n=n+2|0)),[n,t,e]}function l(r){var t=_(r),e=t[0],n=s(t[2]),a=r.length,i=f(e<a?r.charCodeAt(e):0);if(i<0||i>=n)throw[c.failure,"int_of_string"];var o=t[1]*function(t,e){for(;;){var i=e,o=t;if(i===a)return o;var u=r.charCodeAt(i);if(95!==u){var s=f(u);if(s<0||s>=n)throw[c.failure,"int_of_string"];var _=n*o+s;if(_>4294967295)throw[c.failure,"int_of_string"];e=i+1|0,t=_}else e=i+1|0}}(i,e+1|0),u=0|o;if(10===n&&o!==u)throw[c.failure,"int_of_string"];return u}function m(r){return r>=65&&r<=90||r>=192&&r<=214||r>=216&&r<=222?r+32|0:r}function v(r){var t=r.length;if(t>31)throw[c.invalid_argument,"format_int: format too long"];for(var e=["+","-"," ",0,2,0,0,0,1,-1,"f"],n=0;;){var i=n;if(i>=t)return e;var o=r.charCodeAt(i),u=0;if(o>=69)if(o>=88)if(o>=121)u=1;else switch(o-88|0){case 0:e[4]=1,e[7]=1,n=i+1|0;continue;case 13:case 14:case 15:u=5;break;case 12:case 17:u=4;break;case 23:e[4]=0,n=i+1|0;continue;case 29:e[4]=2,n=i+1|0;continue;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 16:case 18:case 19:case 20:case 21:case 22:case 24:case 25:case 26:case 27:case 28:case 30:case 31:u=1;break;case 32:e[4]=1,n=i+1|0;continue}else{if(!(o>=72)){e[5]=1,e[7]=1,e[10]=String.fromCharCode(m(o)),n=i+1|0;continue}u=1}else{var f=o-32|0;if(f>25||f<0)u=1;else switch(f){case 3:e[3]=1,n=i+1|0;continue;case 0:case 11:u=2;break;case 13:e[0]="-",n=i+1|0;continue;case 14:e[9]=0;for(var s=i+1|0;function(t){return function(){var e=r.charCodeAt(t)-48|0;return+(e>=0&&e<=9)}}(s)();)e[9]=(a.imul(e[9],10)+r.charCodeAt(s)|0)-48|0,s=s+1|0;n=s;continue;case 1:case 2:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 12:case 15:u=1;break;case 16:e[2]="0",n=i+1|0;continue;case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:u=3}}switch(u){case 1:n=i+1|0;continue;case 2:e[1]=String.fromCharCode(o),n=i+1|0;continue;case 3:e[6]=0;for(var _=i;function(t){return function(){var e=r.charCodeAt(t)-48|0;return+(e>=0&&e<=9)}}(_)();)e[6]=(a.imul(e[6],10)+r.charCodeAt(_)|0)-48|0,_=_+1|0;n=_;continue;case 4:e[5]=1,e[4]=2,n=i+1|0;continue;case 5:e[5]=1,e[10]=String.fromCharCode(o),n=i+1|0;continue}}}function d(r,t){var e=r[0],n=r[1],a=r[2],i=r[3],o=r[4],c=r[5],u=r[6],f=r[7],s=r[8],_=t.length;c&&(s<0||"-"!==n)&&(_=_+1|0),i&&(o?1===o&&(_=_+2|0):_=_+1|0);var l="";if("+"===e&&" "===a)for(var m=_,v=u-1|0;m<=v;++m)l+=a;if(c&&(s<0?l+="-":"-"!==n&&(l+=n)),i&&0===o&&(l+="0"),i&&1===o&&(l+="0x"),"+"===e&&"0"===a)for(var d=_,g=u-1|0;d<=g;++d)l+=a;if(l=f?l+t.toUpperCase():l+t,"-"===e)for(var h=_,y=u-1|0;h<=y;++h)l+=" ";return l}function g(r,t){if("%d"===r)return String(t);var e=v(r),n=t,a=(n<0?e[5]?(e[8]=-1,-n):n>>>0:n).toString(function(r){switch(e[4]){case 0:return 8;case 1:return 16;case 2:return 10}}());if(e[9]>=0){e[2]=" ";var i=e[9]-a.length|0;i>0&&(a=o.repeat(i,"0")+a)}return d(e,a)}var h=function(r,t){var e=+r;if(r.length>0&&e==e)return e;if(e=+(r=r.replace(/_/g,"")),r.length>0&&e==e||/^[+-]?nan$/i.test(r))return e;if(/^ *0x[0-9a-f_]+p[+-]?[0-9_]+/i.test(r)){var n=r.indexOf("p");n=-1==n?r.indexOf("P"):n;var a=+r.substring(n+1);return(e=+r.substring(0,n))*Math.pow(2,a)}return/^\+?inf(inity)?$/i.test(r)?1/0:/^-inf(inity)?$/i.test(r)?-1/0:void t("float_of_string")},y=g,p=g,b=l,w=l;t.caml_format_float=function(r,t){var e=v(r),n=e[9]<0?6:e[9],a=t<0?(e[8]=-1,-t):t,i="";if(isNaN(a))i="nan",e[2]=" ";else if(isFinite(a))switch(e[10]){case"e":var o=(i=a.toExponential(n)).length;"e"===i[o-3|0]&&(i=i.slice(0,o-1|0)+"0"+i.slice(o-1|0));break;case"f":i=a.toFixed(n);break;case"g":var c=0!==n?n:1,u=(i=a.toExponential(c-1|0)).indexOf("e"),f=0|Number(i.slice(u+1|0));if(f<-4||a>=1e21||a.toFixed().length>c){for(var s=u-1|0;"0"===i[s];)s=s-1|0;"."===i[s]&&(s=s-1|0);var _=(i=i.slice(0,s+1|0)+i.slice(u)).length;"e"===i[_-3|0]&&(i=i.slice(0,_-1|0)+"0"+i.slice(_-1|0))}else{var l=c;if(f<0)l=l-(f+1|0)|0,i=a.toFixed(l);else for(;+((i=a.toFixed(l)).length>(c+1|0));)l=l-1|0;if(0!==l){for(var m=i.length-1|0;"0"===i[m];)m=m-1|0;"."===i[m]&&(m=m-1|0),i=i.slice(0,m+1|0)}}}else i="inf",e[2]=" ";return d(e,i)},t.caml_format_int=g,t.caml_nativeint_format=y,t.caml_int32_format=p,t.caml_float_of_string=function(r){return n._2(h,r,u)},t.caml_int64_format=function(r,t){var e=v(r),n=e[5]&&i.lt(t,[0,0])?(e[8]=-1,i.neg(t)):t,a="";switch(e[4]){case 0:var c=[0,8],u="01234567";if(i.lt(n,[0,0])){var f=i.discard_sign(n),s=i.div_mod(f,c),_=i.add([268435456,0],s[0]),l=s[1];for(a=String.fromCharCode(u.charCodeAt(0|l[1]))+a;i.neq(_,[0,0]);){var m=i.div_mod(_,c);_=m[0],l=m[1],a=String.fromCharCode(u.charCodeAt(0|l[1]))+a}}else{var g=i.div_mod(n,c),h=g[0],y=g[1];for(a=String.fromCharCode(u.charCodeAt(0|y[1]))+a;i.neq(h,[0,0]);){var p=i.div_mod(h,c);h=p[0],y=p[1],a=String.fromCharCode(u.charCodeAt(0|y[1]))+a}}break;case 1:a=i.to_hex(n)+a;break;case 2:var b=[0,10];if(i.lt(n,[0,0])){var w=i.discard_sign(n),x=i.div_mod(w,b),k=i.div_mod(i.add([0,8],x[1]),b),M=i.add(i.add([214748364,3435973836],x[0]),k[0]),S=k[1];for(a=String.fromCharCode("0123456789".charCodeAt(0|S[1]))+a;i.neq(M,[0,0]);){var C=i.div_mod(M,b);M=C[0],S=C[1],a=String.fromCharCode("0123456789".charCodeAt(0|S[1]))+a}}else{var P=i.div_mod(n,b),T=P[0],A=P[1];for(a=String.fromCharCode("0123456789".charCodeAt(0|A[1]))+a;i.neq(T,[0,0]);){var D=i.div_mod(T,b);T=D[0],A=D[1],a=String.fromCharCode("0123456789".charCodeAt(0|A[1]))+a}}}if(e[9]>=0){e[2]=" ";var V=e[9]-a.length|0;V>0&&(a=o.repeat(V,"0")+a)}return d(e,a)},t.caml_int_of_string=l,t.caml_int32_of_string=b,t.caml_int64_of_string=function(r){var t,e=_(r),n=e[2],a=e[0],o=i.of_int32(s(n)),u=i.of_int32(e[1]);switch(n){case 0:t=[536870911,4294967295];break;case 1:t=[268435455,4294967295];break;case 2:t=[429496729,2576980377];break;case 3:t=[2147483647,4294967295]}var l=r.length,m=a<l?r.charCodeAt(a):0,v=i.of_int32(f(m));if(i.lt(v,[0,0])||i.ge(v,o))throw[c.failure,"int64_of_string"];var d=i.mul(u,function(e,n){for(;;){var a=n,u=e;if(a===l)return u;var s=r.charCodeAt(a);if(95!==s){var _=i.of_int32(f(s));if(i.lt(_,[0,0])||i.ge(_,o)||i.gt(u,t))throw[c.failure,"int64_of_string"];n=a+1|0,e=i.add(i.mul(o,u),_)}else n=a+1|0}}(v,a+1|0)),g=i.or_(d,[0,0]);if(i.eq(o,[0,10])&&i.neq(d,g))throw[c.failure,"int64_of_string"];return g},t.caml_nativeint_of_string=w},function(r,t,e){"use strict";var n=e(10),a=e(7),i=e(0),o=e(13),c=e(22),u=e(15),f=e(2);function s(r){return r.tag?0:[r[0]]}function _(r){return r.tag?0:[r[0]]}function l(r){return r.tag?0:[r[0]]}function m(r){return[_(r[0]),s(r[1]),r[2],r[3],r[4]]}function v(r,t,e,n,a,c){return[r,t?t[0]:i.__(0,[o.white(0)]),e?e[0]:0,n?n[0]:.6,a?a[0]:12]}function d(r,t){var e,n=f.string_of_int(t),a=r[0];e=a.tag?[["uPointPos"+n,a[0]],0]:0;var i=r[1];return i.tag?[["uPointColor"+n,i[0]],e]:e}function g(r,t){var e=f.string_of_int(t);return(r[0].tag?"uniform vec3 uPointPos"+e+";\n":"")+(r[1].tag?"uniform vec3 uPointColor"+e+";\n":"")}function h(r,t,e){var a,i=f.string_of_int(t),o=r[0];a=o.tag?"uPointPos"+i:n.Vec3[14](o[0]);var c=0!==r[2]?"localP":"screenP",u=r[1],s="pointDir"+i,_="vec3 "+s+" = normalize("+a+" - "+c+");",l="max(dot("+s+", normal), 0.0) * "+(u.tag?"uPointColor"+i:n.Vec3[14](u[0]))+" * "+f.string_of_float(r[3]);if(r[4]){var m="lightDir"+i,v="reflect("+m+", normal)";return[_+"vec3 "+m+" = normalize("+c+" - "+a+");","pow(clamp(dot(normalize("+n.Vec3[14](e[0])+" - "+c+"), "+v+"), 0.0, 1.0), "+f.string_of_int(r[4])+".0) * vec3(1.0, 1.0, 1.0) + "+l]}return[_,l]}var y=[m,v,d,g,h,function(r,t){var e=h(r,0,t);return"vec3 lighting(vec3 localP, vec3 screenP, vec3 normal) {\n"+e[0]+"return pow("+e[1]+", vec3(1.0/2.2));\n}\n"}];function p(r){return[l(r[0]),s(r[1]),r[2],r[3],r[4]]}function b(r,t,e,n,a,c){return[r,t?t[0]:i.__(0,[o.white(0)]),e?e[0]:0,n?n[0]:.4,a?a[0]:16]}function w(r){var t,e=r[0];t=e.tag?[["uDir",e[0]],0]:0;var n=r[1];return n.tag?[["uDirColor",n[0]],0]:t}function x(r){return(r[0].tag?"uniform vec3 uDir;\n":"")+(r[1].tag?"uniform vec3 uDirColor;\n":"")}function k(r){var t,e=r[0];t=e.tag?"uDir":n.Vec3[14](e[0]);var a=r[1];return["","max(dot("+t+", normal), 0.0) * "+(a.tag?"uDirColor":n.Vec3[14](a[0]))+" * "+f.string_of_float(r[3])]}var M=[p,b,w,x,k],S=[function(r){return[p(r[0]),a.map(m,r[1])]},function(r,t,e){return[r,t,e]},function(){return[b(i.__(0,[n.Vec3[1](.4,.3,.3)]),0,0,0,0),[v(i.__(0,[n.Vec3[1](0,-.4,2)]),0,0,0,0),0],c.make(n.Vec3[1](0,.4,4))]},function(r){var t=a.concat(a.mapi(function(r,t){return d(t,r)},r[1]));return a.append(w(r[0]),t)},function(){return 0},function(r){var t=a.fold_left(function(r,t){var e=r[0];return[e+1|0,r[1]+g(t,e)]},[0,""],r[1]);return x(r[0])+t[1]},function(r){var t=a.fold_left(function(t,e){var n=t[0];return[n+1|0,[h(e,n,r[2]),t[1]]]},[0,0],r[1]),e=[k(r[0]),t[1]],n=a.fold_left(function(r,t){return[r[0]+t[0],[t[1],r[1]]]},["",0],e);return"vec3 lighting(vec3 localP, vec3 screenP, vec3 normal) {\n"+n[0]+"return pow("+u.concat(" + ",n[1])+", vec3(1.0/2.2));\n}\n"}];t.lightColorHash=s,t.lightPosHash=_,t.lightDirHash=l,t.PointLight=y,t.Directional=M,t.ProgramLight=S},function(r,t,e){"use strict";var n=e(9),a=e(3);t.chr=function(r){if(r<0||r>255)throw[a.invalid_argument,"Char.chr"];return r},t.escaped=function(r){var t=0;if(r>=40){if(92===r)return"\\\\";t=r>=127?1:2}else if(r>=32){if(r>=39)return"\\'";t=2}else if(r>=14)t=1;else switch(r){case 8:return"\\b";case 9:return"\\t";case 10:return"\\n";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:t=1;break;case 13:return"\\r"}switch(t){case 1:var e=new Array(4);return e[0]=92,e[1]=48+(r/100|0)|0,e[2]=48+(r/10|0)%10|0,e[3]=48+r%10|0,n.bytes_to_string(e);case 2:var a=new Array(1);return a[0]=r,n.bytes_to_string(a)}},t.lowercase=function(r){return r>=65&&r<=90||r>=192&&r<=214||r>=216&&r<=222?r+32|0:r},t.uppercase=function(r){return r>=97&&r<=122||r>=224&&r<=246||r>=248&&r<=254?r-32|0:r},t.compare=function(r,t){return r-t|0}},function(r,t,e){"use strict";var n=e(1),a=e(14);t.Make=function(r){var t=a.create(0,r[2]);return[t,function(e){var i=n._1(r[0],e);if(a.mem(t,i))return a.find(t,i);var o=n._1(r[1],e);return a.add(t,i,o),o}]}},function(r,t,e){"use strict";t.make=function(r){return[r]}},function(r,t,e){"use strict";var n=e(10),a=n.Vec3[1](0,-.4,2),i=n.Vec3[1](0,.4,4);t.tickDuration=.5,t.tileCols=12,t.tileRows=26,t.blinkTime=.7,t.dropAnimDuration=.8,t.dropDownBeforeTouchDown=.15,t.dropDownBeforeTick=.5,t.pointLight=a,t.camera=i},function(r,t,e){"use strict";var n=e(20),a=e(7),i=e(1),o=e(11),c=e(8),u=e(2),f=e(9),s=e(3),_=[];function l(r){var t=r.length,e=f.caml_create_string(t);return f.caml_blit_bytes(r,0,e,0,t),e}function m(r,t,e){if(t<0||e<0||t>(r.length-e|0))throw[s.invalid_argument,"String.sub / Bytes.sub"];var n=f.caml_create_string(e);return f.caml_blit_bytes(r,t,n,0,e),n}function v(r){var t=r-9|0;return t>4||t<0?23!==t?0:1:2!==t?1:0}function d(r,t){var e=t.length;if(e){for(var n=f.caml_create_string(e),a=0,o=e-1|0;a<=o;++a)n[a]=i._1(r,t[a]);return n}return t}function g(r,t){if(t.length){var e=l(t);return e[0]=i._1(r,t[0]),e}return t}function h(r,t,e,n){for(;;){var a=e;if(a>=t)throw s.not_found;if(r[a]===n)return a;e=a+1|0}}function y(r,t,e){for(;;){var n=t;if(n<0)throw s.not_found;if(r[n]===e)return n;t=n-1|0}}function p(r,t,e){var n=r.length;if(t<0||t>n)throw[s.invalid_argument,"String.contains_from / Bytes.contains_from"];try{return h(r,n,t,e),1}catch(r){if(r===s.not_found)return 0;throw r}}var b=o.caml_compare,w=f.bytes_to_string,x=f.bytes_of_string;t.make=function(r,t){var e=f.caml_create_string(r);return f.caml_fill_string(e,0,r,t),e},t.init=function(r,t){for(var e=f.caml_create_string(r),n=0,a=r-1|0;n<=a;++n)e[n]=i._1(t,n);return e},t.empty=_,t.copy=l,t.of_string=function(r){return l(f.bytes_of_string(r))},t.to_string=function(r){return f.bytes_to_string(l(r))},t.sub=m,t.sub_string=function(r,t,e){return f.bytes_to_string(m(r,t,e))},t.extend=function(r,t,e){var n=(r.length+t|0)+e|0,a=f.caml_create_string(n),i=t<0?[0|-t,0]:[0,t],o=i[1],c=i[0],s=u.min(r.length-c|0,n-o|0);return s>0&&f.caml_blit_bytes(r,c,a,o,s),a},t.fill=function(r,t,e,n){if(t<0||e<0||t>(r.length-e|0))throw[s.invalid_argument,"String.fill / Bytes.fill"];return f.caml_fill_string(r,t,e,n)},t.blit=function(r,t,e,n,a){if(a<0||t<0||t>(r.length-a|0)||n<0||n>(e.length-a|0))throw[s.invalid_argument,"Bytes.blit"];return f.caml_blit_bytes(r,t,e,n,a)},t.blit_string=function(r,t,e,n,a){if(a<0||t<0||t>(r.length-a|0)||n<0||n>(e.length-a|0))throw[s.invalid_argument,"String.blit / Bytes.blit_string"];return f.caml_blit_string(r,t,e,n,a)},t.concat=function(r,t){if(t){var e=t[0],n=[0],i=[0];a.iter(function(r){return n[0]=n[0]+1|0,i[0]=i[0]+r.length|0,0},t);var o=f.caml_create_string(i[0]+c.imul(r.length,n[0]-1|0)|0);f.caml_blit_bytes(e,0,o,0,e.length);var u=[e.length];return a.iter(function(t){return f.caml_blit_bytes(r,0,o,u[0],r.length),u[0]=u[0]+r.length|0,f.caml_blit_bytes(t,0,o,u[0],t.length),u[0]=u[0]+t.length|0,0},t[1]),o}return _},t.cat=function(r,t){return r.concat(t)},t.iter=function(r,t){for(var e=0,n=t.length-1|0;e<=n;++e)i._1(r,t[e]);return 0},t.iteri=function(r,t){for(var e=0,n=t.length-1|0;e<=n;++e)i._2(r,e,t[e]);return 0},t.map=d,t.mapi=function(r,t){var e=t.length;if(e){for(var n=f.caml_create_string(e),a=0,o=e-1|0;a<=o;++a)n[a]=i._2(r,a,t[a]);return n}return t},t.trim=function(r){for(var t=r.length,e=0;e<t&&v(r[e]);)e=e+1|0;for(var n=t-1|0;n>=e&&v(r[n]);)n=n-1|0;return n>=e?m(r,e,1+(n-e|0)|0):_},t.escaped=function(r){for(var t=0,e=0,n=r.length-1|0;e<=n;++e){var a,i=r[e];if(i>=32){var o=i-34|0;a=o>58||o<0?o>=93?4:1:o>57||o<1?2:1}else a=i>=11?13!==i?4:2:i>=8?2:4;t=t+a|0}if(t===r.length)return l(r);var c=f.caml_create_string(t);t=0;for(var u=0,s=r.length-1|0;u<=s;++u){var _=r[u],m=0;if(_>=35)92!==_?_>=127?m=1:c[t]=_:m=2;else if(_>=32)_>=34?m=2:c[t]=_;else if(_>=14)m=1;else switch(_){case 8:c[t]=92,c[t=t+1|0]=98;break;case 9:c[t]=92,c[t=t+1|0]=116;break;case 10:c[t]=92,c[t=t+1|0]=110;break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:m=1;break;case 13:c[t]=92,c[t=t+1|0]=114}switch(m){case 1:c[t]=92,c[t=t+1|0]=48+(_/100|0)|0,c[t=t+1|0]=48+(_/10|0)%10|0,c[t=t+1|0]=48+_%10|0;break;case 2:c[t]=92,c[t=t+1|0]=_}t=t+1|0}return c},t.index=function(r,t){return h(r,r.length,0,t)},t.rindex=function(r,t){return y(r,r.length-1|0,t)},t.index_from=function(r,t,e){var n=r.length;if(t<0||t>n)throw[s.invalid_argument,"String.index_from / Bytes.index_from"];return h(r,n,t,e)},t.rindex_from=function(r,t,e){if(t<-1||t>=r.length)throw[s.invalid_argument,"String.rindex_from / Bytes.rindex_from"];return y(r,t,e)},t.contains=function(r,t){return p(r,0,t)},t.contains_from=p,t.rcontains_from=function(r,t,e){if(t<0||t>=r.length)throw[s.invalid_argument,"String.rcontains_from / Bytes.rcontains_from"];try{return y(r,t,e),1}catch(r){if(r===s.not_found)return 0;throw r}},t.uppercase=function(r){return d(n.uppercase,r)},t.lowercase=function(r){return d(n.lowercase,r)},t.capitalize=function(r){return g(n.uppercase,r)},t.uncapitalize=function(r){return g(n.lowercase,r)},t.compare=b,t.unsafe_to_string=w,t.unsafe_of_string=x},function(r,t,e){"use strict";t.triangles=4,t.triangle_strip=5,t.texture0=33984,t.texture1=33985,t.texture2=33986,t.texture_2d=3553,t.blend=3042,t.texture_wrap_s=10242,t.texture_wrap_t=10243,t.clamp_to_edge=33071,t.src_alpha=770,t.one_minus_src_alpha=771,t.dst_alpha=772,t.depth_test=2929,t.rgb=6407,t.rgba=6408,t.triangle_fan=6,t.array_buffer=34962,t.element_array_buffer=34963,t.array_buffer_binding=34964,t.element_array_buffer_binding=34965,t.stream_draw=35040,t.static_draw=35044,t.dynamic_draw=35048,t.buffer_size=34660,t.buffer_usage=34661,t.float_=5126,t.unsigned_int=5125,t.current_vertex_attrib=34342,t.fragment_shader=35632,t.vertex_shader=35633,t.max_vertex_attribs=34921,t.max_vertex_uniform_vectors=36347,t.max_varying_vectors=36348,t.max_combined_texture_image_units=35661,t.max_vertex_texture_image_units=35660,t.max_texture_image_units=34930,t.max_fragment_uniform_vectors=36349,t.shader_type=35663,t.delete_status=35712,t.link_status=35714,t.validate_status=35715,t.attached_shaders=35717,t.active_uniforms=35718,t.active_attributes=35721,t.shading_language_version=35724,t.current_program=35725,t.compile_status=35713,t.vendor=7936,t.renderer=7937,t.version=7938,t.float_vec2=35664,t.float_vec3=35665,t.float_vec4=35666,t.int_vec2=35667,t.int_vec3=35668,t.int_vec4=35669,t.bool_=35670,t.bool_vec2=35671,t.bool_vec3=35672,t.bool_vec4=35673,t.float_mat2=35674,t.float_mat3=35675,t.float_mat4=35676,t.sampler_2d=35678,t.sampler_cube=35680,t.unpack_flip_y_webgl=37440,t.unpack_premultiply_alpha_webgl=37441,t.context_lost_webgl=37442,t.unpack_colorspace_conversion_webgl=37443,t.browser_default_webgl=37444,t.vertex_attrib_array_enabled=34338,t.vertex_attrib_array_size=34339,t.vertex_attrib_array_stride=34340,t.vertex_attrib_array_type=34341,t.vertex_attrib_array_normalized=34922,t.vertex_attrib_array_pointer=34373,t.vertex_attrib_array_buffer_binding=34975,t.depth_buffer_bit=256,t.stencil_buffer_bit=1024,t.color_buffer_bit=16384,t.unsigned_short=5123,t.unsigned_byte=5121,t.texture_mag_filter=10240,t.texture_min_filter=10241,t.nearest=9728,t.linear=9729,t.nearest_mipmap_nearest=9984,t.linear_mipmap_nearest=9985,t.nearest_mipmap_linear=9986,t.linear_mipmap_linear=9987},function(r,t,e){"use strict";var n=e(7),a=e(1),i=e(86),o=e(46),c=e(8),u=e(39),f=e(2),s=e(25),_=e(3),l=window,m=[l],v=function(){return new(window.AudioContext||window.webkitAudioContext)},d=[function(r){return r},function(){return o.mat4.create()},function(r){return o.mat4.identity(r),0},function(r,t,e){return o.mat4.translate(r,t,e),0},function(r,t,e){return o.mat4.scale(r,t,e),0},function(r,t,e,n){return o.mat4.rotate(r,t,e,n),0},function(r,t,e,n,a,i,c){return o.mat4.ortho(r,t,e,n,a,i,c),0}],g=["web",[function(r,t){var e=new XMLHttpRequest;return e.open("GET",r,!1),e.onreadystatechange=function(){return 4!==e.readyState||200!==e.status&&0!==e.status?0:a._1(t,e.responseText)},e.send(null),0}],[function(r){return r[0].width/window.devicePixelRatio|0},function(r){return r[0].height/window.devicePixelRatio|0},function(r){return 0|r[0].width},function(r){return 0|r[0].height},function(){return window.devicePixelRatio},function(){var r=document.createElement("canvas");return r.style.backgroundColor="black",document.body.appendChild(r),[r,a._1(v,0)]},function(r,t,e){var n=r[0];return n.width=t*window.devicePixelRatio|0,n.height=e*window.devicePixelRatio|0,n.style.width=f.string_of_int(t)+"px",n.style.height=f.string_of_int(e)+"px",0},function(r){return r[0].getContext("webgl",{preserveDrawingBuffer:1,antialias:1})}],[function(r,t,e){var n=r[1],a=new XMLHttpRequest;return a.responseType="arraybuffer",a.open("GET",t,!0),a.onreadystatechange=function(){return 4!==a.readyState||200!==a.status&&0!==a.status?0:(n.decodeAudioData(a.response,e),0)},a.send(null),0},function(r,t,e,n){var a=r[1],i=a.createBufferSource(),o=a.createGain();return o.gain.value=e,i.buffer=t,i.connect(o),o.connect(a.destination),i.start(0),i.loop=u.to_js_boolean(n),0}],[i.keycodeMap],function(r,t,e,o,c,u,f,s,m){var v=r[0];if(t){var d=t[0];v.addEventListener("mousedown",function(r){var t,e=r.button;if(e>2||e<0)throw[_.assert_failure,["reasongl.re",241,19]];t=e;var n=v.getBoundingClientRect(),i=r.clientX-n.left|0,o=r.clientY-n.top|0;return a._4(d,t,0,i,o)})}if(e){var g=e[0];v.addEventListener("mouseup",function(r){var t,e=r.button;if(e>2||e<0)throw[_.assert_failure,["reasongl.re",263,19]];t=e;var n=v.getBoundingClientRect(),i=r.clientX-n.left|0,o=r.clientY-n.top|0;return a._4(g,t,1,i,o)})}if(o){var h=o[0];v.addEventListener("mousemove",function(r){var t=v.getBoundingClientRect(),e=r.clientX-t.left|0,n=r.clientY-t.top|0;return a._2(h,e,n)})}var y=[0];if(c){var p=c[0];l.addEventListener("keydown",function(r){var t=r.which,e=n.fold_left(function(r,e){return r?1:+(e===t)},0,y[0]);return e||(y[0]=[t,y[0]]),a._2(p,i.keycodeMap(t),e)})}if(u){var b=u[0];l.addEventListener("keyup",function(r){var t=r.which;return y[0]=n.filter(function(r){return+(r!==t)})(y[0]),a._1(b,i.keycodeMap(t))})}if(f){var w=f[0];l.addEventListener("resize",function(){return a._1(w,0)})}var x=function(r,t){var e=Date.now();return a._1(s,e-r),v.__hiddenrafid=window.requestAnimationFrame(function(r){return x(e,r)}),0},k=Date.now();return v.__hiddenrafid=window.requestAnimationFrame(function(r){return x(k,r)}),0},function(r,t,e,n,a){return r.clearColor(t,e,n,a),0},function(r){return r.createProgram()},function(r,t){return r.createShader(t)},function(r,t,e){return r.attachShader(t,e),0},function(r,t){return r.deleteShader(t),0},function(r,t,e){return r.shaderSource(t,"#version 100 \n precision highp float; \n"+e),0},function(r,t){return r.compileShader(t),0},function(r,t){return r.linkProgram(t),0},function(r,t){return r.useProgram(t),0},function(r){return r.createBuffer()},function(r,t,e){return r.bindBuffer(t,e),0},function(r){return r.createTexture()},function(r,t){return r.activeTexture(t),0},function(r,t,e){return r.bindTexture(t,e),0},function(r,t,e,n){return r.texParameteri(t,e,n),0},function(r,t){return r.enable(t),0},function(r,t){return r.disable(t),0},function(r,t,e){return r.blendFunc(t,e),0},[function(r,t){switch(r){case 0:return new Float64Array(t);case 1:return new Float32Array(t);case 2:return new Int16Array(t);case 3:return new Uint16Array(t);case 4:return new Int8Array(t);case 5:case 6:return new Uint8Array(t);case 8:throw[_.assert_failure,["reasongl.re",457,17]];case 7:case 9:return new Int32Array(t)}},function(r,t){switch(r){case 0:return new Float64Array(t);case 1:return new Float32Array(t);case 2:return new Int16Array(t);case 3:return new Uint16Array(t);case 4:return new Int8Array(t);case 5:case 6:return new Uint8Array(t);case 8:throw[_.assert_failure,["reasongl.re",470,17]];case 7:case 9:return new Int32Array(t)}},function(r){return r.length},function(r,t){return r.set(t),0},function(r,t,e,n){return t.set(r,e),0},function(r,t){return r[t]},function(r,t){return r[t]},function(r,t,e){return r[t]=e,0},function(r,t,e){return r[t]=e,0},function(r,t,e){return r.subarray(t,t+e|0)}],function(r,t,e,n,a,i,o,c,u,f){return r.texSubImage2D(t,e,n,a,i,o,c,u,f),0},function(r,t,e,n,a){var i=new Uint8Array(c.imul(n,a)<<2);return r.readPixels(t,e,n,a,s.rgba,s.unsigned_byte,i),i},function(r){return r.width},function(r){return r.height},function(r,t,e,n){var i=new Image;return i.src=r,i.addEventListener("load",function(){return a._1(e,[i])}),0},function(r,t,e,n){return r.texImage2D(t,e,s.rgba,s.rgba,s.unsigned_byte,n),0},function(r,t,e){return r.uniform1i(t,e),0},function(r,t,e){return r.uniform1f(t,e),0},function(r,t,e,n){return r.uniform2f(t,e,n),0},function(r,t,e,n,a){return r.uniform3f(t,e,n,a),0},function(r,t,e,n,a,i){return r.uniform4f(t,e,n,a,i),0},function(r,t,e,n,a,i,o){return r.texImage2D(t,e,s.rgba,n,a,i,s.rgba,s.unsigned_byte,o),0},function(r,t,e,n){return r.bufferData(t,e,n),0},function(r,t,e,n,a){return r.viewport(t,e,n,a),0},function(r,t){return r.clear(t),0},function(r,t,e){return r.getUniformLocation(t,e)},function(r,t,e){return r.getAttribLocation(t,e)},function(r,t){return r.enableVertexAttribArray(t),0},function(r,t,e,n,a,i,o){var c=!!a;return r.vertexAttribPointer(t,e,n,c,i,o),0},function(r,t,e){return r.vertexAttribDivisor(t,e),0},d,function(r,t,e){return r.uniformMatrix4fv(t,!1,e),0},function(r,t,e){switch(e){case 0:return r.getProgramParameter(t,r.DELETE_STATUS)?1:0;case 1:return r.getProgramParameter(t,r.LINK_STATUS)?1:0;case 2:return r.getProgramParameter(t,r.VALIDATE_STATUS)?1:0}},function(r,t,e){switch(e){case 0:return r.getShaderParameter(t,r.DELETE_STATUS)?1:0;case 1:return r.getShaderParameter(t,r.COMPILE_STATUS)?1:0;case 2:return r.getShaderParameter(t,r.SHADER_TYPE)}},function(r,t){return r.getShaderInfoLog(t)},function(r,t){return r.getProgramInfoLog(t)},function(r,t){return r.getShaderSource(t)},function(r,t,e,n){return r.drawArrays(t,e,n),0},function(r,t,e,n,a){return r.drawElements(t,e,n,a),0},function(r,t,e,n,a,i){return r.drawElementsInstanced(t,e,n,a,i),0}];t.Document=m,t.createCanvas=function(){return document.createElement("canvas")},t.makeAudioContext=v,t.Gl=g},function(r,t,e){"use strict";var n=e(11),a=e(8),i=e(42),o=e(3),c=[-2147483648,0],u=[134217727,1],f=[0,1],s=[0,0],_=[-1,4294967295];function l(r){return+(0!=(2147483648&r))}function m(r,t){var e=t[1],n=r[1],a=n+e&4294967295,i=l(n)&&(l(e)||!l(a))||l(e)&&!l(a)?1:0;return[r[0]+t[0]+i&4294967295,a>>>0]}function v(r){return[-1^r[0],(-1^r[1])>>>0]}function d(r,t){return r[0]===t[0]?+(r[1]===t[1]):0}function g(r){return d(r,c)?c:m(v(r),f)}function h(r,t){if(t){var e=r[1];return t>=32?[e<<(t-32|0),0]:[e>>>(32-t|0)|r[0]<<t,e<<t>>>0]}return r}function y(r,t){if(t){var e=r[0];return t<32?[e>>t,(e<<(32-t|0)|r[1]>>>t)>>>0]:[e>=0?0:-1,e>>(t-32|0)>>>0]}return r}function p(r){return 0!==r[0]||0!==r[1]?0:1}function b(r,t){for(;;){var e,n=t,a=r,i=0,o=a[0],u=0,f=0,_=0;if(0!==o)_=4;else{if(0===a[1])return s;_=4}if(4===_)if(0!==n[0])f=3;else{if(0===n[1])return s;f=3}if(3===f&&(-2147483648!==o?u=2:0!==a[1]?u=2:(e=n[1],i=1)),2===u){var l=n[0],m=a[1],v=0;if(-2147483648!==l?v=3:0!==n[1]?v=3:(e=m,i=1),3===v){var d=n[1];if(o<0){if(l<0){t=g(n),r=g(a);continue}return g(b(g(a),n))}if(l<0)return g(b(a,g(n)));var h=65535&o,y=m>>>16,p=65535&m,w=65535&l,x=d>>>16,k=65535&d,M=0,S=0,C=0,P=p*k;return M=(S=(S=(C=(P>>>16)+y*k)>>>16)+((C=(65535&C)+p*x)>>>16)+h*k)>>>16,M+=(S=(65535&S)+y*x)>>>16,M+=(S=(65535&S)+p*w)>>>16,[(S&=65535)|(M=M+((o>>>16)*k+h*x+y*w+p*(l>>>16))&65535)<<16,(65535&P|(65535&C)<<16)>>>0]}}if(1===i)return 0==(1&e)?s:c}}function w(r,t){var e=t[0],n=r[0];return n>e?1:n<e?0:+(r[1]>=t[1])}function x(r,t){return r[0]>t[0]?1:r[0]<t[0]?0:+(r[1]>t[1])}function k(r){return 4294967296*r[0]+r[1]}var M=Math.pow(2,32),S=Math.pow(2,63),C=-Math.pow(2,63);function P(r){return isNaN(r)||!isFinite(r)?s:r<=C?c:r+1>=S?u:r<0?g(P(-r)):[r/M|0,(r%M|0)>>>0]}function T(r,t){for(;;){var e=t,n=r,a=n[0],i=0,u=0;if(0!==e[0])u=2;else{if(0===e[1])throw o.division_by_zero;u=2}if(2===u)if(-2147483648!==a)if(0!==a)i=1;else{if(0===n[1])return s;i=1}else if(0!==n[1])i=1;else{if(d(e,f)||d(e,_))return n;if(d(e,c))return f;var l=e[0],v=h(T(y(n,1),e),1),M=0;if(0!==v[0])M=3;else{if(0===v[1])return l<0?f:g(f);M=3}if(3===M)return m(v,T(m(n,g(b(e,v))),e))}if(1===i){var S=e[0],C=0;if(-2147483648!==S)C=2;else{if(0===e[1])return s;C=2}if(2===C){if(a<0){if(S<0){t=g(e),r=g(n);continue}return g(T(g(n),e))}if(S<0)return g(T(n,g(e)));for(var A=s,D=n;w(D,e);){for(var V=Math.max(1,Math.floor(k(D)/k(e))),U=Math.ceil(Math.log(V)/Math.LN2),N=U<=48?1:Math.pow(2,U-48),L=P(V),B=b(L,e);B[0]<0||x(B,D);)B=b(L=P(V-=N),e);p(L)&&(L=f),A=m(A,L),D=m(D,g(B))}return A}}}}t.min_int=c,t.max_int=u,t.one=f,t.zero=s,t.not=v,t.of_int32=function(r){return[r<0?-1:0,r>>>0]},t.to_int32=function(r){return 0|r[1]},t.add=m,t.neg=g,t.sub=function(r,t){return m(r,g(t))},t.lsl_=h,t.lsr_=function(r,t){if(t){var e=r[0],n=t-32|0;return n?n>0?[0,e>>>n>>>0]:[e>>>t,(e<<(0|-n)|r[1]>>>t)>>>0]:[0,e>>>0]}return r},t.asr_=y,t.is_zero=p,t.mul=b,t.xor=function(r,t){return[r[0]^t[0],(r[1]^t[1])>>>0]},t.or_=function(r,t){return[r[0]|t[0],(r[1]|t[1])>>>0]},t.and_=function(r,t){return[r[0]&t[0],(r[1]&t[1])>>>0]},t.swap=function(r){return[a.caml_int32_bswap(r[1]),a.caml_int32_bswap(r[0])>>>0]},t.ge=w,t.eq=d,t.neq=function(r,t){return 1-d(r,t)},t.lt=function(r,t){return 1-w(r,t)},t.gt=x,t.le=function(r,t){return 1-x(r,t)},t.to_float=k,t.of_float=P,t.div=T,t.mod_=function(r,t){return m(r,g(b(T(r,t),t)))},t.div_mod=function(r,t){var e=T(r,t);return[e,m(r,g(b(e,t)))]},t.compare=function(r,t){return n.caml_nativeint_compare(r[0],t[0])||n.caml_nativeint_compare(r[1],t[1])},t.to_hex=function(r){var t=function(r){return(r>>>0).toString(16)},e=r[0],n=r[1],a=0;if(0!==e)a=1;else{if(0===n)return"0";a=1}if(1===a){if(0!==n){if(0!==e){var o=t(r[1]),c=8-o.length|0;return c<=0?t(r[0])+o:t(r[0])+(i.repeat(c,"0")+o)}return t(r[1])}return t(r[0])+"00000000"}},t.discard_sign=function(r){return[2147483647&r[0],r[1]]},t.float_of_bits=function(r){var t=new Int32Array([r[1],r[0]]);return new Float64Array(t.buffer)[0]},t.bits_of_float=function(r){var t=new Float64Array([r]),e=new Int32Array(t.buffer);return[e[1],e[0]>>>0]},t.get64=function(r,t){return[r.charCodeAt(t+4|0)<<32|r.charCodeAt(t+5|0)<<40|r.charCodeAt(t+6|0)<<48|r.charCodeAt(t+7|0)<<56,(r.charCodeAt(t)|r.charCodeAt(t+1|0)<<8|r.charCodeAt(t+2|0)<<16|r.charCodeAt(t+3|0)<<24)>>>0]}},function(r,t,e){"use strict";var n=e(4),a=e(0),i=e(5),o="\n    precision mediump float;\n    attribute vec2 position;\n    uniform mat3 layout;\n    uniform mat3 origMat;\n    varying vec2 vPosition;\n    varying vec2 origPos;\n    varying vec2 texMax;\n    varying vec2 texMin;\n    uniform vec2 pixelSize;\n    varying vec2 pSize;\n    void main() {\n        vPosition = position;\n        vec2 pos = (vec3(position, 1.0) * layout).xy;\n        origPos = (vec3(position, 1.0) * origMat).xy;\n        // Max right and bottom\n        texMax = (vec3(1.0, -1.0, 1.0) * origMat).xy;\n        // Min left and top\n        texMin = (vec3(-1.0, 1.0, 1.0) * origMat).xy;\n        float aspect = pixelSize.x / pixelSize.y;\n        pSize = vec2(texMax.x / 300.0, texMin.y / 300.0 * aspect);\n        gl_Position = vec4(pos, 0.0, 1.0);\n    }\n",c="\n    precision mediump float;\n    varying vec2 vPosition;\n    varying vec2 origPos;\n    varying vec2 texMax;\n    varying vec2 texMin;\n\n    uniform float pDistance;\n    uniform vec2 pixelSize;\n    varying vec2 pSize;\n\n    uniform sampler2D orig;\n\n    float blurred(vec2 point, float pHeight, float pWidth) {\n        // Something like circular box blur\n        // should approximate bokeh effect\n        // https://en.wikipedia.org/wiki/Gaussian_blur\n        // [ 0   .8  1   .8  0  ]\n        // [ .8  1   1   1   .8 ]\n        // [ 1   1  -1-  1   1  ]\n        // [ .8  1   1   1   .8 ]\n        // [ 0   .8  1   .8  0  ]\n        float maxLeft = texMin.x - point.x;\n        float maxBottom = texMax.y - point.y;\n        float maxRight = texMax.x - point.x;\n        float maxTop = texMin.y - point.y;\n        return (\n            texture2D(orig, point + vec2(max(maxLeft, -pWidth), max(maxBottom, -pHeight*2.0))).x * 0.8 +\n            texture2D(orig, point + vec2(0.0, max(maxBottom, -pHeight*2.0))).x +\n            texture2D(orig, point + vec2(min(maxRight, pWidth), max(maxBottom, -pHeight*2.0))).x * 0.8 +\n\n            texture2D(orig, point + vec2(max(maxLeft, -pWidth*2.0), max(maxBottom, -pHeight))).x * 0.8 +\n            texture2D(orig, point + vec2(max(maxLeft, -pWidth), max(maxBottom, -pHeight))).x +\n            texture2D(orig, point + vec2(0.0, max(maxBottom, -pHeight))).x +\n            texture2D(orig, point + vec2(min(maxRight, pWidth), max(maxBottom, -pHeight))).x +\n            texture2D(orig, point + vec2(min(maxRight, pWidth*2.0), max(maxBottom, -pHeight))).x * 0.8 +\n\n            texture2D(orig, point + vec2(max(maxLeft, -pWidth*2.0), 0.0)).x +\n            texture2D(orig, point + vec2(max(maxLeft, -pWidth), 0.0)).x +\n            texture2D(orig, point + vec2(0.0, 0.0)).x +\n            texture2D(orig, point + vec2(min(maxRight, pWidth), 0.0)).x +\n            texture2D(orig, point + vec2(min(maxRight, pWidth*2.0), 0.0)).x +\n\n            texture2D(orig, point + vec2(max(maxLeft, -pWidth*2.0), min(maxTop, pHeight))).x * 0.8 +\n            texture2D(orig, point + vec2(max(maxLeft, -pWidth), min(maxTop, pHeight))).x +\n            texture2D(orig, point + vec2(0.0, min(maxTop, pHeight))).x +\n            texture2D(orig, point + vec2(min(maxRight, pWidth), min(maxTop, pHeight))).x +\n            texture2D(orig, point + vec2(min(maxRight, pWidth*2.0), min(maxTop, pHeight))).x * 0.8 +\n\n            texture2D(orig, point + vec2(max(maxLeft, -pWidth), min(maxTop, pHeight*2.0))).x * 0.8 +\n            texture2D(orig, point + vec2(0.0, min(maxTop, pHeight*2.0))).x +\n            texture2D(orig, point + vec2(min(maxRight, pWidth), min(maxTop, pHeight*2.0))).x * 0.8\n        ) / (13.0 + 0.8 * 8.0);\n    }\n\n    void main() {\n        float pHeight = pSize.y * pDistance;\n        float pWidth = pSize.x * pDistance;\n        float b = blurred(origPos, pHeight, pWidth);\n        gl_FragColor = vec4(b, b, b, 1.0);\n\n        /*\n        float maxLeft = texMin.x - origPos.x;\n        float maxBottom = texMax.y - origPos.y;\n        float maxRight = texMax.x - origPos.x;\n        float maxTop = texMin.y - origPos.y;\n        gl_FragColor = vec4(maxLeft, maxBottom*-1., maxRight, 1.0);\n        */\n        //gl_FragColor = vec4(texture2D(orig, origPos).x, 1.0, 0.0, 1.0);\n    }\n",u=[0];t.blurVertex=o,t.blurFragment=c,t.blurProgram=u,t.makeNode=function(r,t,e,f,s){var _,l=u[0];if(l)_=l[0];else{var m=i.makeProgram(n.Shader[0](o),n.Shader[0](c),0,[[["pDistance",0],0]],0,[[["orig",1],0]],n.VertexBuffer[3](0),[i.defaultVo(0)],0,[1],0,0,0);u[0]=[m],_=m}var v=i.makeNode(0,["blur1"],0,0,[_],0,0,[[["orig",i.SceneTex[0](0,0,r)],0]],0,0,[[["pDistance",i.UFloat[0](f)],0]],0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,[[r,0]],[a.__(2,[e])],0,0,0);return i.makeNode(0,["blur2"],0,0,[_],0,0,[[["orig",i.SceneTex[0](0,0,v)],0]],0,0,[[["pDistance",i.UFloat[0](s)],0]],0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,[[v,0]],[a.__(2,[t])],0,0,0)}},function(r,t,e){"use strict";var n=e(1),a=e(57),i=e(2);function o(r,t,e){return"\n        float cols = "+i.string_of_float(r)+";\n        float rows = "+i.string_of_float(t)+";\n        float cols2 = cols * 2.0;\n        float rows2 = rows * 2.0;\n        point.x = mod(point.x, 1.0 / cols) - 1.0 / cols2;\n        point.y = mod(point.y, 1.0 / rows) - 1.0 / rows2;\n        float boxWidth = 1.0 / cols2;\n        float boxHeight = 1.0 / rows2;\n        float boxDepth = 0.005;\n        float box = length(max(abs(point) - vec3(boxWidth, boxHeight, boxDepth), vec3(0.0, 0.0, 0.0)));\n        // Octahedron towards z\n        /*\n        float rot = 20.0;\n        mat3 xrot = mat3(\n            1.0, 0.0, 0.0,\n            0.0, cos(rot), -sin(rot),\n            0.0, sin(rot), cos(rot)\n        );\n        point = point * xrot;\n        */\n        float d = 0.0;\n        // Dont know too much of what I'm doing here..\n        // sdpyramid from https://www.shadertoy.com/view/Xds3zN with some modifications\n        vec3 octa = vec3(0.5 * boxHeight / boxWidth, 0.5, 0.24);\n        d = max( d, abs( dot(point, vec3( -octa.x, 0, octa.z )) ));\n        d = max( d, abs( dot(point, vec3(  octa.x, 0, octa.z )) ));\n        d = max( d, abs( dot(point, vec3(  0, -octa.y, octa.z )) ));\n        d = max( d, abs( dot(point, vec3(  0, octa.y, octa.z )) ));\n        // Some spacing added, maybe this should be calibrated to a pixel\n        float o = d - octa.z / (rows + "+i.string_of_float(e)+");\n        // Intersection\n        //return o;\n        return max(o, box);\n    "}var c=[function(r){return[r[0],r[1],r[2],a.makeHash(r[3])]},function(r){return a.makeProgram(r[3])},3],u=e(21).Make(c);t.sdfDist=o,t.StoreSpec=c,t.Programs=u,t.makeNode=function(r,t,e,i,c,f,s,_,l,m,v){var d=m?m[0]:1.3,g=r/t,h=_?0:1,y=a.make(o(r,t,d),h,_,e,0,0,f,0,c,0,0,0),p=[r,t,d,y],b=n._1(u[1],p);return a.makeNode(y,s,["sdfTiles"],[g],i,l,0,[b],0)}},function(r,t,e){"use strict";var n=e(4),a=e(7),i=e(0),o=e(1),c=e(14),u=e(59),f=e(31);function s(r,t){if(c.mem(r[2],t))return c.find(r[2],t);var e=n.Texture[0](0,3,0);return c.add(r[2],t,e),e}function _(r,t,e){if(c.mem(r[0],t))return o._2(e,c.find(r[0],t),c.find(r[1],t));if(c.mem(r[3],t)){var _=c.find(r[4],t);return c.replace(r[4],t,[e,_])}return c.add(r[3],t,1),c.add(r[4],t,[e,0]),u.request(t,"sheet0",function(e){var u=f.parse(e[0]),_=s(r,t);n.Texture[1](_,i.__(0,[e[1]])),c.add(r[0],t,u),c.add(r[1],t,e[1]);var l=c.find(r[4],t);return c.remove(r[4],t),a.iter(function(r){return o._2(r,u,e[1])},l)})}t.make=function(r,t){var e=r?r[0]:2;return[c.create(0,e),c.create(0,e),c.create(0,e),c.create(0,e),c.create(0,e)]},t.getTexture=s,t.request=_,t.requestMultiple=function(r,t,e){var n=[a.length(t)];return a.iter(function(t){return _(r,t,function(t,a){return n[0]=n[0]-1|0,n[0]?0:o._1(e,r)})},t)}},function(r,t,e){"use strict";var n=e(7),a=e(0),i=e(6),o=e(8),c=e(2),u=e(60);function f(r,t){var e=u.readUInt8(r,t+2|0);return[u.readInt16LE(r,t),+(1==(e>>7&1)),+(1==(e>>6&1)),+(1==(e>>5&1)),+(1==(e>>4&1)),+(1==(e>>3&1)),u.readUInt8(r,t+3|0),u.readUInt16LE(r,t+4|0),u.readUInt8(r,t+6|0),[u.readInt8(r,t+7|0),u.readInt8(r,t+8|0),u.readInt8(r,t+9|0),u.readInt8(r,t+10|0)],[u.readInt8(r,t+11|0),u.readInt8(r,t+12|0)],u.readUInt8(r,t+13|0),u.readStringNT(r,t+14|0)]}function s(r,t){var e=u.readUInt16LE(r,t),n=u.readUInt16LE(r,t+2|0);return[e,n,2/e,2/n,u.readUInt16LE(r,t+4|0),u.readUInt16LE(r,t+6|0),u.readUInt16LE(r,t+8|0),0,u.readUInt8(r,t+11|0),u.readUInt8(r,t+12|0),u.readUInt8(r,t+12|0),u.readUInt8(r,t+13|0)]}function _(r,t,e){var a=u.readStringNT(r,t),i=a.length+1|0,c=o.div(e,i);return n.rev(function(e,n){for(;;){var f=n,s=e;if(s>=c)return f;n=[u.readStringSlice(r,t+o.imul(s,i)|0,(t+o.imul(s,i)|0)+a.length|0),f],e=s+1|0}}(0,0))}function l(r,t,e){return n.rev(function(n,a){for(;;){var i=a,c=n;if(c>=(e/20|0))return i;var f=o.imul(c,20);a=[[u.readUInt32LE(r,(t+0|0)+f|0),u.readUInt16LE(r,(t+4|0)+f|0),u.readUInt16LE(r,(t+6|0)+f|0),u.readUInt16LE(r,(t+8|0)+f|0),u.readUInt16LE(r,(t+10|0)+f|0),u.readInt16LE(r,(t+12|0)+f|0),u.readInt16LE(r,(t+14|0)+f|0),u.readUInt16LE(r,(t+16|0)+f|0),u.readUInt8(r,(t+18|0)+f|0),u.readUInt8(r,(t+19|0)+f|0)],i],n=c+1|0}}(0,0))}function m(r,t,e){return n.rev(function(n,a){for(;;){var i=a,c=n;if(c>=(e/10|0))return i;var f=o.imul(c,10);a=[[u.readUInt32LE(r,t+f|0),u.readUInt32LE(r,(t+4|0)+f|0),u.readInt16LE(r,(t+8|0)+f|0)],i],n=c+1|0}}(0,0))}function v(r,t){if(t>(r.length-1|0))return[0,0];var e,o=u.readUInt8(r,t),c=u.readInt32LE(r,t+1|0),v=t+5|0,d=o-1|0;if(d>4||d<0)e=0;else switch(d){case 0:e=a.__(0,[f(r,v)]);break;case 1:e=a.__(1,[s(r,v)]);break;case 2:e=a.__(2,[_(r,v,c)]);break;case 3:var g=l(r,v,c),h=n.fold_left(function(r,t){return t[0]>r?t[0]:r},0,g),y=i.caml_make_vect(h+1|0,0);n.iter(function(r){return i.caml_array_set(y,r[0],[r])},g),e=a.__(3,[g,y]);break;case 4:e=a.__(4,[m(r,v,c)])}return[c+5|0,e]}t.Buffer=0,t.addGlChar=function(r,t){var e=i.caml_array_get(r[5],t),n=e?e[0]:c.failwith("Could not find bmchar for code "+c.string_of_int(t)),a=r[2][4],o=r[2][5],u=r[2][2],f=n[1]/a,s=n[2]/o,_=[f,s,f+n[3]/a,s+n[4]/o,n[3]*u,n[4]*u,n[5]*u,n[6]*u,n[7]*u];return i.caml_array_set(r[6],t,[_]),_},t.readInfo=f,t.readCommon=s,t.readPages=_,t.readChars=l,t.readKernings=m,t.readBlock=v,t.parse=function(r){66===u.readUInt8(r,0)&&77===u.readUInt8(r,1)&&70===u.readUInt8(r,2)||c.failwith("Could not verify header"),3!==u.readUInt8(r,3)&&c.failwith("Only version 3 supported");for(var t=4,e=[0,0,0,0,0,0],n=0;n<=4;++n){var a=v(r,t),o=a[1];if("number"!=typeof o)switch(0|o.tag){case 0:e[1]=[o[0]];break;case 1:e[2]=[o[0]];break;case 2:e[3]=[o[0]];break;case 3:e[4]=[o[0]],e[5]=[o[1]];break;case 4:e[0]=[o[0]]}t=t+a[0]|0}var f=e[0],s=e[1],_=e[2],l=e[3],m=e[4],d=e[5];if(f){if(s){if(_){if(l){if(m){if(d){var g=d[0];return[f[0],s[0],_[0],l[0],m[0],g,i.caml_make_vect(g.length,0)]}return c.failwith("Could not parse font")}return c.failwith("Could not parse font")}return c.failwith("Could not parse font")}return c.failwith("Could not parse font")}return c.failwith("Could not parse font")}if(s){if(_){if(l){if(m){if(d){var h=d[0];return[0,s[0],_[0],l[0],m[0],h,i.caml_make_vect(h.length,0)]}return c.failwith("Could not parse font")}return c.failwith("Could not parse font")}return c.failwith("Could not parse font")}return c.failwith("Could not parse font")}return c.failwith("Could not parse font")},t.getKerning=function(r,t,e){for(var n=r[0];;){var a=n;if(!a)return 0;var i=a[0];if(i[0]===t&&i[1]===e)return i[2];n=a[1]}}},function(r,t,e){"use strict";var n=e(7),a=e(0),i=e(13),o=e(1),c=e(61),u=e(15),f=e(14),s=e(6),_=e(8),l=e(2),m=e(9),v=e(31),d="digitalt",g=i.fromFloats(1,1,1);function h(r,t,e,n,i,o,c){var u=o?o[0]:[r,t,e,n,i];return a.__(1,[[u,c]])}var y=c.Make([function(){return[0,0,0,0,0,[1,1,1],[0,0,0,0,0,0,0,0,0],0]},0]);function p(r,t,e){var n=r[1][0],a=0!==e?32:20,i=s.caml_make_vect(_.imul(t,a),0);return e?function(r,e){for(;;){var o=e,c=r;if(!(c<t))return 0;var u=s.caml_array_get(n,c),f=u[6];s.caml_array_set(i,o,u[0]),s.caml_array_set(i,o+1|0,u[1]-u[3]),s.caml_array_set(i,o+2|0,f[0]),s.caml_array_set(i,o+3|0,f[3]),s.caml_array_set(i,o+4|0,u[4]),s.caml_array_set(i,o+5|0,s.caml_array_get(u[5],0)),s.caml_array_set(i,o+6|0,s.caml_array_get(u[5],1)),s.caml_array_set(i,o+7|0,s.caml_array_get(u[5],2)),s.caml_array_set(i,o+8|0,u[0]+u[2]),s.caml_array_set(i,o+9|0,u[1]-u[3]),s.caml_array_set(i,o+10|0,f[2]),s.caml_array_set(i,o+11|0,f[3]),s.caml_array_set(i,o+12|0,u[4]),s.caml_array_set(i,o+13|0,s.caml_array_get(u[5],0)),s.caml_array_set(i,o+14|0,s.caml_array_get(u[5],1)),s.caml_array_set(i,o+15|0,s.caml_array_get(u[5],2)),s.caml_array_set(i,o+16|0,u[0]+u[2]),s.caml_array_set(i,o+17|0,u[1]),s.caml_array_set(i,o+18|0,f[2]),s.caml_array_set(i,o+19|0,f[1]),s.caml_array_set(i,o+20|0,u[4]),s.caml_array_set(i,o+21|0,s.caml_array_get(u[5],0)),s.caml_array_set(i,o+22|0,s.caml_array_get(u[5],1)),s.caml_array_set(i,o+23|0,s.caml_array_get(u[5],2)),s.caml_array_set(i,o+24|0,u[0]),s.caml_array_set(i,o+25|0,u[1]),s.caml_array_set(i,o+26|0,f[0]),s.caml_array_set(i,o+27|0,f[1]),s.caml_array_set(i,o+28|0,u[4]),s.caml_array_set(i,o+29|0,s.caml_array_get(u[5],0)),s.caml_array_set(i,o+30|0,s.caml_array_get(u[5],1)),s.caml_array_set(i,o+31|0,s.caml_array_get(u[5],2)),e=o+a|0,r=c+1|0}}(0,0):function(r,e){for(;;){var o=e,c=r;if(!(c<t))return 0;var u=s.caml_array_get(n,c),f=u[6];s.caml_array_set(i,o,u[0]),s.caml_array_set(i,o+1|0,u[1]-u[3]),s.caml_array_set(i,o+2|0,f[0]),s.caml_array_set(i,o+3|0,f[3]),s.caml_array_set(i,o+4|0,u[4]),s.caml_array_set(i,o+5|0,u[0]+u[2]),s.caml_array_set(i,o+6|0,u[1]-u[3]),s.caml_array_set(i,o+7|0,f[2]),s.caml_array_set(i,o+8|0,f[3]),s.caml_array_set(i,o+9|0,u[4]),s.caml_array_set(i,o+10|0,u[0]+u[2]),s.caml_array_set(i,o+11|0,u[1]),s.caml_array_set(i,o+12|0,f[2]),s.caml_array_set(i,o+13|0,f[1]),s.caml_array_set(i,o+14|0,u[4]),s.caml_array_set(i,o+15|0,u[0]),s.caml_array_set(i,o+16|0,u[1]),s.caml_array_set(i,o+17|0,f[0]),s.caml_array_set(i,o+18|0,f[1]),s.caml_array_set(i,o+19|0,u[4]),e=o+a|0,r=c+1|0}}(0,0),i}function b(r){return[f.find(r[0][0],d),.2,2,0,0,g]}function w(r,t){var e=b(r),a=[-1,1,0,0,-1,0,0],c=[0,a[0],0,0,0,0,0,e],u=r[1],_=function(r,t,e){for(;;){var n=t;if(s.caml_array_get(u[0],n)[0]=s.caml_array_get(u[0],n)[0]+r,!(n<e))return 0;t=n+1|0}},d=function(r,t,e,n){for(;;){var a=e;if(s.caml_array_get(u[0],a)[0]=s.caml_array_get(u[0],a)[0]+r,s.caml_array_get(u[0],a)[1]=s.caml_array_get(u[0],a)[1]+t,!(a<=n))return 0;e=a+1|0}},g=function(r,t){if(!(r>=0))return 0;var e=s.caml_array_get(u[0],r);switch(t[2]){case 0:return 0;case 1:var n=(t[1]-e[0]-e[2])/2;return _(n,c[5],r);case 2:var a=t[1]-e[0]-e[2];return _(a,c[5],r)}},h=function(r,t){for(;;){var e=r;if(e<t)return 0;if(32!==s.caml_array_get(u[0],e)[7])return[e];r=e-1|0}},p=function(r){var t=h(r,c[5]),e=t?t[0]+1|0:c[5],a=1+(r-e|0)|0,i=(c[0]-1|0)-r|0,o=l.min(a,i);if(o>0){var f=function(r,t,e){for(;;){var n=e,a=r;if(!(a<t))return n;e=[s.caml_array_get(u[0],a),n],r=a+1|0}}(e,e+o|0,0);!function(r,t,e){for(;;){var n=r;if(!(n<=t))return 0;s.caml_array_set(u[0],n,s.caml_array_get(u[0],n+e|0)),r=n+1|0}}(e,e+o|0,a),n.iteri(function(r,t){return s.caml_array_set(u[0],(e+a|0)+r|0,t)},f)}return a},w=function(r){for(;;){var t=r;if(t<=c[5])return 0;if(32===s.caml_array_get(u[0],t)[7])return[t];r=t-1|0}},x=function(r,t,e){g(r,e),c[5]=r+1|0,c[6]=0;var n=t[1]*t[2];return c[2]-=n,c[3]-=n,e[5]=c[3],c[3]<e[6]?(e[6]=c[3],0):0},k=function(r,t){var e=r[1]*r[2];return c[2]=c[2]-r[1]+r[0][2][3]*r[1]*2,c[3]-=e,t[5]=c[3],c[3]<t[6]&&(t[6]=c[3]),c[5]=c[0],c[6]=0,0},M=function(t,e,n){for(;;){var a=t;if(!a)return 0;var _=a[0];switch(0|_.tag){case 0:var l=_[0];n[3]||(n[3]=1,k(e,n)),c[4]=1;var b=l.length;o._2(y[3],r[1],c[0]+b|0),function(r,t,a){return function(o){for(;;){var f=o;if(f<t){var _=m.get(r,f);if(10===_){var l=h(c[0]-1|0,c[5]);if(l){var g=l[0];c[0]=g+1|0,x(g,e,n),c[1]=n[0],o=f+1|0;continue}x(c[0]-1|0,e,n),c[1]=n[0],o=f+1|0;continue}var y,b=s.caml_array_get(e[0][6],_),k=b?b[0]:v.addGlChar(e[0],_),M=c[6];if(M?c[1]=c[1]+e[4]+v.getKerning(e[0],M[0],_)*a*e[1]:c[1]+=e[4],c[1]+k[4]*e[1]>n[1]){var S=function(e){for(;;){var n=e;if(n>=t)return 0;if(32!==m.get(r,n))return[n];e=n+1|0}},C=w(c[0]-1|0);if(C){var P=C[0],T=p(P);c[0]=1+(c[0]-T|0)|0;var A=P-T|0;if(x(A,e,n),(c[0]-1|0)>A){var D=-1*(s.caml_array_get(u[0],A+1|0)[0]+1),V=e[1]*e[2]*-1;d(D,V,A+1|0,c[0]-1|0);var U=s.caml_array_get(u[0],c[0]-1|0);c[1]=U[0]+U[6][8]*e[1]}else c[1]=n[0];y=S(f)}else{x(c[0]-1|0,e,n);var N=S(f);N?(c[1]=n[0],y=N):y=0}}else y=[f];if(y){var L=y[0],B=s.caml_array_get(u[0],c[0]);if(B[0]=c[1]+k[6]*e[1],B[1]=c[2]-k[7]*e[1],B[2]=k[4]*e[1],B[3]=k[5]*e[1],B[4]=e[1],B[7]=_,B[5]=i.toArray(e[5]),B[6]=k,L<t){c[0]=c[0]+1|0,c[1]+=k[8]*e[1],o=L+1|0;continue}return 0}return 0}return 0}}}(l,b,e[0][2][2])(0);break;case 1:var S=_[0],C=S[0],P=C[1],T=P?P[0]:e[1],A=C[3],D=A?A[0]:e[3],V=D*T,U=C[0],N=U?f.find(r[0][0],U[0]):e[0],L=C[4],B=C[2],F=[N,T,L?L[0]:e[2],D,V,B?B[0]:e[5]];c[7]=F,M(S[1],F,n);break;case 2:var I=_[0],z=I[0];c[4]&&(c[4]=0,g(c[0]-1|0,n));var E,q=z[3],R=q?q[0]:e[1],G=z[5],H=G?G[0]:e[3],O=H*R,K=z[2],j=K?f.find(r[0][0],K[0]):e[0],W=z[6],$=z[4],X=[j,R,W?W[0]:e[2],H,O,$?$[0]:e[5]],Q=n[1]-n[0],Y=z[1],Z=Y?Q*Y[0]:Q;if(n[4]+Z<=n[1]){var J=n[4];n[4]+=Z,E=[J,J+Z]}else n[5]=n[6],n[4]=n[0]+Z,E=[n[0],n[0]+Z];var rr=E[0],tr=z[0],er=[rr,E[1],tr?tr[0]:n[2],0,n[4],n[5],n[5]];c[7]=X,c[1]=rr,c[2]=n[5],c[3]=c[2],M(I[1],X,er),c[4]&&(c[4]=0,g(c[0]-1|0,er)),er[6]<n[6]&&(n[6]=er[6])}t=a[1]}};return M([t,0],e,a),[c[0],a[6]]}var x=[function(r){return[r,o._1(y[1],100)]},20,32,p,b,function(){return[-1,1,0,0,-1,0,0]},w,function(r,t,e){var n=w(r,t);return[p(r,n[0],e),n[1]]}];t.BMFont=0,t.blockStyle=function(r,t,e,n,a,i,o,c){return[r,t,e,n,a,i,o]},t.textStyle=function(r,t,e,n,a,i){return[r,t,e,n,a]},t.defaultFont=d,t.defaultHeight=.2,t.defaultColor=g,t.block=function(r,t,e,n,i,o,c,u,f){var s=u?u[0]:[r,t,e,n,i,o,c];return a.__(2,[[s,f]])},t.styled=h,t.text=function(r){return a.__(0,[r])},t.styledText=function(r,t,e,n,i){return h(r,t,e,0,n,0,[a.__(0,[i]),0])},t.getPartInfo=function(r){var t=[0],e=[0],a=function(r,n,a){var i=n?[[n[0],r[0]],r[1]]:t[0]?r:(t[0]=1,[[d,r[0]],r[1]]);return a?[i[0],[a[0],i[1]]]:e[0]?i:(e[0]=1,[i[0],[g,i[1]]])},o=function(r,t){switch(0|r.tag){case 0:return t;case 1:var e=r[0],i=a(t,e[0][0],e[0][2]);return n.fold_left(function(r,t){return o(t,r)},i,e[1]);case 2:var c=r[0],u=a(t,c[0][2],c[0][4]);return n.fold_left(function(r,t){return o(t,r)},u,c[1])}},c=o(r,[0,0]);return[n.sort_uniq(u.compare,c[0]),n.sort_uniq(i.compare,c[1])]},t.getPartText=function r(t){switch(0|t.tag){case 0:return t[0];case 1:return n.fold_left(function(t,e){return t+r(e)},"",t[0][1]);case 2:return n.fold_left(function(t,e){return t+r(e)},"",t[0][1])+"\n"}},t.GlyphArrayB=y,t.FontLayout=x},function(r,t,e){"use strict";var n=e(1),a=e(11),i=e(16).create("Queue.Empty");function o(r){return r[0]=0,r[1]=0,0}function c(r,t){if(t[0]){var e=t[1],n=[r,e[1]];return t[0]=t[0]+1|0,e[1]=n,t[1]=n,0}var a=[];return a[0]=r,a[1]=a,t[0]=1,t[1]=a,0}function u(r){if(r[0])return r[1][1][0];throw i}function f(r){if(!r[0])throw i;r[0]=r[0]-1|0;var t=r[1],e=t[1];return e===t?r[1]=0:t[1]=e[1],e[0]}var s=c,_=f,l=u;t.Empty=i,t.create=function(){return[0,0]},t.add=c,t.push=s,t.take=f,t.pop=_,t.peek=u,t.top=l,t.clear=o,t.copy=function(r){if(r[0]){var t=r[1],e=[];return a.caml_update_dummy(e,[t[0],e]),function(r,n){for(;;){var a=n,i=r;if(a===t)return 0;var o=[a[0],e];i[1]=o,n=a[1],r=o}}(e,t[1]),[r[0],e]}return[0,0]},t.is_empty=function(r){return+(0===r[0])},t.length=function(r){return r[0]},t.iter=function(r,t){if(!(t[0]>0))return 0;for(var e=t[1],a=e[1];;){var i=a;if(n._1(r,i[0]),i===e)return 0;a=i[1]}},t.fold=function(r,t,e){if(!e[0])return t;for(var a=e[1],i=t,o=a[1];;){var c=o,u=i,f=n._2(r,u,c[0]);if(c===a)return f;o=c[1],i=f}},t.transfer=function(r,t){var e=r[0];if(e>0){var n=r[1];if(o(r),t[0]>0){var a=t[1],i=n[1],c=a[1];n[1]=c,a[1]=i}return t[0]=t[0]+e|0,t[1]=n,0}return 0}},function(r,t,e){"use strict";var n=e(12),a=e(1),i=e(82),o=e(81),c=e(80),u=e(43),f=e(78),s=e(6),_=e(27),l=e(2),m=e(9),v=e(3);function d(r,t){return n.blit(t[0],0,r[0],0,55),r[1]=t[1],0}function g(r,t){for(var e=function(r,t){return c.string(r+t)},n=t.length?t:[0],a=n.length,i=0;i<=54;++i)s.caml_array_set(r[0],i,i);for(var o,u="x",f=0,_=54+l.max(55,a)|0;f<=_;++f){var v=f%55,d=f%a;u=e(u,s.caml_array_get(n,d)),s.caml_array_set(r[0],v,1073741823&(s.caml_array_get(r[0],v)^(o=u,((m.get(o,0)+(m.get(o,1)<<8)|0)+(m.get(o,2)<<16)|0)+(m.get(o,3)<<24)|0)))}return r[1]=0,0}function h(r){var t=[s.caml_make_vect(55,0),0];return g(t,r),t}function y(r){var t=[s.caml_make_vect(55,0),0];return d(t,r),t}function p(r){r[1]=(r[1]+1|0)%55;var t=s.caml_array_get(r[0],r[1]),e=1073741823&(s.caml_array_get(r[0],(r[1]+24|0)%55)+(t^t>>>25&31)|0);return s.caml_array_set(r[0],r[1],e),e}function b(r,t){if(t>1073741823||t<=0)throw[v.invalid_argument,"Random.int"];for(var e=r,n=t;;){var a=p(e),i=a%n;if(!((a-i|0)>(1+(1073741823-n|0)|0)))return i}}function w(r,t){if(t<=0)throw[v.invalid_argument,"Random.int32"];for(var e=r,n=t;;){var a=p(e)|(1&p(e))<<30,o=a%n;if(!((a-o|0)>(1+(i.max_int-n|0)|0)))return o}}function x(r,t){if(_.le(t,[0,0]))throw[v.invalid_argument,"Random.int64"];for(var e=r,n=t;;){var a=_.of_int32(p(e)),i=_.lsl_(_.of_int32(p(e)),30),c=_.lsl_(_.of_int32(7&p(e)),60),u=_.or_(a,[i[0]|c[0],(i[1]|c[1])>>>0]),f=_.mod_(u,n);if(!_.gt(_.sub(u,f),_.add(_.sub(o.max_int,n),[0,1])))return f}}var k=32===f.size?w:function(r,t){return 0|x(r,_.of_int32(t))[1]};function M(r){return(p(r)/1073741824+p(r))/1073741824}function S(r){return+(0==(1&p(r)))}var C=[[987910699,495797812,364182224,414272206,318284740,990407751,383018966,270373319,840823159,24560019,536292337,512266505,189156120,730249596,143776328,51606627,140166561,366354223,1003410265,700563762,981890670,913149062,526082594,1021425055,784300257,667753350,630144451,949649812,48546892,415514493,258888527,511570777,89983870,283659902,308386020,242688715,482270760,865188196,1027664170,207196989,193777847,619708188,671350186,149669678,257044018,87658204,558145612,183450813,28133145,901332182,710253903,510646120,652377910,409934019,801085050],0];function P(r){return g(C,r)}var T=[h,function(){return h(u.caml_sys_random_seed(0))},y,p,b,w,k,x,function(r,t){return M(r)*t},S];t.init=function(r){return g(C,[r])},t.full_init=P,t.self_init=function(){return P(u.caml_sys_random_seed(0))},t.bits=function(){return p(C)},t.$$int=function(r){return b(C,r)},t.int32=function(r){return w(C,r)},t.nativeint=function(r){return a._2(k,C,r)},t.int64=function(r){return x(C,r)},t.$$float=function(r){return M(C)*r},t.bool=function(){return S(C)},t.State=T,t.get_state=function(){return y(C)},t.set_state=function(r){return d(C,r)}},function(r,t,e){"use strict";t.caml_int32_float_of_bits=function(r){var t=new Int32Array([r]);return new Float32Array(t.buffer)[0]},t.caml_int32_bits_of_float=function(r){var t=new Float32Array([r]);return new Int32Array(t.buffer)[0]},t.caml_classify_float=function(r){return isFinite(r)?Math.abs(r)>=2.2250738585072014e-308?0:0!==r?1:2:isNaN(r)?4:3},t.caml_modf_float=function(r){if(isFinite(r)){var t=+(1/r<0),e=Math.abs(r),n=Math.floor(e),a=e-n;return t?[-a,-n]:[a,n]}return isNaN(r)?[NaN,NaN]:[1/r,r]},t.caml_ldexp_float=function(r,t){var e=[t],n=[r];return e[0]>1023?(e[0]-=1023,n[0]=n[0]*Math.pow(2,1023),e[0]>1023&&(e[0]-=1023,n[0]=n[0]*Math.pow(2,1023))):e[0]<-1023&&(e[0]+=1023,n[0]=n[0]*Math.pow(2,-1023)),n[0]*Math.pow(2,e[0])},t.caml_frexp_float=function(r){if(0!==r&&isFinite(r)){var t=+(r<0),e=Math.abs(r),n=Math.floor(Math.LOG2E*Math.log(e))+1;return(e*=Math.pow(2,-n))<.5&&(e*=2,n-=1),t&&(e=-e),[e,0|n]}return[r,0]},t.caml_float_compare=function(r,t){return r===t?0:r<t?-1:r>t||r==r?1:t==t?-1:0},t.caml_copysign_float=function(r,t){var e=Math.abs(r);return(0===t?1/t:t)<0?-e:e},t.caml_expm1_float=function(r){var t=Math.exp(r),e=t-1;return Math.abs(r)>1?e:0===e?r:r*e/Math.log(t)},t.caml_hypot_float=function(r,t){var e=Math.abs(r),n=Math.abs(t),a=e,i=Math.max(a,n),o=Math.min(a,n)/(0!==i?i:1);return i*Math.sqrt(1+o*o)},t.caml_log10_float=function(r){return Math.LOG10E*Math.log(r)}},function(r,t,e){"use strict";var n=e(24),a=e(1),i=e(15),o=e(2),c=e(9),u=e(3);function f(r,t){for(var e=r[2];(r[1]+t|0)>e;)e<<=1;var a=c.caml_create_string(e);return n.blit(r[0],0,a,0,r[1]),r[0]=a,r[2]=e,0}function s(r,t){var e=r[1];return e>=r[2]&&f(r,1),r[0][e]=t,r[1]=e+1|0,0}function _(r,t,e,a){if(e<0||a<0||(e+a|0)>t.length)throw[u.invalid_argument,"Buffer.add_substring/add_subbytes"];var i=r[1]+a|0;return i>r[2]&&f(r,a),n.blit_string(t,e,r[0],r[1],a),r[1]=i,0}function l(r,t,e,n){return _(r,c.bytes_to_string(t),e,n)}function m(r,t){var e=t.length,a=r[1]+e|0;return a>r[2]&&f(r,e),n.blit_string(t,0,r[0],r[1],e),r[1]=a,0}function v(r,t,e){if(t>=e)throw u.not_found;var n=c.get(r,t),a=0;if(40!==n){if(123!==n){var o=function(r,t){for(var e=t,n=r.length;;){var a=e;if(a>=n)return n;var i=c.get(r,a),o=0;if(i>=91)if(i>=97){if(i>=123)return a;o=1}else{if(95!==i)return a;o=1}else if(i>=58){if(!(i>=65))return a;o=1}else{if(!(i>=48))return a;o=1}1!==o||(e=a+1|0)}}(r,t+1|0);return[i.sub(r,t,o-t|0),o]}a=1}else a=1;if(1===a){var f=t+1|0,s=function(r,t,e,n,a){for(var i=0,o=a,f=n.length;;){var s=o,_=i;if(s>=f)throw u.not_found;if(c.get(n,s)!==r){if(c.get(n,s)===t){if(_){o=s+1|0,i=_-1|0;continue}return s}o=s+1|0}else o=s+1|0,i=_+1|0}}(n,function(r){if(40!==n){if(123!==n)throw[u.assert_failure,["buffer.ml",126,9]];return 125}return 41}(),0,r,f);return[i.sub(r,f,(s-t|0)-1|0),s+1|0]}}t.create=function(r){var t=r<1?1:r,e=c.caml_create_string(t);return[e,0,t,e]},t.contents=function(r){return n.sub_string(r[0],0,r[1])},t.to_bytes=function(r){return n.sub(r[0],0,r[1])},t.sub=function(r,t,e){if(t<0||e<0||t>(r[1]-e|0))throw[u.invalid_argument,"Buffer.sub"];return n.sub_string(r[0],t,e)},t.blit=function(r,t,e,a,i){if(i<0||t<0||t>(r[1]-i|0)||a<0||a>(e.length-i|0))throw[u.invalid_argument,"Buffer.blit"];return n.blit(r[0],t,e,a,i)},t.nth=function(r,t){if(t<0||t>=r[1])throw[u.invalid_argument,"Buffer.nth"];return r[0][t]},t.length=function(r){return r[1]},t.clear=function(r){return r[1]=0,0},t.reset=function(r){return r[1]=0,r[0]=r[3],r[2]=r[0].length,0},t.add_char=s,t.add_string=m,t.add_bytes=function(r,t){return m(r,c.bytes_to_string(t))},t.add_substring=_,t.add_subbytes=l,t.add_substitute=function(r,t,e){for(var n=e.length,i=32,o=0;;){var u=o,f=i;if(!(u<n))return 92===f?s(r,f):0;var _=c.get(e,u);if(36===_)if(92!==f){var l=v(e,u+1|0,n);m(r,a._1(t,l[0])),o=l[1],i=32}else s(r,_),o=u+1|0,i=32;else{if(92===f){s(r,92),s(r,_),o=u+1|0,i=32;continue}if(92!==_){s(r,_),o=u+1|0,i=_;continue}o=u+1|0,i=_}}},t.add_buffer=function(r,t){return l(r,t[0],0,t[1])},t.add_channel=function(r,t,e){if(e<0)throw[u.invalid_argument,"Buffer.add_channel"];return(r[1]+e|0)>r[2]&&f(r,e),o.really_input(t,r[0],r[1],e),r[1]=r[1]+e|0,0},t.output_buffer=function(r,t){return o.output(r,t[0],0,t[1])}},function(r,t,e){"use strict";var n=e(7),a=e(0),i=e(1),o=e(85),c=e(14),u=performance,f=[u,function(){return[u.now(),0]},function(r,t){var e=u.now()-t[0]|0;return r?i._2(o.printf([a.__(11,["Time ",a.__(2,[0,a.__(12,[32,a.__(4,[0,0,0,a.__(11,[" milliseconds\n",0])])])])]),"Time %s %d milliseconds\n"]),r[0],e):i._1(o.printf([a.__(11,["Time ",a.__(4,[0,0,0,a.__(11,[" milliseconds\n",0])])]),"Time %d milliseconds\n"]),e)}];t.listToTbl=function(r){var t=n.length(r),e=+(t>0),a=c.create(0,0!==e?t:1);return n.iter(function(r){return c.add(a,r[0],r[1])},r),a},t.listRange=function(r){for(var t=0,e=r;;){var n=e,a=t;if(n<=0)return a;e=n-1|0,t=[n,a]}},t.isSome=function(r){return r?1:0},t.Timer=f},function(r,t,e){"use strict";var n=e(7),a=e(37),i=e(12),o=e(0),c=e(13),u=e(33),f=e(23),s=e(34),_=e(14),l=e(72),m=e(6),v=e(8),d=e(2),g=window,h=[g];function y(r){switch(r){case 0:return l.cubeTiles;case 1:return l.lineTiles;case 2:return l.triangleTiles;case 3:return l.rightTurnTiles;case 4:return l.leftTurnTiles;case 5:return l.leftLTiles;case 6:return l.rightLTiles}}function p(r,t){var e=y(r),n=t-1|0;if(n>2||n<0)return e[0];switch(n){case 0:return e[1];case 1:return e[2];case 2:return e[3]}}var b=i.map(function(r){return c.fromArray(i.map(function(r){return r/255},r))},[[199,214,240],[205,220,246],[130,240,250],[120,130,250],[250,210,80],[250,250,130],[140,250,140],[180,100,230],[240,130,120]]),w=i.map(function(r){var t=c.Hsl[5](r);return c.Hsl[2](t,.07),c.Hsl[3](t,.07),c.Hsl[6](t)},b),x=_.create(0,28);function k(r,t){var e=[10],a=[-10],i=[10],o=[-10];n.iter(function(r){var t=r[1],n=r[0];return e[0]>n&&(e[0]=n),a[0]<(n+1|0)&&(a[0]=n+1|0),i[0]>t&&(i[0]=t),o[0]<(t+1|0)?(o[0]=t+1|0,0):0},p(r,t));var c,u=a[0]-e[0]|0,f=i[0]-o[0]|0,s=u,l=-1*f,m=v.imul(i[0],-1)-l/2,d=e[0]+s/2,g=0;switch(r){case 0:c=[d,m+1];break;case 1:c=1!==t&&3!==t?[d,m]:[d,m+2.5];break;case 2:var h=t-1|0;if(h>2||h<0)c=[d,m];else switch(h){case 0:c=[d-.25,m+1.5];break;case 1:c=[d,m+.5];break;case 2:c=[d+.25,m+1.5]}break;case 3:t>2||t<0?3!==t?c=[d,m]:g=2:1!==t?c=[d,m+.5]:g=2;break;case 4:t>2||t<0?3!==t?c=[d,m]:g=1:1!==t?c=[d,m+.5]:g=1;break;case 5:var y=t-1|0;if(y>2||y<0)c=[d,m];else switch(y){case 0:c=[d,m+1.5];break;case 1:c=[d,m+.5];break;case 2:c=[d+.5,m+1.5]}break;case 6:var b=t-1|0;if(b>2||b<0)c=[d,m];else switch(b){case 0:c=[d-.5,m+1.5];break;case 1:c=[d,m+.5];break;case 2:c=[d+.25,m+1.5]}}switch(g){case 1:c=[d+.5,m+1];break;case 2:c=[d-.5,m+1]}var w=e[0];return _.add(x,[r,t],[c[0],c[1],s,l,u,f,w])}n.iter(function(r){return k(r,0),k(r,1),k(r,2),k(r,3)},[0,[1,[2,[3,[4,[5,[6,0]]]]]]]);function M(){var r=s.$$int(7),t=r>6||r<0?0:r,e=y(t),n=1!==t?0!==t?[3,3]:[4,1]:[5,2];return[t,n[0],n[1],e[4],0]}function S(r){var t=r[0],e=1!==t?0!==t?[3,3]:[4,1]:[5,2];return[r[0],e[0],e[1],r[3],r[4]]}function C(r){return u.clear(r),u.push(M(),r),u.push(M(),r),u.push(M(),r)}function P(){var r=u.create(0);return C(r),r}function T(r){var t=f.tileCols/2|0,e=r[0]>=2?[t,4]:[t+1|0,3];return[r[0],e[0],e[1],r[3],r[4]]}function A(r){return u.push(M(),r),u.pop(r)}var D=[M,S,C,P,T,A];function V(r){var t=A(r[18]),e=r.slice();return e[2]=T(t),e[4]=1,e[5]=1,e[7]=r[8],e}function U(r){return i.iteri(function(t,e){return e[0]>-2?m.caml_array_set(r[13],t,[-2,0]):0},r[13]),n.iter(function(t){var e=r[2][1]+t[0]|0,n=r[2][2]+t[1]|0,a=m.caml_array_get(r[13],e);return-2===a[0]?m.caml_array_set(r[13],e,[n,a[1]]):0},p(r[2][0],r[2][4])),i.iteri(function(t,e){var n=e[0];if(n>-2){for(var a=0,i=n,o=f.tileRows-1|0;i<=o;++i)a||m.caml_array_get(m.caml_array_get(r[9],i),t)>0&&(a=i);return a||(a=f.tileRows),m.caml_array_set(r[13],t,[n,a])}return 0},r[13])}function N(r){for(var t=0,e=f.tileRows-1|0;t<=e;++t)for(var n=0,a=f.tileCols-1|0;n<=a;++n)m.caml_array_set(m.caml_array_get(r[9],t),n,0),m.caml_array_set(r[11],v.imul(f.tileCols,t)+n|0,0);C(r[18]);var i=[3,o.__(0,[15]),T(A(r[18])),0,1,1,r[6],0,0,r[9],r[10],r[11],1,r[13],r[14],r[15],r[16],r[17],r[18],r[19]];return U(i),i}function L(r){return n.exists(function(t){var e=t[1],n=t[0];return(r[2][2]+e|0)>=f.tileRows||(r[2][1]+n|0)<0||(r[2][1]+n|0)>(f.tileCols-1|0)?1:+(m.caml_array_get(m.caml_array_get(r[9],r[2][2]+e|0),r[2][1]+n|0)>0)},p(r[2][0],r[2][4]))}function B(r,t){var e=r.slice(),n=r[2];return e[2]=[n[0],r[2][1]+t[0]|0,r[2][2]+t[1]|0,n[3],n[4]],e[4]=1,0!==L(e)?r:e}function F(r,t){var e=r.slice(),n=r[2];return e[2]=[n[0],r[2][1]+t[0]|0,r[2][2]+t[1]|0,n[3],n[4]],e[4]=1,0!==L(e)?[0,r]:[1,e]}function I(r,t,e){for(var n=e;;){var a=n;if(a){var i=a[0],o=r.slice(),c=r[2];if(o[2]=[c[0],r[2][1]+i[0]|0,r[2][2]-i[1]|0,c[3],t],o[4]=1,L(o)){n=a[1];continue}return[1,o]}return[0,r]}}function z(r){var t=(r[2][4]+1|0)%4,e=r.slice(),n=r[2];if(e[2]=[n[0],n[1],n[2],n[3],t],e[4]=1,L(e)){var a;if(1!==r[2][0])if(t>3||t<0)a=0;else switch(t){case 0:a=[[-1,0],[[-1,-1],[[0,2],[[-1,2],0]]]];break;case 1:a=[[-1,0],[[-1,1],[[0,-2],[[-1,-2],0]]]];break;case 2:a=[[1,0],[[1,-1],[[0,2],[[1,2],0]]]];break;case 3:a=[[1,0],[[1,1],[[0,-2],[[1,-2],0]]]]}else if(t>3||t<0)a=0;else switch(t){case 0:a=[[1,0],[[-2,0],[[1,-2],[[-2,1],0]]]];break;case 1:a=[[-2,0],[[1,0],[[-2,-1],[[1,2],0]]]];break;case 2:a=[[-1,0],[[2,0],[[-1,2],[[2,-1],0]]]];break;case 3:a=[[2,0],[[-1,0],[[2,1],[[-1,-2],0]]]]}return I(r,t,a)}return[1,e]}function E(r){var t=0!=+(0===r[2][4])?3:r[2][4]-1|0,e=r.slice(),n=r[2];if(e[2]=[n[0],n[1],n[2],n[3],t],e[4]=1,L(e)){var a;if(1!==r[2][0])if(t>3||t<0)a=0;else switch(t){case 0:a=[[1,0],[[1,-1],[[0,2],[[1,2],0]]]];break;case 1:a=[[-1,0],[[-1,1],[[0,-2],[[-1,-2],0]]]];break;case 2:a=[[-1,0],[[-1,-1],[[0,2],[[-1,2],0]]]];break;case 3:a=[[1,0],[[1,1],[[0,-2],[[1,-2],0]]]]}else if(t>3||t<0)a=0;else switch(t){case 0:a=[[2,0],[[-1,0],[[2,1],[[-1,-2],0]]]];break;case 1:a=[[1,0],[[-2,0],[[1,-2],[[-2,1],0]]]];break;case 2:a=[[-2,0],[[1,0],[[-2,-1],[[1,2],0]]]];break;case 3:a=[[-1,0],[[2,0],[[-1,2],[[2,-1],0]]]]}return I(r,t,a)}return[1,e]}function q(r){return n.iter(function(t){var e=t[1],n=t[0],a=r[2][2]+e|0,i=r[2][1]+n|0;return m.caml_array_set(m.caml_array_get(r[9],r[2][2]+e|0),r[2][1]+n|0,r[2][3]),m.caml_array_set(r[11],v.imul(a,f.tileCols)+i|0,r[2][3]-1|0)},p(r[2][0],r[2][4]))}function R(r,t){switch(t){case 0:var e=B(r,[-1,0]).slice();return e[1]=o.__(0,[15]),e;case 1:var i=B(r,[1,0]).slice();return i[1]=o.__(0,[15]),i;case 2:var c=B(r,[0,1]).slice();return c[1]=o.__(0,[15]),c;case 3:var u=_.find(x,[r[2][0],r[2][4]]),s=r[2][1]+u[6]|0,l=s-(s>9?9:s>3?3:0)|0,m=n.fold_left(function(r,t){return B(r,[-1,0])},r,a.listRange(l)).slice();return m[1]=o.__(0,[15]),m;case 4:var v=_.find(x,[r[2][0],r[2][4]]),d=r[2][1]+v[6]|0,g=(d<3?3:d<9?9:14)-d|0,h=n.fold_left(function(r,t){return B(r,[1,0])},r,a.listRange(g)).slice();return h[1]=o.__(0,[15]),h;case 5:var y=_.find(x,[r[2][0],r[2][4]]),p=(r[2][1]+y[6]|0)+y[4]|0,b=(p<3?3:p<9?9:12)-p|0,w=n.fold_left(function(r,t){return B(r,[1,0])},r,a.listRange(b)).slice();return w[1]=o.__(0,[15]),w;case 7:for(var k=r.slice(),M=(k[1]=o.__(0,[15]),k[4]=1,k[6]=1,k);;){var C=F(M,[0,1]);if(0===C[0])return C[1];M=C[1]}case 8:var P=z(r)[1].slice();return P[1]=o.__(0,[15]),P;case 9:var A=E(r)[1].slice();return A[1]=o.__(0,[15]),A;case 10:var D,U=S(r[2]),N=r[3];if(N){var L=r.slice();L[2]=T(N[0]),L[3]=[U],L[4]=1,L[5]=1,L[7]=r[8],D=L}else{var I=r.slice();D=V((I[3]=[U],I))}var q=D.slice();return q[1]=o.__(0,[15]),q;case 11:var R=n.fold_left(function(r,t){return B(r,[-1,0])},r,a.listRange(r[2][1])).slice();return R[1]=o.__(0,[15]),R;case 12:var G=n.fold_left(function(r,t){return B(r,[1,0])},r,a.listRange(f.tileCols-r[2][1]|0)).slice();return G[1]=o.__(0,[15]),G;case 13:var H=r.slice();return H[0]=4,H[1]=o.__(3,[2]),H[16]=1,H;case 14:var O=r.slice();return O[0]=2,O[1]=o.__(5,[1]),O;case 6:case 15:return r}}function G(r){var t,e=r[8]+r[19],n=r[17];if(n){var a=n[0];if(a[3]){i.iter(function(t){for(var e=t;e>=1;--e){m.caml_array_set(r[9],e,i.copy(m.caml_array_get(r[9],e-1|0)));for(var n=v.imul(e,f.tileCols),a=(v.imul(e,f.tileCols)+f.tileCols|0)-1|0;n<=a;++n)m.caml_array_set(r[11],n,m.caml_array_get(r[11],n-f.tileCols|0))}return 0},a[2]);var c=r.slice();c[12]=1,c[17]=0,t=c}else{var u=r.slice();u[17]=0,t=u}}else t=r;var s=V(t);if(U(s),L(s)){var _=s.slice();return _[0]=6,_[1]=o.__(2,[2]),_}var l=s.slice();return l[7]=e,l[8]=e,l}function H(r,t){q(r);var e=i.map(function(r){return 1-i.fold_left(function(r,t){return r?1:+(0===t)},0,r)},r[9]),n=i.fold_left(function(r,t){var e=r[1],n=r[0];return 0!==t?[n+1|0,i.append(e,[n])]:[n+1|0,e]},[0,[]],e)[1],a=n.length,o=+(a>0);if(o||t){var c=r.slice();return c[10]=r[10]+a|0,c[12]=1,c[17]=[[0,0,n,o,0,t]],c}var u=r.slice();return G((u[10]=r[10]+a|0,u[12]=1,u))}function O(r,t,e){var n;if(t){var a=r[1],i=0;if(a.tag||6!==a[0]?i=1:n=[r,0],1===i){var o=F(r,[0,1]);n=0!==o[0]?[o[1],0]:[o[1],1]}}else n=[r,0];var c=n[0];if(c[4]&&U(c),0!==n[1])return H(c,0);var u=c.slice();return u[7]=0!==t?e:c[7],u[8]=e,u}function K(r){var t=r[19],e=r[8]+t;if(r[6]){var a=m.caml_array_get(w,r[2][3]);i.iteri(function(t,e){return m.caml_array_set(r[14],t,[e[0],-2])},r[13]);var o=r.slice();return o[15]=a,n.iter(function(r){var t=o[2][1]+r[0]|0,e=o[2][2]+r[1]|0,n=m.caml_array_get(o[14],t);return n[1]<e?m.caml_array_set(o[14],t,[n[0],e]):0},p(o[2][0],o[2][4])),U(o),H(o,1)}var c=+(e>r[7]+f.tickDuration);return O(r,c,e)}function j(r,t){var e=function(r){var e=R(r,t);return 3!==e[0]?Z(e):K(e)},n=r[17];return n?n[0][0]>=3?e(G(r)):r:e(r)}function W(r,t){switch(t){case 0:var e=r.slice();return Z((e[0]=3,e[1]=o.__(0,[15]),e));case 1:var n=r.slice();return Z((n[0]=1,n[1]=o.__(5,[1]),n));case 2:return r}}function $(r,t){if(0!==t)return r;var e=r.slice();return Z((e[0]=3,e[1]=o.__(0,[15]),e))}function X(r,t){switch(t){case 0:var e=r.slice();return Z((e[0]=3,e[1]=o.__(0,[15]),e[16]=0,e));case 1:var n=r.slice();return Z((n[0]=2,n[1]=o.__(5,[1]),n));case 2:return r}}function Q(r,t){if(0!==t)return r;var e=r.slice();return Z((e[0]=3,e[1]=o.__(0,[15]),e))}function Y(r,t){switch(t){case 0:return N(r);case 1:var e=r.slice();return Z((e[0]=2,e[1]=o.__(5,[1]),e));case 2:return r}}function Z(r){var t=r[0],e=r[1],n=0;switch(t){case 0:return 4===e.tag?W(r,e[0]):d.failwith("Invalid gamestate and action");case 1:case 2:n=1;break;case 3:return e.tag?d.failwith("Invalid gamestate and action"):j(r,e[0]);case 4:return 3===e.tag?X(r,e[0]):d.failwith("Invalid gamestate and action");case 5:return 1===e.tag?Q(r,e[0]):d.failwith("Invalid gamestate and action");case 6:return 2===e.tag?Y(r,e[0]):d.failwith("Invalid gamestate and action")}if(1===n)return 5===e.tag?$(r,e[0]):d.failwith("Invalid gamestate and action")}t.Document=h,t.getTetronimo=y,t.elTiles=p,t.colors=w,t.centerRadius=x,t.addCenterRadius=k,t.beamNone=-2,t.TouchDown=[function(){return[0,0,[],0,0,0]}],t.ElQueue=D,t.nextEl=V,t.updateBeams=U,t.setup=function(r){g.addEventListener("keydown",function(r){return g.__lastKeyCode=r.key,0}),s.self_init(0);var t=P();return[0,o.__(4,[2]),T(A(t)),0,1,1,0,0,0,i.make_matrix(f.tileRows,f.tileCols,0),0,r,1,m.caml_make_vect(f.tileCols,[-2,0]),m.caml_make_vect(f.tileCols,[-2,0]),c.white(0),0,0,t,0]},t.newGame=N,t.isCollision=L,t.attemptMove=B,t.attemptMoveTest=F,t.wallTests=I,t.attemptRotateCW=z,t.attemptRotateCCW=E,t.elToTiles=q,t.processGameInput=R,t.afterTouchdown=G,t.elementHasTouchedDown=H,t.regularGameLogic=O,t.gameLogic=K,t.processGameAction=j,t.processStartScreenAction=W,t.processHelpScreenAction=$,t.processPauseAction=X,t.processNextLevelAction=Q,t.processGameOverAction=Y,t.processAction=Z,t.keyPressed=function(r,t){var e=t[6][0];switch(r[0]){case 0:var n;return n=38!==e?"?"===g.__lastKeyCode?1:2:0,o.__(4,[n]);case 1:return o.__(5,[38!==e?1:0]);case 2:return o.__(5,[4!==e?1:0]);case 3:var a;if(console.log(g.__lastKeyCode),r[17])return a=4!==e?"?"===g.__lastKeyCode?14:15:13,o.__(0,[a]);var i,c=0;if(e>=49)c=1;else switch(e){case 4:i=13;break;case 8:i=7;break;case 26:i=3;break;case 27:i=8;break;case 29:i=5;break;case 32:i=0;break;case 34:i=2;break;case 35:i=6;break;case 36:i=1;break;case 42:case 43:i=9;break;case 0:case 1:case 2:case 3:case 5:case 6:case 7:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 30:case 31:case 33:case 37:case 38:case 39:case 40:case 41:case 44:case 45:case 46:c=1;break;case 47:i=4;break;case 28:case 48:i=10}if(1===c)switch(g.__lastKeyCode){case"$":i=12;break;case"?":i=14;break;case"0":case"_":i=11;break;default:i=15}return o.__(0,[i]);case 4:var u;return u=4!==e?"?"===g.__lastKeyCode?1:2:0,o.__(3,[u]);case 5:return o.__(1,[38!==e?1:0]);case 6:var f;return f=38!==e?"?"===g.__lastKeyCode?1:2:0,o.__(2,[f])}}},function(r,t,e){"use strict";t.to_js_boolean=function(r){return!!r}},function(r,t,e){"use strict";var n=e(16),a=n.create("Js_exn.Error");t.$$Error=a,t.internalToOCamlException=function(r){return n.isCamlExceptionOrOpenVariant(r)?r:[a,r]},t.raiseError=function(r){throw new Error(r)},t.raiseEvalError=function(r){throw new EvalError(r)},t.raiseRangeError=function(r){throw new RangeError(r)},t.raiseReferenceError=function(r){throw new ReferenceError(r)},t.raiseSyntaxError=function(r){throw new SyntaxError(r)},t.raiseTypeError=function(r){throw new TypeError(r)},t.raiseUriError=function(r){throw new URIError(r)}},function(r,t,e){"use strict";var n=e(0);t.concat_fmtty=function r(t,e){if("number"==typeof t)return e;switch(0|t.tag){case 0:return n.__(0,[r(t[0],e)]);case 1:return n.__(1,[r(t[0],e)]);case 2:return n.__(2,[r(t[0],e)]);case 3:return n.__(3,[r(t[0],e)]);case 4:return n.__(4,[r(t[0],e)]);case 5:return n.__(5,[r(t[0],e)]);case 6:return n.__(6,[r(t[0],e)]);case 7:return n.__(7,[r(t[0],e)]);case 8:return n.__(8,[t[0],r(t[1],e)]);case 9:return n.__(9,[t[0],t[1],r(t[2],e)]);case 10:return n.__(10,[r(t[0],e)]);case 11:return n.__(11,[r(t[0],e)]);case 12:return n.__(12,[r(t[0],e)]);case 13:return n.__(13,[r(t[0],e)]);case 14:return n.__(14,[r(t[0],e)])}},t.erase_rel=function r(t){if("number"==typeof t)return 0;switch(0|t.tag){case 0:return n.__(0,[r(t[0])]);case 1:return n.__(1,[r(t[0])]);case 2:return n.__(2,[r(t[0])]);case 3:return n.__(3,[r(t[0])]);case 4:return n.__(4,[r(t[0])]);case 5:return n.__(5,[r(t[0])]);case 6:return n.__(6,[r(t[0])]);case 7:return n.__(7,[r(t[0])]);case 8:return n.__(8,[t[0],r(t[1])]);case 9:var e=t[0];return n.__(9,[e,e,r(t[2])]);case 10:return n.__(10,[r(t[0])]);case 11:return n.__(11,[r(t[0])]);case 12:return n.__(12,[r(t[0])]);case 13:return n.__(13,[r(t[0])]);case 14:return n.__(14,[r(t[0])])}},t.concat_fmt=function r(t,e){if("number"==typeof t)return e;switch(0|t.tag){case 0:return n.__(0,[r(t[0],e)]);case 1:return n.__(1,[r(t[0],e)]);case 2:return n.__(2,[t[0],r(t[1],e)]);case 3:return n.__(3,[t[0],r(t[1],e)]);case 4:return n.__(4,[t[0],t[1],t[2],r(t[3],e)]);case 5:return n.__(5,[t[0],t[1],t[2],r(t[3],e)]);case 6:return n.__(6,[t[0],t[1],t[2],r(t[3],e)]);case 7:return n.__(7,[t[0],t[1],t[2],r(t[3],e)]);case 8:return n.__(8,[t[0],t[1],t[2],r(t[3],e)]);case 9:return n.__(9,[r(t[0],e)]);case 10:return n.__(10,[r(t[0],e)]);case 11:return n.__(11,[t[0],r(t[1],e)]);case 12:return n.__(12,[t[0],r(t[1],e)]);case 13:return n.__(13,[t[0],t[1],r(t[2],e)]);case 14:return n.__(14,[t[0],t[1],r(t[2],e)]);case 15:return n.__(15,[r(t[0],e)]);case 16:return n.__(16,[r(t[0],e)]);case 17:return n.__(17,[t[0],r(t[1],e)]);case 18:return n.__(18,[t[0],r(t[1],e)]);case 19:return n.__(19,[r(t[0],e)]);case 20:return n.__(20,[t[0],t[1],r(t[2],e)]);case 21:return n.__(21,[t[0],r(t[1],e)]);case 22:return n.__(22,[r(t[0],e)]);case 23:return n.__(23,[t[0],r(t[1],e)]);case 24:return n.__(24,[t[0],t[1],r(t[2],e)])}}},function(r,t,e){"use strict";var n=String.prototype.repeat&&function(r,t){return t.repeat(r)}||function(r,t){if(0==t.length||0==r)return"";if(t.length*r>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");for(var e="";1==(1&r)&&(e+=t),0!=(r>>>=1);)t+=t;return e};t.repeat=n},function(r,t,e){"use strict";(function(r){var n=e(3);t.caml_sys_getenv=function(t){var e=void 0===r?void 0:r;if(void 0!==e){var a=e.env[t];if(void 0!==a)return a;throw n.not_found}throw n.not_found},t.caml_sys_time=function(){var t=void 0===r?void 0:r;return void 0!==t?t.uptime():-1},t.caml_sys_random_seed=function(){return[(4294967295^(0|Date.now()))*Math.random()|0]},t.caml_sys_system_command=function(){return 127},t.caml_sys_getcwd=function(){var t=void 0===r?void 0:r;return void 0!==t?t.cwd():"/"},t.caml_sys_get_argv=function(){var t=void 0===r?void 0:r;return void 0!==t?null==t.argv?["",[""]]:[t.argv[0],t.argv]:["",[""]]},t.caml_sys_exit=function(t){var e=void 0===r?void 0:r;return void 0!==e?e.exit(t):0},t.caml_sys_is_directory=function(){throw[n.failure,"caml_sys_is_directory not implemented"]},t.caml_sys_file_exists=function(){throw[n.failure,"caml_sys_file_exists not implemented"]}}).call(this,e(44))},function(r,t){var e,n,a=r.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function c(r){if(e===setTimeout)return setTimeout(r,0);if((e===i||!e)&&setTimeout)return e=setTimeout,setTimeout(r,0);try{return e(r,0)}catch(t){try{return e.call(null,r,0)}catch(t){return e.call(this,r,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:i}catch(r){e=i}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(r){n=o}}();var u,f=[],s=!1,_=-1;function l(){s&&u&&(s=!1,u.length?f=u.concat(f):_=-1,f.length&&m())}function m(){if(!s){var r=c(l);s=!0;for(var t=f.length;t;){for(u=f,f=[];++_<t;)u&&u[_].run();_=-1,t=f.length}u=null,s=!1,function(r){if(n===clearTimeout)return clearTimeout(r);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(r);try{n(r)}catch(t){try{return n.call(null,r)}catch(t){return n.call(this,r)}}}(r)}}function v(r,t){this.fun=r,this.array=t}function d(){}a.nextTick=function(r){var t=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)t[e-1]=arguments[e];f.push(new v(r,t)),1!==f.length||s||c(m)},v.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=d,a.addListener=d,a.once=d,a.off=d,a.removeListener=d,a.removeAllListeners=d,a.emit=d,a.prependListener=d,a.prependOnceListener=d,a.listeners=function(r){return[]},a.binding=function(r){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(r){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(r,t,e){"use strict";(function(r){var n=e(1),a=e(3),i=["",function(t,e){var n=e.length-1|0;return void 0!==r&&r.stdout&&r.stdout.write?r.stdout.write(e):"\n"===e[n]?(console.log(e.slice(0,n)),0):(console.log(e),0)}],o=["",function(r,t){var e=t.length-1|0;return"\n"===t[e]?(console.log(t.slice(0,e)),0):(console.log(t),0)}];function c(r){return""!==r[0]?(n._2(r[1],r,r[0]),r[0]="",0):0}function u(t,e,n,a){var o=0===n&&a===e.length?e:e.slice(n,a);if(void 0!==r&&r.stdout&&r.stdout.write&&t===i)return r.stdout.write(o);var u=o.lastIndexOf("\n");return u<0?(t[0]=t[0]+o,0):(t[0]=t[0]+o.slice(0,u+1|0),c(t),t[0]=t[0]+o.slice(u+1|0),0)}t.$caret=function(r,t){return r+t},t.stdin=void 0,t.stdout=i,t.stderr=o,t.caml_ml_open_descriptor_in=function(){throw[a.failure,"caml_ml_open_descriptor_in not implemented"]},t.caml_ml_open_descriptor_out=function(){throw[a.failure,"caml_ml_open_descriptor_out not implemented"]},t.caml_ml_flush=c,t.node_std_output=function(t){return void 0!==r&&r.stdout&&(r.stdout.write(t),!0)},t.caml_ml_output=u,t.caml_ml_output_char=function(r,t){return u(r,String.fromCharCode(t),0,1)},t.caml_ml_input=function(r,t,e,n){throw[a.failure,"caml_ml_input ic not implemented"]},t.caml_ml_input_char=function(){throw[a.failure,"caml_ml_input_char not implemnted"]},t.caml_ml_out_channels_list=function(){return[i,[o,0]]}}).call(this,e(44))},function(r,t,e){"use strict";e.r(t);var n={};e.d(n,"EPSILON",function(){return l}),e.d(n,"ARRAY_TYPE",function(){return m}),e.d(n,"RANDOM",function(){return v}),e.d(n,"setMatrixArrayType",function(){return d}),e.d(n,"toRadian",function(){return h}),e.d(n,"equals",function(){return y});var a={};e.d(a,"create",function(){return p}),e.d(a,"clone",function(){return b}),e.d(a,"copy",function(){return w}),e.d(a,"identity",function(){return x}),e.d(a,"fromValues",function(){return k}),e.d(a,"set",function(){return M}),e.d(a,"transpose",function(){return S}),e.d(a,"invert",function(){return C}),e.d(a,"adjoint",function(){return P}),e.d(a,"determinant",function(){return T}),e.d(a,"multiply",function(){return A}),e.d(a,"rotate",function(){return D}),e.d(a,"scale",function(){return V}),e.d(a,"fromRotation",function(){return U}),e.d(a,"fromScaling",function(){return N}),e.d(a,"str",function(){return L}),e.d(a,"frob",function(){return B}),e.d(a,"LDU",function(){return F}),e.d(a,"add",function(){return I}),e.d(a,"subtract",function(){return z}),e.d(a,"exactEquals",function(){return E}),e.d(a,"equals",function(){return q}),e.d(a,"multiplyScalar",function(){return R}),e.d(a,"multiplyScalarAndAdd",function(){return G}),e.d(a,"mul",function(){return H}),e.d(a,"sub",function(){return O});var i={};e.d(i,"create",function(){return K}),e.d(i,"clone",function(){return j}),e.d(i,"copy",function(){return W}),e.d(i,"identity",function(){return $}),e.d(i,"fromValues",function(){return X}),e.d(i,"set",function(){return Q}),e.d(i,"invert",function(){return Y}),e.d(i,"determinant",function(){return Z}),e.d(i,"multiply",function(){return J}),e.d(i,"rotate",function(){return rr}),e.d(i,"scale",function(){return tr}),e.d(i,"translate",function(){return er}),e.d(i,"fromRotation",function(){return nr}),e.d(i,"fromScaling",function(){return ar}),e.d(i,"fromTranslation",function(){return ir}),e.d(i,"str",function(){return or}),e.d(i,"frob",function(){return cr}),e.d(i,"add",function(){return ur}),e.d(i,"subtract",function(){return fr}),e.d(i,"multiplyScalar",function(){return sr}),e.d(i,"multiplyScalarAndAdd",function(){return _r}),e.d(i,"exactEquals",function(){return lr}),e.d(i,"equals",function(){return mr}),e.d(i,"mul",function(){return vr}),e.d(i,"sub",function(){return dr});var o={};e.d(o,"create",function(){return gr}),e.d(o,"fromMat4",function(){return hr}),e.d(o,"clone",function(){return yr}),e.d(o,"copy",function(){return pr}),e.d(o,"fromValues",function(){return br}),e.d(o,"set",function(){return wr}),e.d(o,"identity",function(){return xr}),e.d(o,"transpose",function(){return kr}),e.d(o,"invert",function(){return Mr}),e.d(o,"adjoint",function(){return Sr}),e.d(o,"determinant",function(){return Cr}),e.d(o,"multiply",function(){return Pr}),e.d(o,"translate",function(){return Tr}),e.d(o,"rotate",function(){return Ar}),e.d(o,"scale",function(){return Dr}),e.d(o,"fromTranslation",function(){return Vr}),e.d(o,"fromRotation",function(){return Ur}),e.d(o,"fromScaling",function(){return Nr}),e.d(o,"fromMat2d",function(){return Lr}),e.d(o,"fromQuat",function(){return Br}),e.d(o,"normalFromMat4",function(){return Fr}),e.d(o,"projection",function(){return Ir}),e.d(o,"str",function(){return zr}),e.d(o,"frob",function(){return Er}),e.d(o,"add",function(){return qr}),e.d(o,"subtract",function(){return Rr}),e.d(o,"multiplyScalar",function(){return Gr}),e.d(o,"multiplyScalarAndAdd",function(){return Hr}),e.d(o,"exactEquals",function(){return Or}),e.d(o,"equals",function(){return Kr}),e.d(o,"mul",function(){return jr}),e.d(o,"sub",function(){return Wr});var c={};e.d(c,"create",function(){return $r}),e.d(c,"clone",function(){return Xr}),e.d(c,"copy",function(){return Qr}),e.d(c,"fromValues",function(){return Yr}),e.d(c,"set",function(){return Zr}),e.d(c,"identity",function(){return Jr}),e.d(c,"transpose",function(){return rt}),e.d(c,"invert",function(){return tt}),e.d(c,"adjoint",function(){return et}),e.d(c,"determinant",function(){return nt}),e.d(c,"multiply",function(){return at}),e.d(c,"translate",function(){return it}),e.d(c,"scale",function(){return ot}),e.d(c,"rotate",function(){return ct}),e.d(c,"rotateX",function(){return ut}),e.d(c,"rotateY",function(){return ft}),e.d(c,"rotateZ",function(){return st}),e.d(c,"fromTranslation",function(){return _t}),e.d(c,"fromScaling",function(){return lt}),e.d(c,"fromRotation",function(){return mt}),e.d(c,"fromXRotation",function(){return vt}),e.d(c,"fromYRotation",function(){return dt}),e.d(c,"fromZRotation",function(){return gt}),e.d(c,"fromRotationTranslation",function(){return ht}),e.d(c,"getTranslation",function(){return yt}),e.d(c,"getScaling",function(){return pt}),e.d(c,"getRotation",function(){return bt}),e.d(c,"fromRotationTranslationScale",function(){return wt}),e.d(c,"fromRotationTranslationScaleOrigin",function(){return xt}),e.d(c,"fromQuat",function(){return kt}),e.d(c,"frustum",function(){return Mt}),e.d(c,"perspective",function(){return St}),e.d(c,"perspectiveFromFieldOfView",function(){return Ct}),e.d(c,"ortho",function(){return Pt}),e.d(c,"lookAt",function(){return Tt}),e.d(c,"targetTo",function(){return At}),e.d(c,"str",function(){return Dt}),e.d(c,"frob",function(){return Vt}),e.d(c,"add",function(){return Ut}),e.d(c,"subtract",function(){return Nt}),e.d(c,"multiplyScalar",function(){return Lt}),e.d(c,"multiplyScalarAndAdd",function(){return Bt}),e.d(c,"exactEquals",function(){return Ft}),e.d(c,"equals",function(){return It}),e.d(c,"mul",function(){return zt}),e.d(c,"sub",function(){return Et});var u={};e.d(u,"create",function(){return qt}),e.d(u,"clone",function(){return Rt}),e.d(u,"length",function(){return Gt}),e.d(u,"fromValues",function(){return Ht}),e.d(u,"copy",function(){return Ot}),e.d(u,"set",function(){return Kt}),e.d(u,"add",function(){return jt}),e.d(u,"subtract",function(){return Wt}),e.d(u,"multiply",function(){return $t}),e.d(u,"divide",function(){return Xt}),e.d(u,"ceil",function(){return Qt}),e.d(u,"floor",function(){return Yt}),e.d(u,"min",function(){return Zt}),e.d(u,"max",function(){return Jt}),e.d(u,"round",function(){return re}),e.d(u,"scale",function(){return te}),e.d(u,"scaleAndAdd",function(){return ee}),e.d(u,"distance",function(){return ne}),e.d(u,"squaredDistance",function(){return ae}),e.d(u,"squaredLength",function(){return ie}),e.d(u,"negate",function(){return oe}),e.d(u,"inverse",function(){return ce}),e.d(u,"normalize",function(){return ue}),e.d(u,"dot",function(){return fe}),e.d(u,"cross",function(){return se}),e.d(u,"lerp",function(){return _e}),e.d(u,"hermite",function(){return le}),e.d(u,"bezier",function(){return me}),e.d(u,"random",function(){return ve}),e.d(u,"transformMat4",function(){return de}),e.d(u,"transformMat3",function(){return ge}),e.d(u,"transformQuat",function(){return he}),e.d(u,"rotateX",function(){return ye}),e.d(u,"rotateY",function(){return pe}),e.d(u,"rotateZ",function(){return be}),e.d(u,"angle",function(){return we}),e.d(u,"str",function(){return xe}),e.d(u,"exactEquals",function(){return ke}),e.d(u,"equals",function(){return Me}),e.d(u,"sub",function(){return Se}),e.d(u,"mul",function(){return Ce}),e.d(u,"div",function(){return Pe}),e.d(u,"dist",function(){return Te}),e.d(u,"sqrDist",function(){return Ae}),e.d(u,"len",function(){return De}),e.d(u,"sqrLen",function(){return Ve}),e.d(u,"forEach",function(){return Ue});var f={};e.d(f,"create",function(){return Ne}),e.d(f,"clone",function(){return Le}),e.d(f,"fromValues",function(){return Be}),e.d(f,"copy",function(){return Fe}),e.d(f,"set",function(){return Ie}),e.d(f,"add",function(){return ze}),e.d(f,"subtract",function(){return Ee}),e.d(f,"multiply",function(){return qe}),e.d(f,"divide",function(){return Re}),e.d(f,"ceil",function(){return Ge}),e.d(f,"floor",function(){return He}),e.d(f,"min",function(){return Oe}),e.d(f,"max",function(){return Ke}),e.d(f,"round",function(){return je}),e.d(f,"scale",function(){return We}),e.d(f,"scaleAndAdd",function(){return $e}),e.d(f,"distance",function(){return Xe}),e.d(f,"squaredDistance",function(){return Qe}),e.d(f,"length",function(){return Ye}),e.d(f,"squaredLength",function(){return Ze}),e.d(f,"negate",function(){return Je}),e.d(f,"inverse",function(){return rn}),e.d(f,"normalize",function(){return tn}),e.d(f,"dot",function(){return en}),e.d(f,"lerp",function(){return nn}),e.d(f,"random",function(){return an}),e.d(f,"transformMat4",function(){return on}),e.d(f,"transformQuat",function(){return cn}),e.d(f,"str",function(){return un}),e.d(f,"exactEquals",function(){return fn}),e.d(f,"equals",function(){return sn}),e.d(f,"sub",function(){return _n}),e.d(f,"mul",function(){return ln}),e.d(f,"div",function(){return mn}),e.d(f,"dist",function(){return vn}),e.d(f,"sqrDist",function(){return dn}),e.d(f,"len",function(){return gn}),e.d(f,"sqrLen",function(){return hn}),e.d(f,"forEach",function(){return yn});var s={};e.d(s,"create",function(){return pn}),e.d(s,"identity",function(){return bn}),e.d(s,"setAxisAngle",function(){return wn}),e.d(s,"getAxisAngle",function(){return xn}),e.d(s,"multiply",function(){return kn}),e.d(s,"rotateX",function(){return Mn}),e.d(s,"rotateY",function(){return Sn}),e.d(s,"rotateZ",function(){return Cn}),e.d(s,"calculateW",function(){return Pn}),e.d(s,"slerp",function(){return Tn}),e.d(s,"invert",function(){return An}),e.d(s,"conjugate",function(){return Dn}),e.d(s,"fromMat3",function(){return Vn}),e.d(s,"fromEuler",function(){return Un}),e.d(s,"str",function(){return Nn}),e.d(s,"clone",function(){return Ln}),e.d(s,"fromValues",function(){return Bn}),e.d(s,"copy",function(){return Fn}),e.d(s,"set",function(){return In}),e.d(s,"add",function(){return zn}),e.d(s,"mul",function(){return En}),e.d(s,"scale",function(){return qn}),e.d(s,"dot",function(){return Rn}),e.d(s,"lerp",function(){return Gn}),e.d(s,"length",function(){return Hn}),e.d(s,"len",function(){return On}),e.d(s,"squaredLength",function(){return Kn}),e.d(s,"sqrLen",function(){return jn}),e.d(s,"normalize",function(){return Wn}),e.d(s,"exactEquals",function(){return $n}),e.d(s,"equals",function(){return Xn}),e.d(s,"rotationTo",function(){return Qn}),e.d(s,"sqlerp",function(){return Yn}),e.d(s,"setAxes",function(){return Zn});var _={};e.d(_,"create",function(){return Jn}),e.d(_,"clone",function(){return ra}),e.d(_,"fromValues",function(){return ta}),e.d(_,"copy",function(){return ea}),e.d(_,"set",function(){return na}),e.d(_,"add",function(){return aa}),e.d(_,"subtract",function(){return ia}),e.d(_,"multiply",function(){return oa}),e.d(_,"divide",function(){return ca}),e.d(_,"ceil",function(){return ua}),e.d(_,"floor",function(){return fa}),e.d(_,"min",function(){return sa}),e.d(_,"max",function(){return _a}),e.d(_,"round",function(){return la}),e.d(_,"scale",function(){return ma}),e.d(_,"scaleAndAdd",function(){return va}),e.d(_,"distance",function(){return da}),e.d(_,"squaredDistance",function(){return ga}),e.d(_,"length",function(){return ha}),e.d(_,"squaredLength",function(){return ya}),e.d(_,"negate",function(){return pa}),e.d(_,"inverse",function(){return ba}),e.d(_,"normalize",function(){return wa}),e.d(_,"dot",function(){return xa}),e.d(_,"cross",function(){return ka}),e.d(_,"lerp",function(){return Ma}),e.d(_,"random",function(){return Sa}),e.d(_,"transformMat2",function(){return Ca}),e.d(_,"transformMat2d",function(){return Pa}),e.d(_,"transformMat3",function(){return Ta}),e.d(_,"transformMat4",function(){return Aa}),e.d(_,"str",function(){return Da}),e.d(_,"exactEquals",function(){return Va}),e.d(_,"equals",function(){return Ua}),e.d(_,"len",function(){return Na}),e.d(_,"sub",function(){return La}),e.d(_,"mul",function(){return Ba}),e.d(_,"div",function(){return Fa}),e.d(_,"dist",function(){return Ia}),e.d(_,"sqrDist",function(){return za}),e.d(_,"sqrLen",function(){return Ea}),e.d(_,"forEach",function(){return qa});const l=1e-6;let m="undefined"!=typeof Float32Array?Float32Array:Array;const v=Math.random;function d(r){m=r}const g=Math.PI/180;function h(r){return r*g}function y(r,t){return Math.abs(r-t)<=l*Math.max(1,Math.abs(r),Math.abs(t))}function p(){let r=new m(4);return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r}function b(r){let t=new m(4);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t}function w(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r}function x(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r}function k(r,t,e,n){let a=new m(4);return a[0]=r,a[1]=t,a[2]=e,a[3]=n,a}function M(r,t,e,n,a){return r[0]=t,r[1]=e,r[2]=n,r[3]=a,r}function S(r,t){if(r===t){let e=t[1];r[1]=t[2],r[2]=e}else r[0]=t[0],r[1]=t[2],r[2]=t[1],r[3]=t[3];return r}function C(r,t){let e=t[0],n=t[1],a=t[2],i=t[3],o=e*i-a*n;return o?(o=1/o,r[0]=i*o,r[1]=-n*o,r[2]=-a*o,r[3]=e*o,r):null}function P(r,t){let e=t[0];return r[0]=t[3],r[1]=-t[1],r[2]=-t[2],r[3]=e,r}function T(r){return r[0]*r[3]-r[2]*r[1]}function A(r,t,e){let n=t[0],a=t[1],i=t[2],o=t[3],c=e[0],u=e[1],f=e[2],s=e[3];return r[0]=n*c+i*u,r[1]=a*c+o*u,r[2]=n*f+i*s,r[3]=a*f+o*s,r}function D(r,t,e){let n=t[0],a=t[1],i=t[2],o=t[3],c=Math.sin(e),u=Math.cos(e);return r[0]=n*u+i*c,r[1]=a*u+o*c,r[2]=n*-c+i*u,r[3]=a*-c+o*u,r}function V(r,t,e){let n=t[0],a=t[1],i=t[2],o=t[3],c=e[0],u=e[1];return r[0]=n*c,r[1]=a*c,r[2]=i*u,r[3]=o*u,r}function U(r,t){let e=Math.sin(t),n=Math.cos(t);return r[0]=n,r[1]=e,r[2]=-e,r[3]=n,r}function N(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=t[1],r}function L(r){return"mat2("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"}function B(r){return Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2)+Math.pow(r[2],2)+Math.pow(r[3],2))}function F(r,t,e,n){return r[2]=n[2]/n[0],e[0]=n[0],e[1]=n[1],e[3]=n[3]-r[2]*e[1],[r,t,e]}function I(r,t,e){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r[2]=t[2]+e[2],r[3]=t[3]+e[3],r}function z(r,t,e){return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],r[3]=t[3]-e[3],r}function E(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]}function q(r,t){let e=r[0],n=r[1],a=r[2],i=r[3],o=t[0],c=t[1],u=t[2],f=t[3];return Math.abs(e-o)<=l*Math.max(1,Math.abs(e),Math.abs(o))&&Math.abs(n-c)<=l*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(a-u)<=l*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(i-f)<=l*Math.max(1,Math.abs(i),Math.abs(f))}function R(r,t,e){return r[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e,r[3]=t[3]*e,r}function G(r,t,e,n){return r[0]=t[0]+e[0]*n,r[1]=t[1]+e[1]*n,r[2]=t[2]+e[2]*n,r[3]=t[3]+e[3]*n,r}const H=A,O=z;function K(){let r=new m(6);return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r[4]=0,r[5]=0,r}function j(r){let t=new m(6);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t}function W(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r}function $(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r[4]=0,r[5]=0,r}function X(r,t,e,n,a,i){let o=new m(6);return o[0]=r,o[1]=t,o[2]=e,o[3]=n,o[4]=a,o[5]=i,o}function Q(r,t,e,n,a,i,o){return r[0]=t,r[1]=e,r[2]=n,r[3]=a,r[4]=i,r[5]=o,r}function Y(r,t){let e=t[0],n=t[1],a=t[2],i=t[3],o=t[4],c=t[5],u=e*i-n*a;return u?(u=1/u,r[0]=i*u,r[1]=-n*u,r[2]=-a*u,r[3]=e*u,r[4]=(a*c-i*o)*u,r[5]=(n*o-e*c)*u,r):null}function Z(r){return r[0]*r[3]-r[1]*r[2]}function J(r,t,e){let n=t[0],a=t[1],i=t[2],o=t[3],c=t[4],u=t[5],f=e[0],s=e[1],_=e[2],l=e[3],m=e[4],v=e[5];return r[0]=n*f+i*s,r[1]=a*f+o*s,r[2]=n*_+i*l,r[3]=a*_+o*l,r[4]=n*m+i*v+c,r[5]=a*m+o*v+u,r}function rr(r,t,e){let n=t[0],a=t[1],i=t[2],o=t[3],c=t[4],u=t[5],f=Math.sin(e),s=Math.cos(e);return r[0]=n*s+i*f,r[1]=a*s+o*f,r[2]=n*-f+i*s,r[3]=a*-f+o*s,r[4]=c,r[5]=u,r}function tr(r,t,e){let n=t[0],a=t[1],i=t[2],o=t[3],c=t[4],u=t[5],f=e[0],s=e[1];return r[0]=n*f,r[1]=a*f,r[2]=i*s,r[3]=o*s,r[4]=c,r[5]=u,r}function er(r,t,e){let n=t[0],a=t[1],i=t[2],o=t[3],c=t[4],u=t[5],f=e[0],s=e[1];return r[0]=n,r[1]=a,r[2]=i,r[3]=o,r[4]=n*f+i*s+c,r[5]=a*f+o*s+u,r}function nr(r,t){let e=Math.sin(t),n=Math.cos(t);return r[0]=n,r[1]=e,r[2]=-e,r[3]=n,r[4]=0,r[5]=0,r}function ar(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=t[1],r[4]=0,r[5]=0,r}function ir(r,t){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r[4]=t[0],r[5]=t[1],r}function or(r){return"mat2d("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+")"}function cr(r){return Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2)+Math.pow(r[2],2)+Math.pow(r[3],2)+Math.pow(r[4],2)+Math.pow(r[5],2)+1)}function ur(r,t,e){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r[2]=t[2]+e[2],r[3]=t[3]+e[3],r[4]=t[4]+e[4],r[5]=t[5]+e[5],r}function fr(r,t,e){return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],r[3]=t[3]-e[3],r[4]=t[4]-e[4],r[5]=t[5]-e[5],r}function sr(r,t,e){return r[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e,r[3]=t[3]*e,r[4]=t[4]*e,r[5]=t[5]*e,r}function _r(r,t,e,n){return r[0]=t[0]+e[0]*n,r[1]=t[1]+e[1]*n,r[2]=t[2]+e[2]*n,r[3]=t[3]+e[3]*n,r[4]=t[4]+e[4]*n,r[5]=t[5]+e[5]*n,r}function lr(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]}function mr(r,t){let e=r[0],n=r[1],a=r[2],i=r[3],o=r[4],c=r[5],u=t[0],f=t[1],s=t[2],_=t[3],m=t[4],v=t[5];return Math.abs(e-u)<=l*Math.max(1,Math.abs(e),Math.abs(u))&&Math.abs(n-f)<=l*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(a-s)<=l*Math.max(1,Math.abs(a),Math.abs(s))&&Math.abs(i-_)<=l*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(o-m)<=l*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(c-v)<=l*Math.max(1,Math.abs(c),Math.abs(v))}const vr=J,dr=fr;function gr(){let r=new m(9);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function hr(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[4],r[4]=t[5],r[5]=t[6],r[6]=t[8],r[7]=t[9],r[8]=t[10],r}function yr(r){let t=new m(9);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t}function pr(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r}function br(r,t,e,n,a,i,o,c,u){let f=new m(9);return f[0]=r,f[1]=t,f[2]=e,f[3]=n,f[4]=a,f[5]=i,f[6]=o,f[7]=c,f[8]=u,f}function wr(r,t,e,n,a,i,o,c,u,f){return r[0]=t,r[1]=e,r[2]=n,r[3]=a,r[4]=i,r[5]=o,r[6]=c,r[7]=u,r[8]=f,r}function xr(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function kr(r,t){if(r===t){let e=t[1],n=t[2],a=t[5];r[1]=t[3],r[2]=t[6],r[3]=e,r[5]=t[7],r[6]=n,r[7]=a}else r[0]=t[0],r[1]=t[3],r[2]=t[6],r[3]=t[1],r[4]=t[4],r[5]=t[7],r[6]=t[2],r[7]=t[5],r[8]=t[8];return r}function Mr(r,t){let e=t[0],n=t[1],a=t[2],i=t[3],o=t[4],c=t[5],u=t[6],f=t[7],s=t[8],_=s*o-c*f,l=-s*i+c*u,m=f*i-o*u,v=e*_+n*l+a*m;return v?(v=1/v,r[0]=_*v,r[1]=(-s*n+a*f)*v,r[2]=(c*n-a*o)*v,r[3]=l*v,r[4]=(s*e-a*u)*v,r[5]=(-c*e+a*i)*v,r[6]=m*v,r[7]=(-f*e+n*u)*v,r[8]=(o*e-n*i)*v,r):null}function Sr(r,t){let e=t[0],n=t[1],a=t[2],i=t[3],o=t[4],c=t[5],u=t[6],f=t[7],s=t[8];return r[0]=o*s-c*f,r[1]=a*f-n*s,r[2]=n*c-a*o,r[3]=c*u-i*s,r[4]=e*s-a*u,r[5]=a*i-e*c,r[6]=i*f-o*u,r[7]=n*u-e*f,r[8]=e*o-n*i,r}function Cr(r){let t=r[0],e=r[1],n=r[2],a=r[3],i=r[4],o=r[5],c=r[6],u=r[7],f=r[8];return t*(f*i-o*u)+e*(-f*a+o*c)+n*(u*a-i*c)}function Pr(r,t,e){let n=t[0],a=t[1],i=t[2],o=t[3],c=t[4],u=t[5],f=t[6],s=t[7],_=t[8],l=e[0],m=e[1],v=e[2],d=e[3],g=e[4],h=e[5],y=e[6],p=e[7],b=e[8];return r[0]=l*n+m*o+v*f,r[1]=l*a+m*c+v*s,r[2]=l*i+m*u+v*_,r[3]=d*n+g*o+h*f,r[4]=d*a+g*c+h*s,r[5]=d*i+g*u+h*_,r[6]=y*n+p*o+b*f,r[7]=y*a+p*c+b*s,r[8]=y*i+p*u+b*_,r}function Tr(r,t,e){let n=t[0],a=t[1],i=t[2],o=t[3],c=t[4],u=t[5],f=t[6],s=t[7],_=t[8],l=e[0],m=e[1];return r[0]=n,r[1]=a,r[2]=i,r[3]=o,r[4]=c,r[5]=u,r[6]=l*n+m*o+f,r[7]=l*a+m*c+s,r[8]=l*i+m*u+_,r}function Ar(r,t,e){let n=t[0],a=t[1],i=t[2],o=t[3],c=t[4],u=t[5],f=t[6],s=t[7],_=t[8],l=Math.sin(e),m=Math.cos(e);return r[0]=m*n+l*o,r[1]=m*a+l*c,r[2]=m*i+l*u,r[3]=m*o-l*n,r[4]=m*c-l*a,r[5]=m*u-l*i,r[6]=f,r[7]=s,r[8]=_,r}function Dr(r,t,e){let n=e[0],a=e[1];return r[0]=n*t[0],r[1]=n*t[1],r[2]=n*t[2],r[3]=a*t[3],r[4]=a*t[4],r[5]=a*t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r}function Vr(r,t){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=t[0],r[7]=t[1],r[8]=1,r}function Ur(r,t){let e=Math.sin(t),n=Math.cos(t);return r[0]=n,r[1]=e,r[2]=0,r[3]=-e,r[4]=n,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function Nr(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=t[1],r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function Lr(r,t){return r[0]=t[0],r[1]=t[1],r[2]=0,r[3]=t[2],r[4]=t[3],r[5]=0,r[6]=t[4],r[7]=t[5],r[8]=1,r}function Br(r,t){let e=t[0],n=t[1],a=t[2],i=t[3],o=e+e,c=n+n,u=a+a,f=e*o,s=n*o,_=n*c,l=a*o,m=a*c,v=a*u,d=i*o,g=i*c,h=i*u;return r[0]=1-_-v,r[3]=s-h,r[6]=l+g,r[1]=s+h,r[4]=1-f-v,r[7]=m-d,r[2]=l-g,r[5]=m+d,r[8]=1-f-_,r}function Fr(r,t){let e=t[0],n=t[1],a=t[2],i=t[3],o=t[4],c=t[5],u=t[6],f=t[7],s=t[8],_=t[9],l=t[10],m=t[11],v=t[12],d=t[13],g=t[14],h=t[15],y=e*c-n*o,p=e*u-a*o,b=e*f-i*o,w=n*u-a*c,x=n*f-i*c,k=a*f-i*u,M=s*d-_*v,S=s*g-l*v,C=s*h-m*v,P=_*g-l*d,T=_*h-m*d,A=l*h-m*g,D=y*A-p*T+b*P+w*C-x*S+k*M;return D?(D=1/D,r[0]=(c*A-u*T+f*P)*D,r[1]=(u*C-o*A-f*S)*D,r[2]=(o*T-c*C+f*M)*D,r[3]=(a*T-n*A-i*P)*D,r[4]=(e*A-a*C+i*S)*D,r[5]=(n*C-e*T-i*M)*D,r[6]=(d*k-g*x+h*w)*D,r[7]=(g*b-v*k-h*p)*D,r[8]=(v*x-d*b+h*y)*D,r):null}function Ir(r,t,e){return r[0]=2/t,r[1]=0,r[2]=0,r[3]=0,r[4]=-2/e,r[5]=0,r[6]=-1,r[7]=1,r[8]=1,r}function zr(r){return"mat3("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+")"}function Er(r){return Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2)+Math.pow(r[2],2)+Math.pow(r[3],2)+Math.pow(r[4],2)+Math.pow(r[5],2)+Math.pow(r[6],2)+Math.pow(r[7],2)+Math.pow(r[8],2))}function qr(r,t,e){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r[2]=t[2]+e[2],r[3]=t[3]+e[3],r[4]=t[4]+e[4],r[5]=t[5]+e[5],r[6]=t[6]+e[6],r[7]=t[7]+e[7],r[8]=t[8]+e[8],r}function Rr(r,t,e){return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],r[3]=t[3]-e[3],r[4]=t[4]-e[4],r[5]=t[5]-e[5],r[6]=t[6]-e[6],r[7]=t[7]-e[7],r[8]=t[8]-e[8],r}function Gr(r,t,e){return r[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e,r[3]=t[3]*e,r[4]=t[4]*e,r[5]=t[5]*e,r[6]=t[6]*e,r[7]=t[7]*e,r[8]=t[8]*e,r}function Hr(r,t,e,n){return r[0]=t[0]+e[0]*n,r[1]=t[1]+e[1]*n,r[2]=t[2]+e[2]*n,r[3]=t[3]+e[3]*n,r[4]=t[4]+e[4]*n,r[5]=t[5]+e[5]*n,r[6]=t[6]+e[6]*n,r[7]=t[7]+e[7]*n,r[8]=t[8]+e[8]*n,r}function Or(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]&&r[8]===t[8]}function Kr(r,t){let e=r[0],n=r[1],a=r[2],i=r[3],o=r[4],c=r[5],u=r[6],f=r[7],s=r[8],_=t[0],m=t[1],v=t[2],d=t[3],g=t[4],h=t[5],y=t[6],p=t[7],b=t[8];return Math.abs(e-_)<=l*Math.max(1,Math.abs(e),Math.abs(_))&&Math.abs(n-m)<=l*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(a-v)<=l*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(i-d)<=l*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-g)<=l*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(c-h)<=l*Math.max(1,Math.abs(c),Math.abs(h))&&Math.abs(u-y)<=l*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(f-p)<=l*Math.max(1,Math.abs(f),Math.abs(p))&&Math.abs(s-b)<=l*Math.max(1,Math.abs(s),Math.abs(b))}const jr=Pr,Wr=Rr;function $r(){let r=new m(16);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Xr(r){let t=new m(16);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t}function Qr(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r}function Yr(r,t,e,n,a,i,o,c,u,f,s,_,l,v,d,g){let h=new m(16);return h[0]=r,h[1]=t,h[2]=e,h[3]=n,h[4]=a,h[5]=i,h[6]=o,h[7]=c,h[8]=u,h[9]=f,h[10]=s,h[11]=_,h[12]=l,h[13]=v,h[14]=d,h[15]=g,h}function Zr(r,t,e,n,a,i,o,c,u,f,s,_,l,m,v,d,g){return r[0]=t,r[1]=e,r[2]=n,r[3]=a,r[4]=i,r[5]=o,r[6]=c,r[7]=u,r[8]=f,r[9]=s,r[10]=_,r[11]=l,r[12]=m,r[13]=v,r[14]=d,r[15]=g,r}function Jr(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function rt(r,t){if(r===t){let e=t[1],n=t[2],a=t[3],i=t[6],o=t[7],c=t[11];r[1]=t[4],r[2]=t[8],r[3]=t[12],r[4]=e,r[6]=t[9],r[7]=t[13],r[8]=n,r[9]=i,r[11]=t[14],r[12]=a,r[13]=o,r[14]=c}else r[0]=t[0],r[1]=t[4],r[2]=t[8],r[3]=t[12],r[4]=t[1],r[5]=t[5],r[6]=t[9],r[7]=t[13],r[8]=t[2],r[9]=t[6],r[10]=t[10],r[11]=t[14],r[12]=t[3],r[13]=t[7],r[14]=t[11],r[15]=t[15];return r}function tt(r,t){let e=t[0],n=t[1],a=t[2],i=t[3],o=t[4],c=t[5],u=t[6],f=t[7],s=t[8],_=t[9],l=t[10],m=t[11],v=t[12],d=t[13],g=t[14],h=t[15],y=e*c-n*o,p=e*u-a*o,b=e*f-i*o,w=n*u-a*c,x=n*f-i*c,k=a*f-i*u,M=s*d-_*v,S=s*g-l*v,C=s*h-m*v,P=_*g-l*d,T=_*h-m*d,A=l*h-m*g,D=y*A-p*T+b*P+w*C-x*S+k*M;return D?(D=1/D,r[0]=(c*A-u*T+f*P)*D,r[1]=(a*T-n*A-i*P)*D,r[2]=(d*k-g*x+h*w)*D,r[3]=(l*x-_*k-m*w)*D,r[4]=(u*C-o*A-f*S)*D,r[5]=(e*A-a*C+i*S)*D,r[6]=(g*b-v*k-h*p)*D,r[7]=(s*k-l*b+m*p)*D,r[8]=(o*T-c*C+f*M)*D,r[9]=(n*C-e*T-i*M)*D,r[10]=(v*x-d*b+h*y)*D,r[11]=(_*b-s*x-m*y)*D,r[12]=(c*S-o*P-u*M)*D,r[13]=(e*P-n*S+a*M)*D,r[14]=(d*p-v*w-g*y)*D,r[15]=(s*w-_*p+l*y)*D,r):null}function et(r,t){let e=t[0],n=t[1],a=t[2],i=t[3],o=t[4],c=t[5],u=t[6],f=t[7],s=t[8],_=t[9],l=t[10],m=t[11],v=t[12],d=t[13],g=t[14],h=t[15];return r[0]=c*(l*h-m*g)-_*(u*h-f*g)+d*(u*m-f*l),r[1]=-(n*(l*h-m*g)-_*(a*h-i*g)+d*(a*m-i*l)),r[2]=n*(u*h-f*g)-c*(a*h-i*g)+d*(a*f-i*u),r[3]=-(n*(u*m-f*l)-c*(a*m-i*l)+_*(a*f-i*u)),r[4]=-(o*(l*h-m*g)-s*(u*h-f*g)+v*(u*m-f*l)),r[5]=e*(l*h-m*g)-s*(a*h-i*g)+v*(a*m-i*l),r[6]=-(e*(u*h-f*g)-o*(a*h-i*g)+v*(a*f-i*u)),r[7]=e*(u*m-f*l)-o*(a*m-i*l)+s*(a*f-i*u),r[8]=o*(_*h-m*d)-s*(c*h-f*d)+v*(c*m-f*_),r[9]=-(e*(_*h-m*d)-s*(n*h-i*d)+v*(n*m-i*_)),r[10]=e*(c*h-f*d)-o*(n*h-i*d)+v*(n*f-i*c),r[11]=-(e*(c*m-f*_)-o*(n*m-i*_)+s*(n*f-i*c)),r[12]=-(o*(_*g-l*d)-s*(c*g-u*d)+v*(c*l-u*_)),r[13]=e*(_*g-l*d)-s*(n*g-a*d)+v*(n*l-a*_),r[14]=-(e*(c*g-u*d)-o*(n*g-a*d)+v*(n*u-a*c)),r[15]=e*(c*l-u*_)-o*(n*l-a*_)+s*(n*u-a*c),r}function nt(r){let t=r[0],e=r[1],n=r[2],a=r[3],i=r[4],o=r[5],c=r[6],u=r[7],f=r[8],s=r[9],_=r[10],l=r[11],m=r[12],v=r[13],d=r[14],g=r[15];return(t*o-e*i)*(_*g-l*d)-(t*c-n*i)*(s*g-l*v)+(t*u-a*i)*(s*d-_*v)+(e*c-n*o)*(f*g-l*m)-(e*u-a*o)*(f*d-_*m)+(n*u-a*c)*(f*v-s*m)}function at(r,t,e){let n=t[0],a=t[1],i=t[2],o=t[3],c=t[4],u=t[5],f=t[6],s=t[7],_=t[8],l=t[9],m=t[10],v=t[11],d=t[12],g=t[13],h=t[14],y=t[15],p=e[0],b=e[1],w=e[2],x=e[3];return r[0]=p*n+b*c+w*_+x*d,r[1]=p*a+b*u+w*l+x*g,r[2]=p*i+b*f+w*m+x*h,r[3]=p*o+b*s+w*v+x*y,p=e[4],b=e[5],w=e[6],x=e[7],r[4]=p*n+b*c+w*_+x*d,r[5]=p*a+b*u+w*l+x*g,r[6]=p*i+b*f+w*m+x*h,r[7]=p*o+b*s+w*v+x*y,p=e[8],b=e[9],w=e[10],x=e[11],r[8]=p*n+b*c+w*_+x*d,r[9]=p*a+b*u+w*l+x*g,r[10]=p*i+b*f+w*m+x*h,r[11]=p*o+b*s+w*v+x*y,p=e[12],b=e[13],w=e[14],x=e[15],r[12]=p*n+b*c+w*_+x*d,r[13]=p*a+b*u+w*l+x*g,r[14]=p*i+b*f+w*m+x*h,r[15]=p*o+b*s+w*v+x*y,r}function it(r,t,e){let n,a,i,o,c,u,f,s,_,l,m,v,d=e[0],g=e[1],h=e[2];return t===r?(r[12]=t[0]*d+t[4]*g+t[8]*h+t[12],r[13]=t[1]*d+t[5]*g+t[9]*h+t[13],r[14]=t[2]*d+t[6]*g+t[10]*h+t[14],r[15]=t[3]*d+t[7]*g+t[11]*h+t[15]):(n=t[0],a=t[1],i=t[2],o=t[3],c=t[4],u=t[5],f=t[6],s=t[7],_=t[8],l=t[9],m=t[10],v=t[11],r[0]=n,r[1]=a,r[2]=i,r[3]=o,r[4]=c,r[5]=u,r[6]=f,r[7]=s,r[8]=_,r[9]=l,r[10]=m,r[11]=v,r[12]=n*d+c*g+_*h+t[12],r[13]=a*d+u*g+l*h+t[13],r[14]=i*d+f*g+m*h+t[14],r[15]=o*d+s*g+v*h+t[15]),r}function ot(r,t,e){let n=e[0],a=e[1],i=e[2];return r[0]=t[0]*n,r[1]=t[1]*n,r[2]=t[2]*n,r[3]=t[3]*n,r[4]=t[4]*a,r[5]=t[5]*a,r[6]=t[6]*a,r[7]=t[7]*a,r[8]=t[8]*i,r[9]=t[9]*i,r[10]=t[10]*i,r[11]=t[11]*i,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r}function ct(r,t,e,n){let a,i,o,c,u,f,s,_,m,v,d,g,h,y,p,b,w,x,k,M,S,C,P,T,A=n[0],D=n[1],V=n[2],U=Math.sqrt(A*A+D*D+V*V);return Math.abs(U)<l?null:(A*=U=1/U,D*=U,V*=U,a=Math.sin(e),o=1-(i=Math.cos(e)),c=t[0],u=t[1],f=t[2],s=t[3],_=t[4],m=t[5],v=t[6],d=t[7],g=t[8],h=t[9],y=t[10],p=t[11],b=A*A*o+i,w=D*A*o+V*a,x=V*A*o-D*a,k=A*D*o-V*a,M=D*D*o+i,S=V*D*o+A*a,C=A*V*o+D*a,P=D*V*o-A*a,T=V*V*o+i,r[0]=c*b+_*w+g*x,r[1]=u*b+m*w+h*x,r[2]=f*b+v*w+y*x,r[3]=s*b+d*w+p*x,r[4]=c*k+_*M+g*S,r[5]=u*k+m*M+h*S,r[6]=f*k+v*M+y*S,r[7]=s*k+d*M+p*S,r[8]=c*C+_*P+g*T,r[9]=u*C+m*P+h*T,r[10]=f*C+v*P+y*T,r[11]=s*C+d*P+p*T,t!==r&&(r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r)}function ut(r,t,e){let n=Math.sin(e),a=Math.cos(e),i=t[4],o=t[5],c=t[6],u=t[7],f=t[8],s=t[9],_=t[10],l=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=i*a+f*n,r[5]=o*a+s*n,r[6]=c*a+_*n,r[7]=u*a+l*n,r[8]=f*a-i*n,r[9]=s*a-o*n,r[10]=_*a-c*n,r[11]=l*a-u*n,r}function ft(r,t,e){let n=Math.sin(e),a=Math.cos(e),i=t[0],o=t[1],c=t[2],u=t[3],f=t[8],s=t[9],_=t[10],l=t[11];return t!==r&&(r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=i*a-f*n,r[1]=o*a-s*n,r[2]=c*a-_*n,r[3]=u*a-l*n,r[8]=i*n+f*a,r[9]=o*n+s*a,r[10]=c*n+_*a,r[11]=u*n+l*a,r}function st(r,t,e){let n=Math.sin(e),a=Math.cos(e),i=t[0],o=t[1],c=t[2],u=t[3],f=t[4],s=t[5],_=t[6],l=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=i*a+f*n,r[1]=o*a+s*n,r[2]=c*a+_*n,r[3]=u*a+l*n,r[4]=f*a-i*n,r[5]=s*a-o*n,r[6]=_*a-c*n,r[7]=l*a-u*n,r}function _t(r,t){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r}function lt(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=t[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function mt(r,t,e){let n,a,i,o=e[0],c=e[1],u=e[2],f=Math.sqrt(o*o+c*c+u*u);return Math.abs(f)<l?null:(o*=f=1/f,c*=f,u*=f,n=Math.sin(t),i=1-(a=Math.cos(t)),r[0]=o*o*i+a,r[1]=c*o*i+u*n,r[2]=u*o*i-c*n,r[3]=0,r[4]=o*c*i-u*n,r[5]=c*c*i+a,r[6]=u*c*i+o*n,r[7]=0,r[8]=o*u*i+c*n,r[9]=c*u*i-o*n,r[10]=u*u*i+a,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}function vt(r,t){let e=Math.sin(t),n=Math.cos(t);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=n,r[6]=e,r[7]=0,r[8]=0,r[9]=-e,r[10]=n,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function dt(r,t){let e=Math.sin(t),n=Math.cos(t);return r[0]=n,r[1]=0,r[2]=-e,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=e,r[9]=0,r[10]=n,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function gt(r,t){let e=Math.sin(t),n=Math.cos(t);return r[0]=n,r[1]=e,r[2]=0,r[3]=0,r[4]=-e,r[5]=n,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function ht(r,t,e){let n=t[0],a=t[1],i=t[2],o=t[3],c=n+n,u=a+a,f=i+i,s=n*c,_=n*u,l=n*f,m=a*u,v=a*f,d=i*f,g=o*c,h=o*u,y=o*f;return r[0]=1-(m+d),r[1]=_+y,r[2]=l-h,r[3]=0,r[4]=_-y,r[5]=1-(s+d),r[6]=v+g,r[7]=0,r[8]=l+h,r[9]=v-g,r[10]=1-(s+m),r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function yt(r,t){return r[0]=t[12],r[1]=t[13],r[2]=t[14],r}function pt(r,t){let e=t[0],n=t[1],a=t[2],i=t[4],o=t[5],c=t[6],u=t[8],f=t[9],s=t[10];return r[0]=Math.sqrt(e*e+n*n+a*a),r[1]=Math.sqrt(i*i+o*o+c*c),r[2]=Math.sqrt(u*u+f*f+s*s),r}function bt(r,t){let e=t[0]+t[5]+t[10],n=0;return e>0?(n=2*Math.sqrt(e+1),r[3]=.25*n,r[0]=(t[6]-t[9])/n,r[1]=(t[8]-t[2])/n,r[2]=(t[1]-t[4])/n):t[0]>t[5]&t[0]>t[10]?(n=2*Math.sqrt(1+t[0]-t[5]-t[10]),r[3]=(t[6]-t[9])/n,r[0]=.25*n,r[1]=(t[1]+t[4])/n,r[2]=(t[8]+t[2])/n):t[5]>t[10]?(n=2*Math.sqrt(1+t[5]-t[0]-t[10]),r[3]=(t[8]-t[2])/n,r[0]=(t[1]+t[4])/n,r[1]=.25*n,r[2]=(t[6]+t[9])/n):(n=2*Math.sqrt(1+t[10]-t[0]-t[5]),r[3]=(t[1]-t[4])/n,r[0]=(t[8]+t[2])/n,r[1]=(t[6]+t[9])/n,r[2]=.25*n),r}function wt(r,t,e,n){let a=t[0],i=t[1],o=t[2],c=t[3],u=a+a,f=i+i,s=o+o,_=a*u,l=a*f,m=a*s,v=i*f,d=i*s,g=o*s,h=c*u,y=c*f,p=c*s,b=n[0],w=n[1],x=n[2];return r[0]=(1-(v+g))*b,r[1]=(l+p)*b,r[2]=(m-y)*b,r[3]=0,r[4]=(l-p)*w,r[5]=(1-(_+g))*w,r[6]=(d+h)*w,r[7]=0,r[8]=(m+y)*x,r[9]=(d-h)*x,r[10]=(1-(_+v))*x,r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function xt(r,t,e,n,a){let i=t[0],o=t[1],c=t[2],u=t[3],f=i+i,s=o+o,_=c+c,l=i*f,m=i*s,v=i*_,d=o*s,g=o*_,h=c*_,y=u*f,p=u*s,b=u*_,w=n[0],x=n[1],k=n[2],M=a[0],S=a[1],C=a[2];return r[0]=(1-(d+h))*w,r[1]=(m+b)*w,r[2]=(v-p)*w,r[3]=0,r[4]=(m-b)*x,r[5]=(1-(l+h))*x,r[6]=(g+y)*x,r[7]=0,r[8]=(v+p)*k,r[9]=(g-y)*k,r[10]=(1-(l+d))*k,r[11]=0,r[12]=e[0]+M-(r[0]*M+r[4]*S+r[8]*C),r[13]=e[1]+S-(r[1]*M+r[5]*S+r[9]*C),r[14]=e[2]+C-(r[2]*M+r[6]*S+r[10]*C),r[15]=1,r}function kt(r,t){let e=t[0],n=t[1],a=t[2],i=t[3],o=e+e,c=n+n,u=a+a,f=e*o,s=n*o,_=n*c,l=a*o,m=a*c,v=a*u,d=i*o,g=i*c,h=i*u;return r[0]=1-_-v,r[1]=s+h,r[2]=l-g,r[3]=0,r[4]=s-h,r[5]=1-f-v,r[6]=m+d,r[7]=0,r[8]=l+g,r[9]=m-d,r[10]=1-f-_,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Mt(r,t,e,n,a,i,o){let c=1/(e-t),u=1/(a-n),f=1/(i-o);return r[0]=2*i*c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=2*i*u,r[6]=0,r[7]=0,r[8]=(e+t)*c,r[9]=(a+n)*u,r[10]=(o+i)*f,r[11]=-1,r[12]=0,r[13]=0,r[14]=o*i*2*f,r[15]=0,r}function St(r,t,e,n,a){let i=1/Math.tan(t/2),o=1/(n-a);return r[0]=i/e,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=i,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=(a+n)*o,r[11]=-1,r[12]=0,r[13]=0,r[14]=2*a*n*o,r[15]=0,r}function Ct(r,t,e,n){let a=Math.tan(t.upDegrees*Math.PI/180),i=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),c=Math.tan(t.rightDegrees*Math.PI/180),u=2/(o+c),f=2/(a+i);return r[0]=u,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=f,r[6]=0,r[7]=0,r[8]=-(o-c)*u*.5,r[9]=(a-i)*f*.5,r[10]=n/(e-n),r[11]=-1,r[12]=0,r[13]=0,r[14]=n*e/(e-n),r[15]=0,r}function Pt(r,t,e,n,a,i,o){let c=1/(t-e),u=1/(n-a),f=1/(i-o);return r[0]=-2*c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*u,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*f,r[11]=0,r[12]=(t+e)*c,r[13]=(a+n)*u,r[14]=(o+i)*f,r[15]=1,r}function Tt(r,t,e,n){let a,i,o,c,u,f,s,_,m,v,d=t[0],g=t[1],h=t[2],y=n[0],p=n[1],b=n[2],w=e[0],x=e[1],k=e[2];return Math.abs(d-w)<l&&Math.abs(g-x)<l&&Math.abs(h-k)<l?mat4.identity(r):(s=d-w,_=g-x,m=h-k,a=p*(m*=v=1/Math.sqrt(s*s+_*_+m*m))-b*(_*=v),i=b*(s*=v)-y*m,o=y*_-p*s,(v=Math.sqrt(a*a+i*i+o*o))?(a*=v=1/v,i*=v,o*=v):(a=0,i=0,o=0),c=_*o-m*i,u=m*a-s*o,f=s*i-_*a,(v=Math.sqrt(c*c+u*u+f*f))?(c*=v=1/v,u*=v,f*=v):(c=0,u=0,f=0),r[0]=a,r[1]=c,r[2]=s,r[3]=0,r[4]=i,r[5]=u,r[6]=_,r[7]=0,r[8]=o,r[9]=f,r[10]=m,r[11]=0,r[12]=-(a*d+i*g+o*h),r[13]=-(c*d+u*g+f*h),r[14]=-(s*d+_*g+m*h),r[15]=1,r)}function At(r,t,e,n){let a=t[0],i=t[1],o=t[2],c=n[0],u=n[1],f=n[2],s=a-e[0],_=i-e[1],l=o-e[2],m=s*s+_*_+l*l;m>0&&(s*=m=1/Math.sqrt(m),_*=m,l*=m);let v=u*l-f*_,d=f*s-c*l,g=c*_-u*s;return r[0]=v,r[1]=d,r[2]=g,r[3]=0,r[4]=_*g-l*d,r[5]=l*v-s*g,r[6]=s*d-_*v,r[7]=0,r[8]=s,r[9]=_,r[10]=l,r[11]=0,r[12]=a,r[13]=i,r[14]=o,r[15]=1,r}function Dt(r){return"mat4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+", "+r[9]+", "+r[10]+", "+r[11]+", "+r[12]+", "+r[13]+", "+r[14]+", "+r[15]+")"}function Vt(r){return Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2)+Math.pow(r[2],2)+Math.pow(r[3],2)+Math.pow(r[4],2)+Math.pow(r[5],2)+Math.pow(r[6],2)+Math.pow(r[7],2)+Math.pow(r[8],2)+Math.pow(r[9],2)+Math.pow(r[10],2)+Math.pow(r[11],2)+Math.pow(r[12],2)+Math.pow(r[13],2)+Math.pow(r[14],2)+Math.pow(r[15],2))}function Ut(r,t,e){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r[2]=t[2]+e[2],r[3]=t[3]+e[3],r[4]=t[4]+e[4],r[5]=t[5]+e[5],r[6]=t[6]+e[6],r[7]=t[7]+e[7],r[8]=t[8]+e[8],r[9]=t[9]+e[9],r[10]=t[10]+e[10],r[11]=t[11]+e[11],r[12]=t[12]+e[12],r[13]=t[13]+e[13],r[14]=t[14]+e[14],r[15]=t[15]+e[15],r}function Nt(r,t,e){return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],r[3]=t[3]-e[3],r[4]=t[4]-e[4],r[5]=t[5]-e[5],r[6]=t[6]-e[6],r[7]=t[7]-e[7],r[8]=t[8]-e[8],r[9]=t[9]-e[9],r[10]=t[10]-e[10],r[11]=t[11]-e[11],r[12]=t[12]-e[12],r[13]=t[13]-e[13],r[14]=t[14]-e[14],r[15]=t[15]-e[15],r}function Lt(r,t,e){return r[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e,r[3]=t[3]*e,r[4]=t[4]*e,r[5]=t[5]*e,r[6]=t[6]*e,r[7]=t[7]*e,r[8]=t[8]*e,r[9]=t[9]*e,r[10]=t[10]*e,r[11]=t[11]*e,r[12]=t[12]*e,r[13]=t[13]*e,r[14]=t[14]*e,r[15]=t[15]*e,r}function Bt(r,t,e,n){return r[0]=t[0]+e[0]*n,r[1]=t[1]+e[1]*n,r[2]=t[2]+e[2]*n,r[3]=t[3]+e[3]*n,r[4]=t[4]+e[4]*n,r[5]=t[5]+e[5]*n,r[6]=t[6]+e[6]*n,r[7]=t[7]+e[7]*n,r[8]=t[8]+e[8]*n,r[9]=t[9]+e[9]*n,r[10]=t[10]+e[10]*n,r[11]=t[11]+e[11]*n,r[12]=t[12]+e[12]*n,r[13]=t[13]+e[13]*n,r[14]=t[14]+e[14]*n,r[15]=t[15]+e[15]*n,r}function Ft(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]&&r[8]===t[8]&&r[9]===t[9]&&r[10]===t[10]&&r[11]===t[11]&&r[12]===t[12]&&r[13]===t[13]&&r[14]===t[14]&&r[15]===t[15]}function It(r,t){let e=r[0],n=r[1],a=r[2],i=r[3],o=r[4],c=r[5],u=r[6],f=r[7],s=r[8],_=r[9],m=r[10],v=r[11],d=r[12],g=r[13],h=r[14],y=r[15],p=t[0],b=t[1],w=t[2],x=t[3],k=t[4],M=t[5],S=t[6],C=t[7],P=t[8],T=t[9],A=t[10],D=t[11],V=t[12],U=t[13],N=t[14],L=t[15];return Math.abs(e-p)<=l*Math.max(1,Math.abs(e),Math.abs(p))&&Math.abs(n-b)<=l*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(a-w)<=l*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(i-x)<=l*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(o-k)<=l*Math.max(1,Math.abs(o),Math.abs(k))&&Math.abs(c-M)<=l*Math.max(1,Math.abs(c),Math.abs(M))&&Math.abs(u-S)<=l*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(f-C)<=l*Math.max(1,Math.abs(f),Math.abs(C))&&Math.abs(s-P)<=l*Math.max(1,Math.abs(s),Math.abs(P))&&Math.abs(_-T)<=l*Math.max(1,Math.abs(_),Math.abs(T))&&Math.abs(m-A)<=l*Math.max(1,Math.abs(m),Math.abs(A))&&Math.abs(v-D)<=l*Math.max(1,Math.abs(v),Math.abs(D))&&Math.abs(d-V)<=l*Math.max(1,Math.abs(d),Math.abs(V))&&Math.abs(g-U)<=l*Math.max(1,Math.abs(g),Math.abs(U))&&Math.abs(h-N)<=l*Math.max(1,Math.abs(h),Math.abs(N))&&Math.abs(y-L)<=l*Math.max(1,Math.abs(y),Math.abs(L))}const zt=at,Et=Nt;function qt(){let r=new m(3);return r[0]=0,r[1]=0,r[2]=0,r}function Rt(r){var t=new m(3);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t}function Gt(r){let t=r[0],e=r[1],n=r[2];return Math.sqrt(t*t+e*e+n*n)}function Ht(r,t,e){let n=new m(3);return n[0]=r,n[1]=t,n[2]=e,n}function Ot(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r}function Kt(r,t,e,n){return r[0]=t,r[1]=e,r[2]=n,r}function jt(r,t,e){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r[2]=t[2]+e[2],r}function Wt(r,t,e){return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],r}function $t(r,t,e){return r[0]=t[0]*e[0],r[1]=t[1]*e[1],r[2]=t[2]*e[2],r}function Xt(r,t,e){return r[0]=t[0]/e[0],r[1]=t[1]/e[1],r[2]=t[2]/e[2],r}function Qt(r,t){return r[0]=Math.ceil(t[0]),r[1]=Math.ceil(t[1]),r[2]=Math.ceil(t[2]),r}function Yt(r,t){return r[0]=Math.floor(t[0]),r[1]=Math.floor(t[1]),r[2]=Math.floor(t[2]),r}function Zt(r,t,e){return r[0]=Math.min(t[0],e[0]),r[1]=Math.min(t[1],e[1]),r[2]=Math.min(t[2],e[2]),r}function Jt(r,t,e){return r[0]=Math.max(t[0],e[0]),r[1]=Math.max(t[1],e[1]),r[2]=Math.max(t[2],e[2]),r}function re(r,t){return r[0]=Math.round(t[0]),r[1]=Math.round(t[1]),r[2]=Math.round(t[2]),r}function te(r,t,e){return r[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e,r}function ee(r,t,e,n){return r[0]=t[0]+e[0]*n,r[1]=t[1]+e[1]*n,r[2]=t[2]+e[2]*n,r}function ne(r,t){let e=t[0]-r[0],n=t[1]-r[1],a=t[2]-r[2];return Math.sqrt(e*e+n*n+a*a)}function ae(r,t){let e=t[0]-r[0],n=t[1]-r[1],a=t[2]-r[2];return e*e+n*n+a*a}function ie(r){let t=r[0],e=r[1],n=r[2];return t*t+e*e+n*n}function oe(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r}function ce(r,t){return r[0]=1/t[0],r[1]=1/t[1],r[2]=1/t[2],r}function ue(r,t){let e=t[0],n=t[1],a=t[2],i=e*e+n*n+a*a;return i>0&&(i=1/Math.sqrt(i),r[0]=t[0]*i,r[1]=t[1]*i,r[2]=t[2]*i),r}function fe(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]}function se(r,t,e){let n=t[0],a=t[1],i=t[2],o=e[0],c=e[1],u=e[2];return r[0]=a*u-i*c,r[1]=i*o-n*u,r[2]=n*c-a*o,r}function _e(r,t,e,n){let a=t[0],i=t[1],o=t[2];return r[0]=a+n*(e[0]-a),r[1]=i+n*(e[1]-i),r[2]=o+n*(e[2]-o),r}function le(r,t,e,n,a,i){let o=i*i,c=o*(2*i-3)+1,u=o*(i-2)+i,f=o*(i-1),s=o*(3-2*i);return r[0]=t[0]*c+e[0]*u+n[0]*f+a[0]*s,r[1]=t[1]*c+e[1]*u+n[1]*f+a[1]*s,r[2]=t[2]*c+e[2]*u+n[2]*f+a[2]*s,r}function me(r,t,e,n,a,i){let o=1-i,c=o*o,u=i*i,f=c*o,s=3*i*c,_=3*u*o,l=u*i;return r[0]=t[0]*f+e[0]*s+n[0]*_+a[0]*l,r[1]=t[1]*f+e[1]*s+n[1]*_+a[1]*l,r[2]=t[2]*f+e[2]*s+n[2]*_+a[2]*l,r}function ve(r,t){t=t||1;let e=2*v()*Math.PI,n=2*v()-1,a=Math.sqrt(1-n*n)*t;return r[0]=Math.cos(e)*a,r[1]=Math.sin(e)*a,r[2]=n*t,r}function de(r,t,e){let n=t[0],a=t[1],i=t[2],o=e[3]*n+e[7]*a+e[11]*i+e[15];return o=o||1,r[0]=(e[0]*n+e[4]*a+e[8]*i+e[12])/o,r[1]=(e[1]*n+e[5]*a+e[9]*i+e[13])/o,r[2]=(e[2]*n+e[6]*a+e[10]*i+e[14])/o,r}function ge(r,t,e){let n=t[0],a=t[1],i=t[2];return r[0]=n*e[0]+a*e[3]+i*e[6],r[1]=n*e[1]+a*e[4]+i*e[7],r[2]=n*e[2]+a*e[5]+i*e[8],r}function he(r,t,e){let n=t[0],a=t[1],i=t[2],o=e[0],c=e[1],u=e[2],f=e[3],s=f*n+c*i-u*a,_=f*a+u*n-o*i,l=f*i+o*a-c*n,m=-o*n-c*a-u*i;return r[0]=s*f+m*-o+_*-u-l*-c,r[1]=_*f+m*-c+l*-o-s*-u,r[2]=l*f+m*-u+s*-c-_*-o,r}function ye(r,t,e,n){let a=[],i=[];return a[0]=t[0]-e[0],a[1]=t[1]-e[1],a[2]=t[2]-e[2],i[0]=a[0],i[1]=a[1]*Math.cos(n)-a[2]*Math.sin(n),i[2]=a[1]*Math.sin(n)+a[2]*Math.cos(n),r[0]=i[0]+e[0],r[1]=i[1]+e[1],r[2]=i[2]+e[2],r}function pe(r,t,e,n){let a=[],i=[];return a[0]=t[0]-e[0],a[1]=t[1]-e[1],a[2]=t[2]-e[2],i[0]=a[2]*Math.sin(n)+a[0]*Math.cos(n),i[1]=a[1],i[2]=a[2]*Math.cos(n)-a[0]*Math.sin(n),r[0]=i[0]+e[0],r[1]=i[1]+e[1],r[2]=i[2]+e[2],r}function be(r,t,e,n){let a=[],i=[];return a[0]=t[0]-e[0],a[1]=t[1]-e[1],a[2]=t[2]-e[2],i[0]=a[0]*Math.cos(n)-a[1]*Math.sin(n),i[1]=a[0]*Math.sin(n)+a[1]*Math.cos(n),i[2]=a[2],r[0]=i[0]+e[0],r[1]=i[1]+e[1],r[2]=i[2]+e[2],r}function we(r,t){let e=Ht(r[0],r[1],r[2]),n=Ht(t[0],t[1],t[2]);ue(e,e),ue(n,n);let a=fe(e,n);return a>1?0:a<-1?Math.PI:Math.acos(a)}function xe(r){return"vec3("+r[0]+", "+r[1]+", "+r[2]+")"}function ke(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]}function Me(r,t){let e=r[0],n=r[1],a=r[2],i=t[0],o=t[1],c=t[2];return Math.abs(e-i)<=l*Math.max(1,Math.abs(e),Math.abs(i))&&Math.abs(n-o)<=l*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(a-c)<=l*Math.max(1,Math.abs(a),Math.abs(c))}const Se=Wt,Ce=$t,Pe=Xt,Te=ne,Ae=ae,De=Gt,Ve=ie,Ue=function(){let r=qt();return function(t,e,n,a,i,o){let c,u;for(e||(e=3),n||(n=0),u=a?Math.min(a*e+n,t.length):t.length,c=n;c<u;c+=e)r[0]=t[c],r[1]=t[c+1],r[2]=t[c+2],i(r,r,o),t[c]=r[0],t[c+1]=r[1],t[c+2]=r[2];return t}}();function Ne(){let r=new m(4);return r[0]=0,r[1]=0,r[2]=0,r[3]=0,r}function Le(r){let t=new m(4);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t}function Be(r,t,e,n){let a=new m(4);return a[0]=r,a[1]=t,a[2]=e,a[3]=n,a}function Fe(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r}function Ie(r,t,e,n,a){return r[0]=t,r[1]=e,r[2]=n,r[3]=a,r}function ze(r,t,e){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r[2]=t[2]+e[2],r[3]=t[3]+e[3],r}function Ee(r,t,e){return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],r[3]=t[3]-e[3],r}function qe(r,t,e){return r[0]=t[0]*e[0],r[1]=t[1]*e[1],r[2]=t[2]*e[2],r[3]=t[3]*e[3],r}function Re(r,t,e){return r[0]=t[0]/e[0],r[1]=t[1]/e[1],r[2]=t[2]/e[2],r[3]=t[3]/e[3],r}function Ge(r,t){return r[0]=Math.ceil(t[0]),r[1]=Math.ceil(t[1]),r[2]=Math.ceil(t[2]),r[3]=Math.ceil(t[3]),r}function He(r,t){return r[0]=Math.floor(t[0]),r[1]=Math.floor(t[1]),r[2]=Math.floor(t[2]),r[3]=Math.floor(t[3]),r}function Oe(r,t,e){return r[0]=Math.min(t[0],e[0]),r[1]=Math.min(t[1],e[1]),r[2]=Math.min(t[2],e[2]),r[3]=Math.min(t[3],e[3]),r}function Ke(r,t,e){return r[0]=Math.max(t[0],e[0]),r[1]=Math.max(t[1],e[1]),r[2]=Math.max(t[2],e[2]),r[3]=Math.max(t[3],e[3]),r}function je(r,t){return r[0]=Math.round(t[0]),r[1]=Math.round(t[1]),r[2]=Math.round(t[2]),r[3]=Math.round(t[3]),r}function We(r,t,e){return r[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e,r[3]=t[3]*e,r}function $e(r,t,e,n){return r[0]=t[0]+e[0]*n,r[1]=t[1]+e[1]*n,r[2]=t[2]+e[2]*n,r[3]=t[3]+e[3]*n,r}function Xe(r,t){let e=t[0]-r[0],n=t[1]-r[1],a=t[2]-r[2],i=t[3]-r[3];return Math.sqrt(e*e+n*n+a*a+i*i)}function Qe(r,t){let e=t[0]-r[0],n=t[1]-r[1],a=t[2]-r[2],i=t[3]-r[3];return e*e+n*n+a*a+i*i}function Ye(r){let t=r[0],e=r[1],n=r[2],a=r[3];return Math.sqrt(t*t+e*e+n*n+a*a)}function Ze(r){let t=r[0],e=r[1],n=r[2],a=r[3];return t*t+e*e+n*n+a*a}function Je(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r[3]=-t[3],r}function rn(r,t){return r[0]=1/t[0],r[1]=1/t[1],r[2]=1/t[2],r[3]=1/t[3],r}function tn(r,t){let e=t[0],n=t[1],a=t[2],i=t[3],o=e*e+n*n+a*a+i*i;return o>0&&(o=1/Math.sqrt(o),r[0]=e*o,r[1]=n*o,r[2]=a*o,r[3]=i*o),r}function en(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]*t[3]}function nn(r,t,e,n){let a=t[0],i=t[1],o=t[2],c=t[3];return r[0]=a+n*(e[0]-a),r[1]=i+n*(e[1]-i),r[2]=o+n*(e[2]-o),r[3]=c+n*(e[3]-c),r}function an(r,t){return t=t||1,r[0]=v(),r[1]=v(),r[2]=v(),r[3]=v(),tn(r,r),We(r,r,t),r}function on(r,t,e){let n=t[0],a=t[1],i=t[2],o=t[3];return r[0]=e[0]*n+e[4]*a+e[8]*i+e[12]*o,r[1]=e[1]*n+e[5]*a+e[9]*i+e[13]*o,r[2]=e[2]*n+e[6]*a+e[10]*i+e[14]*o,r[3]=e[3]*n+e[7]*a+e[11]*i+e[15]*o,r}function cn(r,t,e){let n=t[0],a=t[1],i=t[2],o=e[0],c=e[1],u=e[2],f=e[3],s=f*n+c*i-u*a,_=f*a+u*n-o*i,l=f*i+o*a-c*n,m=-o*n-c*a-u*i;return r[0]=s*f+m*-o+_*-u-l*-c,r[1]=_*f+m*-c+l*-o-s*-u,r[2]=l*f+m*-u+s*-c-_*-o,r[3]=t[3],r}function un(r){return"vec4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"}function fn(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]}function sn(r,t){let e=r[0],n=r[1],a=r[2],i=r[3],o=t[0],c=t[1],u=t[2],f=t[3];return Math.abs(e-o)<=l*Math.max(1,Math.abs(e),Math.abs(o))&&Math.abs(n-c)<=l*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(a-u)<=l*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(i-f)<=l*Math.max(1,Math.abs(i),Math.abs(f))}const _n=Ee,ln=qe,mn=Re,vn=Xe,dn=Qe,gn=Ye,hn=Ze,yn=function(){let r=Ne();return function(t,e,n,a,i,o){let c,u;for(e||(e=4),n||(n=0),u=a?Math.min(a*e+n,t.length):t.length,c=n;c<u;c+=e)r[0]=t[c],r[1]=t[c+1],r[2]=t[c+2],r[3]=t[c+3],i(r,r,o),t[c]=r[0],t[c+1]=r[1],t[c+2]=r[2],t[c+3]=r[3];return t}}();function pn(){let r=new m(4);return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r}function bn(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r}function wn(r,t,e){e*=.5;let n=Math.sin(e);return r[0]=n*t[0],r[1]=n*t[1],r[2]=n*t[2],r[3]=Math.cos(e),r}function xn(r,t){let e=2*Math.acos(t[3]),n=Math.sin(e/2);return 0!=n?(r[0]=t[0]/n,r[1]=t[1]/n,r[2]=t[2]/n):(r[0]=1,r[1]=0,r[2]=0),e}function kn(r,t,e){let n=t[0],a=t[1],i=t[2],o=t[3],c=e[0],u=e[1],f=e[2],s=e[3];return r[0]=n*s+o*c+a*f-i*u,r[1]=a*s+o*u+i*c-n*f,r[2]=i*s+o*f+n*u-a*c,r[3]=o*s-n*c-a*u-i*f,r}function Mn(r,t,e){e*=.5;let n=t[0],a=t[1],i=t[2],o=t[3],c=Math.sin(e),u=Math.cos(e);return r[0]=n*u+o*c,r[1]=a*u+i*c,r[2]=i*u-a*c,r[3]=o*u-n*c,r}function Sn(r,t,e){e*=.5;let n=t[0],a=t[1],i=t[2],o=t[3],c=Math.sin(e),u=Math.cos(e);return r[0]=n*u-i*c,r[1]=a*u+o*c,r[2]=i*u+n*c,r[3]=o*u-a*c,r}function Cn(r,t,e){e*=.5;let n=t[0],a=t[1],i=t[2],o=t[3],c=Math.sin(e),u=Math.cos(e);return r[0]=n*u+a*c,r[1]=a*u-n*c,r[2]=i*u+o*c,r[3]=o*u-i*c,r}function Pn(r,t){let e=t[0],n=t[1],a=t[2];return r[0]=e,r[1]=n,r[2]=a,r[3]=Math.sqrt(Math.abs(1-e*e-n*n-a*a)),r}function Tn(r,t,e,n){let a,i,o,c,u,f=t[0],s=t[1],_=t[2],l=t[3],m=e[0],v=e[1],d=e[2],g=e[3];return(i=f*m+s*v+_*d+l*g)<0&&(i=-i,m=-m,v=-v,d=-d,g=-g),1-i>1e-6?(a=Math.acos(i),o=Math.sin(a),c=Math.sin((1-n)*a)/o,u=Math.sin(n*a)/o):(c=1-n,u=n),r[0]=c*f+u*m,r[1]=c*s+u*v,r[2]=c*_+u*d,r[3]=c*l+u*g,r}function An(r,t){let e=t[0],n=t[1],a=t[2],i=t[3],o=e*e+n*n+a*a+i*i,c=o?1/o:0;return r[0]=-e*c,r[1]=-n*c,r[2]=-a*c,r[3]=i*c,r}function Dn(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r[3]=t[3],r}function Vn(r,t){let e,n=t[0]+t[4]+t[8];if(n>0)e=Math.sqrt(n+1),r[3]=.5*e,e=.5/e,r[0]=(t[5]-t[7])*e,r[1]=(t[6]-t[2])*e,r[2]=(t[1]-t[3])*e;else{let n=0;t[4]>t[0]&&(n=1),t[8]>t[3*n+n]&&(n=2);let a=(n+1)%3,i=(n+2)%3;e=Math.sqrt(t[3*n+n]-t[3*a+a]-t[3*i+i]+1),r[n]=.5*e,e=.5/e,r[3]=(t[3*a+i]-t[3*i+a])*e,r[a]=(t[3*a+n]+t[3*n+a])*e,r[i]=(t[3*i+n]+t[3*n+i])*e}return r}function Un(r,t,e,n){let a=.5*Math.PI/180;t*=a,e*=a,n*=a;let i=Math.sin(t),o=Math.cos(t),c=Math.sin(e),u=Math.cos(e),f=Math.sin(n),s=Math.cos(n);return r[0]=i*u*s-o*c*f,r[1]=o*c*s+i*u*f,r[2]=o*u*f-i*c*s,r[3]=o*u*s+i*c*f,r}function Nn(r){return"quat("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"}const Ln=Le,Bn=Be,Fn=Fe,In=Ie,zn=ze,En=kn,qn=We,Rn=en,Gn=nn,Hn=Ye,On=Hn,Kn=Ze,jn=Kn,Wn=tn,$n=fn,Xn=sn,Qn=function(){let r=qt(),t=Ht(1,0,0),e=Ht(0,1,0);return function(n,a,i){let o=fe(a,i);return o<-.999999?(se(r,t,a),De(r)<1e-6&&se(r,e,a),ue(r,r),wn(n,r,Math.PI),n):o>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(se(r,a,i),n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=1+o,Wn(n,n))}}(),Yn=function(){let r=pn(),t=pn();return function(e,n,a,i,o,c){return Tn(r,n,o,c),Tn(t,a,i,c),Tn(e,r,t,2*c*(1-c)),e}}(),Zn=function(){let r=gr();return function(t,e,n,a){return r[0]=n[0],r[3]=n[1],r[6]=n[2],r[1]=a[0],r[4]=a[1],r[7]=a[2],r[2]=-e[0],r[5]=-e[1],r[8]=-e[2],Wn(t,Vn(t,r))}}();function Jn(){let r=new m(2);return r[0]=0,r[1]=0,r}function ra(r){let t=new m(2);return t[0]=r[0],t[1]=r[1],t}function ta(r,t){let e=new m(2);return e[0]=r,e[1]=t,e}function ea(r,t){return r[0]=t[0],r[1]=t[1],r}function na(r,t,e){return r[0]=t,r[1]=e,r}function aa(r,t,e){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r}function ia(r,t,e){return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r}function oa(r,t,e){return r[0]=t[0]*e[0],r[1]=t[1]*e[1],r}function ca(r,t,e){return r[0]=t[0]/e[0],r[1]=t[1]/e[1],r}function ua(r,t){return r[0]=Math.ceil(t[0]),r[1]=Math.ceil(t[1]),r}function fa(r,t){return r[0]=Math.floor(t[0]),r[1]=Math.floor(t[1]),r}function sa(r,t,e){return r[0]=Math.min(t[0],e[0]),r[1]=Math.min(t[1],e[1]),r}function _a(r,t,e){return r[0]=Math.max(t[0],e[0]),r[1]=Math.max(t[1],e[1]),r}function la(r,t){return r[0]=Math.round(t[0]),r[1]=Math.round(t[1]),r}function ma(r,t,e){return r[0]=t[0]*e,r[1]=t[1]*e,r}function va(r,t,e,n){return r[0]=t[0]+e[0]*n,r[1]=t[1]+e[1]*n,r}function da(r,t){var e=t[0]-r[0],n=t[1]-r[1];return Math.sqrt(e*e+n*n)}function ga(r,t){var e=t[0]-r[0],n=t[1]-r[1];return e*e+n*n}function ha(r){var t=r[0],e=r[1];return Math.sqrt(t*t+e*e)}function ya(r){var t=r[0],e=r[1];return t*t+e*e}function pa(r,t){return r[0]=-t[0],r[1]=-t[1],r}function ba(r,t){return r[0]=1/t[0],r[1]=1/t[1],r}function wa(r,t){var e=t[0],n=t[1],a=e*e+n*n;return a>0&&(a=1/Math.sqrt(a),r[0]=t[0]*a,r[1]=t[1]*a),r}function xa(r,t){return r[0]*t[0]+r[1]*t[1]}function ka(r,t,e){var n=t[0]*e[1]-t[1]*e[0];return r[0]=r[1]=0,r[2]=n,r}function Ma(r,t,e,n){var a=t[0],i=t[1];return r[0]=a+n*(e[0]-a),r[1]=i+n*(e[1]-i),r}function Sa(r,t){t=t||1;var e=2*v()*Math.PI;return r[0]=Math.cos(e)*t,r[1]=Math.sin(e)*t,r}function Ca(r,t,e){var n=t[0],a=t[1];return r[0]=e[0]*n+e[2]*a,r[1]=e[1]*n+e[3]*a,r}function Pa(r,t,e){var n=t[0],a=t[1];return r[0]=e[0]*n+e[2]*a+e[4],r[1]=e[1]*n+e[3]*a+e[5],r}function Ta(r,t,e){var n=t[0],a=t[1];return r[0]=e[0]*n+e[3]*a+e[6],r[1]=e[1]*n+e[4]*a+e[7],r}function Aa(r,t,e){let n=t[0],a=t[1];return r[0]=e[0]*n+e[4]*a+e[12],r[1]=e[1]*n+e[5]*a+e[13],r}function Da(r){return"vec2("+r[0]+", "+r[1]+")"}function Va(r,t){return r[0]===t[0]&&r[1]===t[1]}function Ua(r,t){let e=r[0],n=r[1],a=t[0],i=t[1];return Math.abs(e-a)<=l*Math.max(1,Math.abs(e),Math.abs(a))&&Math.abs(n-i)<=l*Math.max(1,Math.abs(n),Math.abs(i))}const Na=ha,La=ia,Ba=oa,Fa=ca,Ia=da,za=ga,Ea=ya,qa=function(){let r=Jn();return function(t,e,n,a,i,o){let c,u;for(e||(e=2),n||(n=0),u=a?Math.min(a*e+n,t.length):t.length,c=n;c<u;c+=e)r[0]=t[c],r[1]=t[c+1],i(r,r,o),t[c]=r[0],t[c+1]=r[1];return t}}();e.d(t,"glMatrix",function(){return n}),e.d(t,"mat2",function(){return a}),e.d(t,"mat2d",function(){return i}),e.d(t,"mat3",function(){return o}),e.d(t,"mat4",function(){return c}),e.d(t,"quat",function(){return s}),e.d(t,"vec2",function(){return _}),e.d(t,"vec3",function(){return u}),e.d(t,"vec4",function(){return f})},function(r,t,e){"use strict";var n=e(4),a=e(0),i=e(28),o=e(5),c="\n    precision mediump float;\n    attribute vec2 position;\n    uniform mat3 layout;\n    varying vec2 vPosition;\n    void main() {\n        vPosition = position;\n        vec2 pos = (vec3(position, 1.0) * layout).xy;\n        gl_Position = vec4(pos, 0.0, 1.0);\n    }\n",u="\n    precision mediump float;\n    varying vec2 vPosition;\n\n    uniform sampler2D tiles;\n\n    const float numCols = 12.0;\n    const float numRows = 26.0;\n\n    void main() {\n        // Perspective coord\n        vec2 aspect = vec2(numCols / numRows, 1.0);\n        vec2 persp = vPosition + vec2(\n            vPosition.x * 0.08,\n            0.0\n        );\n        persp.x = clamp(persp.x, -1.0, 1.0);\n        vec2 tilePos = vec2((persp.x + 1.0) * 0.5, (persp.y - 1.0) * -0.5);\n        tilePos.y = tilePos.y - 0.03;\n        float tile = texture2D(tiles, tilePos).x;\n        vec4 tileColor = (tile > 0.0) ?  vec4(1.0, 1.0, 1.0, 1.0) : vec4(0.0, 0.0, 0.0, 1.0);\n        gl_FragColor = tileColor;\n    }\n";t.vertexSource=c,t.fragmentSource=u,t.makeNode=function(r){var t=n.Texture[7](0,0,0,0),e=n.Texture[7](0,0,0,0),f=o.makeNode(["tileShadows"],0,[n.Shader[0](c)],[n.Shader[0](u)],0,0,0,[[["tiles",r],0]],0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,[a.__(2,[t])],0,0,0);return i.makeNode(f,t,e,4,4)}},function(r,t,e){"use strict";var n=e(4),a=e(0),i=e(19),o=e(5),c=e(22),u=e(23),f="\n    precision mediump float;\n    attribute vec2 position;\n    uniform mat3 layout;\n    uniform mat3 texTrans;\n    varying vec3 screenP;\n\n    void main() {\n        vec2 transformed = (vec3(position, 1.0) * layout).xy;\n        screenP = vec3(transformed, 0.0);\n        // Todo: Better support texTrans etc to avoid\n        // manual bickering\n        gl_Position = vec4((vec3(position, 1.0) * texTrans).xy, 0.0, 1.0);\n    }\n";function s(r,t){return"\n    precision mediump float;\n    varying vec3 screenP;\n\n    "+i.PointLight[5](r,t)+"\n\n    void main() {\n        // Global pointLight (not using local position)\n        vec3 pointLight = lighting(vec3(0.0), screenP, vec3(0.0, 0.0, 1.0));\n        gl_FragColor = vec4(pointLight, 1.0);\n    }\n  "}t.vertexSource=f,t.fragmentSource=s,t.makeNode=function(){var r=i.PointLight[1](a.__(0,[u.pointLight]),0,0,0,[24],0),t=c.make(u.camera);return o.makeNode(["gridLight"],0,[n.Shader[0](f)],[n.Shader[0](s(r,t))],0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,[2],[1],0,0)}},function(r,t,e){"use strict";var n=e(4),a=e(5),i=e(48),o="\n    precision mediump float;\n    attribute vec2 position;\n    uniform mat3 layout;\n    uniform mat3 tileShadowsMat;\n    uniform mat3 beamsMat;\n    uniform mat3 dropMat;\n    uniform mat3 gridLightMat;\n    varying vec2 vPosition;\n    varying vec2 tileShadowsPos;\n    varying vec2 beamsPos;\n    varying vec2 dropPos;\n    varying vec2 gridLightPos;\n\n    uniform vec2 pixelSize;\n    // Coords to take off lines on sides\n    varying vec2 lineCoords;\n    varying vec2 singlePixel;\n\n    varying vec2 coord;\n    void main() {\n        vPosition = position;\n        coord = (position + 1.0) * 0.5;\n        singlePixel = 2.0/pixelSize;\n        lineCoords = vec2(\n            position.x + singlePixel.x,\n            position.y\n        );\n        vec2 transformed = (vec3(position, 1.0) * layout).xy;\n        tileShadowsPos = (vec3(position, 1.0) * tileShadowsMat).xy;\n        beamsPos = (vec3(position, 1.0) * beamsMat).xy;\n        dropPos = (vec3(position, 1.0) * dropMat).xy;\n        gridLightPos = (vec3(position, 1.0) * gridLightMat).xy;\n        gl_Position = vec4(transformed.xy, 0.0, 1.0);\n    }\n",c="\n    precision mediump float;\n    uniform vec3 bg;\n    uniform vec3 lineColor;\n    uniform vec2 elPos;\n    uniform vec3 elColor;\n    uniform vec3 dropColor;\n    uniform vec2 pixelSize;\n    uniform sampler2D tiles;\n    uniform sampler2D tileShadows;\n    uniform sampler2D beams;\n    uniform sampler2D drop;\n    uniform sampler2D gridLight;\n    uniform vec4 centerRadius;\n    uniform float completedRows;\n\n    varying vec2 vPosition;\n    varying vec2 lineCoords;\n    varying vec2 singlePixel;\n    varying vec2 tileShadowsPos;\n    varying vec2 beamsPos;\n    varying vec2 dropPos;\n    varying vec2 gridLightPos;\n\n    // Normalized to 0.0 - 1.0\n    varying vec2 coord;\n\n    const float numCols = 12.0;\n    const float numRows = 26.0;\n    const vec2 aspect = vec2(numCols / numRows, 1.0);\n    const float colSize = 2.0 / numCols;\n    const float rowSize = 2.0 / numRows;\n    const float wordSize = 1.0;\n    const float wordStart = 0.5;\n    const float tileWidth = 1.0 / numCols;\n    const float tileHeight = 1.0 / numRows;\n\n    float random(vec2 st) {\n        return fract(sin(dot(st.xy, vec2(12.9898, 78.233))) * 43758.5453123);\n    }\n\n    void main() {\n        // todo: Calculate in vertex shader?\n        vec2 elVec = vPosition - centerRadius.xy;\n        vec2 elVecNorm = normalize(elVec);\n        float elVecLength = length(elVec);\n\n        float lengthCoef = max(1.5 - elVecLength, 0.0);\n\n        // Roughly light a triangle below element\n        float triangleDir = dot(elVecNorm, vec2(0.0, -1.0));\n        //float noiseFactor = random(vPosition) * 0.3 + 0.7;\n        float triangleLight = smoothstep(0.0, 0.2, triangleDir) * 0.02;\n        vec3 lPos = vec3(centerRadius.x, centerRadius.y + 0.15, 0.25);\n        vec3 surfaceToLight = lPos - vec3(vPosition.xy, 0.0);\n        vec3 lVec = normalize(surfaceToLight);\n\n        vec3 coneDir = normalize(vec3(0.0, -0.8, 0.2));\n        float lightToSurfaceAngle = degrees(acos(dot(-lVec, coneDir)));\n\n        float aoi = dot(vec3(0.0, 0.0, 1.0), lVec);\n        float attenuation = 1.0 / (1.0 + 100.0 * pow(length(surfaceToLight), 2.0));\n        float endDegree = 60.0 + centerRadius.z * 30.0;\n        float startDegree = endDegree - 25.0 - centerRadius.z * 20.0;\n        attenuation = attenuation * (1.0 - smoothstep(startDegree, endDegree, lightToSurfaceAngle));\n        triangleLight = aoi * attenuation;\n\n        // Global pointLight (not using local position)\n        vec3 gridLight = (texture2D(gridLight, gridLightPos).xyz * 0.7) + 0.3;\n\n        // Completed rows indication\n        vec3 bg2 = mix(bg, bg * 1.1, step(vPosition.y, -1.0 + completedRows * rowSize));\n\n        // Shadow\n        float shadow = texture2D(tileShadows, tileShadowsPos).x;\n        vec3 color = mix(bg2 * gridLight, vec3(0.0, 0.0, 0.0), shadow * 0.15);\n\n        // Aura light\n        /*\n        float skew = (vPosition.y - centerRadius.y + 0.15) / 0.8;\n        skew = 1.0;\n        float auraLight = max(0.15 - length(elVec * centerRadius.wz) * skew, 0.0) * 0.05;\n        color = color + elColor * auraLight;\n        */\n\n        // Line\n        float xblank = (mod(lineCoords.x, colSize) > singlePixel.x) ? 1.0 : 0.0;\n        float x3blank = (mod(lineCoords.x - wordStart, wordSize) > singlePixel.x * 2.0) ? 1.0 : 0.0;\n        float yblank = (mod(lineCoords.y, rowSize) > singlePixel.y) ? 1.0 : 0.0;\n        float lineCoef = (1.0 - xblank * yblank * x3blank) * 0.9 + (1.0 - x3blank) * 0.1;\n        color = mix(color, lineColor * gridLight, lineCoef);\n\n        // Beam\n        vec3 beam = texture2D(beams, beamsPos).xyz;\n        color = mix(color, elColor, (beam.x == 0.0) ? 0.0 : 0.05);\n\n        // Dropbeam\n        float dropBeam = texture2D(drop, dropPos).x;\n        color = mix(color, dropColor, dropBeam * 0.2);\n\n        // Color + triangleLight\n        vec3 tLight = triangleLight * bg2 * elColor;\n        tLight = pow(tLight, vec3(1.0/2.2));\n        color = color + tLight;\n        // Gamma correction\n        gl_FragColor = vec4(color, 1.0);\n    }\n  ";t.vertexSource=o,t.fragmentSource=c,t.makeNode=function(r,t,e,u,f,s,_,l,m,v,d){var g=i.makeNode(0);return a.makeNode(["grid"],0,[n.Shader[0](o)],[n.Shader[0](c)],0,0,0,[[["tiles",e],[["tileShadows",a.SceneTex[0](0,0,u)],[["beams",a.SceneTex[0](0,0,f)],[["drop",a.SceneTex[0](0,0,s)],[["gridLight",a.SceneTex[0](0,0,g)],0]]]]]],0,0,[[["bg",r],[["lineColor",t],[["elPos",m[1]],[["elColor",m[3]],[["dropColor",_],[["centerRadius",v],[["completedRows",d],0]]]]]]]],0,[1],0,0,0,0,0,0,0,0,0,0,0,0,0,0,[[l,[f,[u,[s,[g,0]]]]]],0,0,0,0)}},function(r,t,e){"use strict";var n=e(4),a=e(0),i=e(28),o=e(5),c=e(29),u="\n    precision mediump float;\n    attribute vec2 position;\n    uniform mat3 layout;\n    uniform mat3 model;\n    void main() {\n        vec2 pos = (vec3(position, 1.0) * model * layout).xy;\n        pos = pos + vec2(0.01, 0.02);\n        gl_Position = vec4(pos.xy, 0.0, 1.0);\n    }\n",f="\n    precision mediump float;\n\n    void main() {\n        gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n    }\n",s="\n    precision mediump float;\n    attribute vec2 position;\n    uniform mat3 layout;\n    uniform mat3 lightMat;\n    varying vec2 lightUV;\n    uniform mat3 elMat;\n    varying vec2 elUV;\n    void main() {\n        lightUV = (vec3(position, 1.0) * lightMat).xy;\n        elUV = (vec3(position, 1.0) * elMat).xy;\n        vec2 pos = (vec3(position, 1.0) * layout).xy;\n        gl_Position = vec4(pos, 0.0, 1.0);\n    }\n",_="\n    precision mediump float;\n    varying vec2 lightUV;\n    varying vec2 elUV;\n    uniform sampler2D light;\n    uniform sampler2D el;\n    uniform vec3 color;\n\n    void main() {\n      vec4 elColor = texture2D(el, elUV);\n      vec4 light = texture2D(light, lightUV);\n      gl_FragColor = mix(vec4(0.0, 0.0, 0.0, light.x * 0.8), elColor, step(0.01, elColor.a));\n    }\n",l=[0],m=[0];function v(){var r=l[0];if(r)return r[0];var t=o.makeProgram(n.Shader[0](u),n.Shader[0](f),0,[[["model",5],0]],0,0,[n.VertexAttrib[0]("position",2),0],0,0,0,0,0,0);return l[0]=[t],t}function d(){var r=m[0];if(r)return r[0];var t=o.makeProgram(n.Shader[0](s),n.Shader[0](_),0,[[["color",3],0]],0,[[["light",1],[["el",1],0]]],[n.VertexAttrib[0]("position",2),0],0,0,0,0,0,0);return m[0]=[t],t}t.lightBaseVert=u,t.lightBaseFrag=f,t.vertexSource=s,t.fragmentSource=_,t.lightBaseProgram=l,t.drawElementProgram=m,t.getLightBaseProgram=v,t.getDrawElementProgram=d,t.makeNode=function(r,t){var e=n.Texture[7](0,0,0,0),u=n.Texture[7](0,0,0,0),f=a.__(3,[2/1.5]),s=o.makeNode(0,["lightBase"],0,0,[v()],0,0,0,0,[r[0]],[[["model",r[1]],0]],0,0,0,0,0,0,0,0,0,0,0,0,0,0,[1],0,0,[a.__(2,[e])],0,[1],0),_=i.makeNode(s,e,u,10,10),l=c.makeNode(2,1.5,t,[1],[r[0]],[a.__(1,[r[3]])],0,[r[1]],0,[.25],0);return o.makeNode(0,["drawElement"],0,0,[d()],0,0,[[["light",o.SceneTex[0](0,0,_)],[["el",o.SceneTex[0](0,0,l)],0]]],0,0,[[["color",r[3]],0]],0,0,0,[f],0,[a.__(1,[a.__(0,[.22]),a.__(0,[0])])],0,0,0,0,0,0,[1],0,0,0,[[_,[l,0]]],0,0,0,0)}},function(r,t,e){"use strict";var n=e(4),a=e(5),i="\n    precision mediump float;\n    attribute vec2 position;\n    uniform mat3 layout;\n    uniform mat3 texMat;\n    varying vec2 texUV;\n    void main() {\n        texUV = (vec3(position, 1.0) * texMat).xy;\n        vec2 pos = (vec3(position, 1.0) * layout).xy;\n        gl_Position = vec4(pos, 0.0, 1.0);\n    }\n",o="\n    precision mediump float;\n    varying vec2 texUV;\n    uniform sampler2D tex;\n\n    void main() {\n      vec4 texColor = texture2D(tex, texUV);\n      gl_FragColor = vec4(texColor);\n    }\n",c=[0];function u(){var r=c[0];if(r)return r[0];var t=a.makeProgram(n.Shader[0](i),n.Shader[0](o),0,0,0,[[["tex",1],0]],n.VertexBuffer[3](0),0,0,0,0,0,0);return c[0]=[t],t}t.vertexSource=i,t.fragmentSource=o,t.program=c,t.getProgram=u,t.makeNode=function(r,t,e,n,i){var o,c=0;t&&0!==t[0]?o=[1,1]:c=1,1===c&&(o=e&&0!==e[0]?[1,1]:[2,0]);var f=a.makeNode(0,["cacheResultTex"],0,0,0,0,[[r,0]],0,0,0,0,0,0,0,0,0,0,0,0,0,0,[0],0,0,0,0,0,0,[o[0]],0,[o[1]],0);return a.makeNode(0,["cachedResult"],0,0,[u()],0,0,[[["tex",a.SceneTex[0](0,0,f)],0]],0,0,0,0,0,0,n,0,0,0,0,0,0,0,0,t,[1],e,0,[[f,0]],0,0,0,0)}},function(r,t,e){"use strict";var n=e(4),a=e(0),i=e(5),o="\n    precision mediump float;\n    attribute vec2 position;\n    uniform vec2 pixelSize;\n    varying vec2 vPosition;\n    varying vec2 pixelPos;\n    void main() {\n        float aspect = pixelSize.x / pixelSize.y;\n        vPosition = (aspect > 1.0) ? vec2(position.x, position.y / aspect) : vec2(position.x * aspect, position.y);\n        vPosition = vec2(position.x * aspect, position.y);\n        // Normalize to 0.0 to 1.0\n        //vPosition = vec2((vPosition.x + 1.0) * 0.5, (vPosition.y + 1.0) * 0.5);\n        pixelPos = (position + vec2(1.0, -1.0)) * vec2(0.5, -0.5) * pixelSize;\n        gl_Position = vec4(position, 0.0, 1.0);\n    }\n",c="\n    precision mediump float;\n    uniform float anim;\n    uniform vec3 color;\n    varying vec2 vPosition;\n    varying vec2 pixelPos;\n\n    const mat4 indexMat = mat4(\n        0.0, 8.0, 2.0, 10.0,\n        12.0, 4.0, 14.0, 6.0,\n        3.0, 11.0, 1.0, 9.0,\n        15.0, 7.0, 13.0, 5.0\n    );\n\n    const float colorInterval = 0.04;\n\n    float indexVal() {\n        int xMod = int(mod(pixelPos.x * 0.5, 4.0));\n        int yMod = int(mod(pixelPos.y * 0.5, 4.0));\n        float idxVal =\n            (xMod == 0) ?\n                (yMod == 0) ? indexMat[0][0]\n                : (yMod == 1) ? indexMat[0][1]\n                : (yMod == 2) ? indexMat[0][2]\n                : indexMat[0][3]\n            : (xMod == 1) ?\n                (yMod == 0) ? indexMat[1][0]\n                : (yMod == 1) ? indexMat[1][1]\n                : (yMod == 2) ? indexMat[1][2]\n                : indexMat[1][3]\n            : (xMod == 2) ?\n                (yMod == 0) ? indexMat[2][0]\n                : (yMod == 1) ? indexMat[2][1]\n                : (yMod == 2) ? indexMat[2][2]\n                : indexMat[2][3]\n            :\n                (yMod == 0) ? indexMat[3][0]\n                : (yMod == 1) ? indexMat[3][1]\n                : (yMod == 2) ? indexMat[3][2]\n                : indexMat[3][3];\n        return idxVal / 16.0;\n    }\n\n    void main() {\n        // Index value for this pixel\n        float idxVal = indexVal();\n        vec2 lightPos = vec2(0.0, 0.75);\n        float dist = distance(lightPos, vPosition * vec2(1.0, 1.6)) / 2.5;\n        // Distance in increasing power outwards\n        float colorCoef = max(1.0 - (pow(4.0, dist) - 1.0) / 6.0, 0.0);\n        float cMod = mod(colorCoef, colorInterval);\n        float diffDown = cMod / colorInterval;\n        bool isClosestDown = (diffDown < 0.5) ? true : false;\n        float diff = (isClosestDown) ? diffDown : (1.0 - diffDown);\n        bool useClosest = (diff < idxVal);\n        float closestDown = colorCoef - cMod;\n        float closestUp = colorCoef + colorInterval - cMod;\n        colorCoef = useClosest ?\n            (isClosestDown ? closestDown : closestUp)\n            : (isClosestDown ? closestUp : closestDown);\n        vec3 c = mix(vec3(0.0, 0.0, 0.0), color, colorCoef);\n        gl_FragColor = vec4(c * anim, 1.0);\n    }\n";t.vertexSource=o,t.fragmentSource=c,t.makeNode=function(r,t){return i.makeNode(["background"],0,[n.Shader[0](o)],[n.Shader[0](c)],0,0,[t],0,0,0,[[["color",r],[["anim",i.UFloat[0](0)],0]]],0,[1],0,[a.__(0,[a.__(0,[1]),a.__(0,[1])])],[a.__(0,[.05])],0,0,0,0,[1],0,0,0,0,0,0,0,0,0,0,0)}},function(r,t,e){"use strict";var n=e(4),a=e(38),i=e(13),o=e(5),c=e(6),u="\n    precision mediump float;\n    attribute vec2 position;\n    uniform mat3 layout;\n    uniform mat3 sdfTilesMat;\n    varying vec2 sdfPos;\n    varying vec2 vPosition;\n    void main() {\n        vPosition = position;\n        vec3 transformed = vec3(position, 1.0) * layout;\n        sdfPos = (vec3(position, 1.0) * sdfTilesMat).xy;\n        gl_Position = vec4(transformed.xy, 0.0, 1.0);\n    }\n",f="\n    precision mediump float;\n    varying vec2 vPosition;\n    varying vec2 sdfPos;\n\n    uniform sampler2D tiles;\n    uniform sampler2D sdfTiles;\n\n    const int numCols = 12;\n    const int numRows = 26;\n\n    void main() {\n        vec2 tilePos = vec2((vPosition.x + 1.0) * 0.5, (vPosition.y - 1.0) * -0.5);\n        float tile = texture2D(tiles, tilePos).x;\n        int colorIdx = int(tile * 255.0);\n        vec3 color =\n            (colorIdx == 1) ? "+i.toGlsl(c.caml_array_get(a.colors,2))+"\n            : (colorIdx == 2) ? "+i.toGlsl(c.caml_array_get(a.colors,3))+"\n            : (colorIdx == 3) ? "+i.toGlsl(c.caml_array_get(a.colors,4))+"\n            : (colorIdx == 4) ? "+i.toGlsl(c.caml_array_get(a.colors,5))+"\n            : (colorIdx == 5) ? "+i.toGlsl(c.caml_array_get(a.colors,6))+"\n            : (colorIdx == 6) ? "+i.toGlsl(c.caml_array_get(a.colors,7))+"\n            : "+i.toGlsl(c.caml_array_get(a.colors,8))+";\n        vec3 sdfColor = texture2D(sdfTiles, sdfPos).xyz;\n        //color = color * 0.5 + ((colorIdx == 0) ? vec3(0.0, 0.0, 0.0) : (sdfColor * 0.5));\n        /*\n        float sdfCoef = abs(0.5 - sdfColor.x);\n        float tileCoef = 1.0 - sdfCoef;\n        gl_FragColor = (colorIdx == 0) ? vec4(0.0, 0.0, 0.0, 0.0) : vec4(color * tileCoef + sdfColor * sdfCoef, 1.0);\n        */\n        gl_FragColor = (colorIdx == 0) ? vec4(0.0, 0.0, 0.0, 0.0) : vec4(mix(color, sdfColor, 0.4), 1.0);\n    }\n";t.vertexSource=u,t.fragmentSource=f,t.makeNode=function(r,t){return o.makeNode(["tilesDraw"],0,[n.Shader[0](u)],[n.Shader[0](f)],0,0,0,[[["tiles",r],[["sdfTiles",o.SceneTex[0](0,0,t)],0]]],0,0,[0],0,0,0,0,0,0,0,0,0,0,0,0,[1],0,[1],0,0,0,0,0,0)}},function(r,t,e){"use strict";var n=e(4),a=e(5),i="\n    precision mediump float;\n    attribute vec2 position;\n    uniform mat3 layout;\n    varying vec2 vPosition;\n    void main() {\n        vPosition = position;\n        vec3 pos2 = vec3(position, 1.0) * layout;\n        gl_Position = vec4(pos2.xy, 0.0, 1.0);\n    }\n",o="\n    precision mediump float;\n    varying vec2 vPosition;\n\n    void main() {\n        gl_FragColor = vec4(1.0, 1.0, 1.0, 0.6);\n    }\n";t.vertexSource=i,t.fragmentSource=o,t.makeNode=function(r){return a.makeNode(["tileBlink"],0,[n.Shader[0](i)],[n.Shader[0](o)],0,0,0,0,0,[r],0,0,0,0,0,0,0,0,0,0,0,0,0,[1],0,0,[1],0,0,0,0,0)}},function(r,t,e){"use strict";var n=e(4),a=e(0),i=e(5),o="\n    precision mediump float;\n    attribute vec2 position;\n    attribute float fromDrop;\n    uniform mat3 layout;\n    varying float vFromDrop;\n    void main() {\n        vFromDrop = fromDrop;\n        vec2 pos = (vec3(position, 1.0) * layout).xy;\n        gl_Position = vec4(pos, 0.0, 1.0);\n    }\n",c="\n    precision mediump float;\n    varying float vFromDrop;\n    uniform float sinceDrop;\n\n    void main() {\n        float c = max(0.0, vFromDrop - sinceDrop);\n        gl_FragColor = vec4(c, c, c, 1.0);\n    }\n";t.vertexSource=o,t.fragmentSource=c,t.makeNode=function(r){return i.makeNode(["dropBeams"],0,[n.Shader[0](o)],[n.Shader[0](c)],0,0,0,0,0,[r],[[["sinceDrop",i.UFloat[1](0)],0]],0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,[a.__(1,[1024])],0,[1],0)}},function(r,t,e){"use strict";var n=e(4),a=e(5),i="\n    precision mediump float;\n    attribute vec2 position;\n    uniform mat3 layout;\n    varying vec2 vPosition;\n    void main() {\n        vPosition = position;\n        vec2 pos = (vec3(position, 1.0) * layout).xy;\n        gl_Position = vec4(pos, 0.0, 1.0);\n    }\n",o="\n    precision mediump float;\n    varying vec2 vPosition;\n\n    void main() {\n        gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n    }\n";t.vertexSource=i,t.fragmentSource=o,t.makeNode=function(r){return a.makeNode(["beams"],0,[n.Shader[0](i)],[n.Shader[0](o)],0,0,0,0,0,[r],0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,[2],0,[1],0)}},function(r,t,e){"use strict";var n=e(4),a=e(0),i=e(13),o=e(19),c=e(5),u=e(2);function f(r){var t=r[4],e=r[1];return t?0!==e?"\n        precision mediump float;\n        attribute vec2 position;\n        uniform mat3 model;\n        uniform mat3 layout;\n        uniform mat3 texTrans;\n        varying vec2 vPosition;\n        varying vec3 vScreenPos;\n        void main() {\n            vec3 toModel = vec3(position, 1.0) * model;\n            vec2 pos = (vec3(toModel.xy, 1.0) * layout).xy;\n            vScreenPos = vec3(pos, 0.0);\n            vPosition = position;\n            // texTrans\n            pos = (vec3(position, 1.0) * texTrans).xy;\n            gl_Position = vec4(pos, 0.0, 1.0);\n        }\n    ":"\n        precision mediump float;\n        attribute vec2 position;\n        uniform mat3 model;\n        uniform mat3 layout;\n        uniform mat3 texTrans;\n        varying vec2 vPosition;\n        varying vec3 vScreenPos;\n        void main() {\n            vec3 toModel = vec3(position, 1.0) * model;\n            vPosition = position;\n            // Not sure what makes sense here, it's a bit\n            // of a mess. This is what is needed for the\n            // side elements though\n            vec2 pos = (vec3(toModel.xy, 1.0) * layout).xy;\n            vScreenPos = vec3((vec3(position, 1.0) * layout).xy, 0.0);\n            pos = (vec3(toModel.xy, 1.0) * texTrans).xy;\n            gl_Position = vec4(pos, 0.0, 1.0);\n        }\n    ":0!==e?"\n        precision mediump float;\n        attribute vec2 position;\n        uniform mat3 layout;\n        uniform mat3 texTrans;\n        varying vec2 vPosition;\n        varying vec3 vScreenPos;\n        void main() {\n            vPosition = (position + vec2(1.0, -1.0)) * vec2(0.5, -0.5);\n            vec2 pos = (vec3(position, 1.0) * layout).xy;\n            vScreenPos = vec3(pos, 0.0);\n            // texTrans\n            pos = (vec3(position, 1.0) * texTrans).xy;\n            gl_Position = vec4(pos, 0.0, 1.0);\n        }\n    ":"\n        precision mediump float;\n        attribute vec2 position;\n        uniform mat3 layout;\n        uniform mat3 texTrans;\n        varying vec2 vPosition;\n        varying vec3 vScreenPos;\n        void main() {\n            vPosition = position;\n            vec2 pos = (vec3(position, 1.0) * layout).xy;\n            vScreenPos = vec3(pos, 0.0);\n            // texTrans\n            pos = (vec3(pos, 1.0) * texTrans).xy;\n            gl_Position = vec4(pos, 0.0, 1.0);\n        }\n    "}function s(r){var t,e=r[4],n=r[1],a=e||0!==n?"vPosition":u.failwith("ByModel fragCoords requested, but no model provided"),c=r[5];t="number"==typeof c?["","color"]:c.tag?["uniform vec3 uColor;\n","mix(color, uColor, "+u.string_of_float(r[6])+")"]:["","mix(color, "+i.toGlsl(c[0])+", "+u.string_of_float(r[6])+")"];var f,s=r[9],_=r[8];if(s){var l=s[0];f=_?"(pixelEye.z - dist < "+u.string_of_float(l)+") ? 0.0 : "+u.string_of_float(_[0]):"(pixelEye.z - dist < "+u.string_of_float(l)+") ? 0.0 : 1.0"}else f=_?u.string_of_float(_[0]):"1.0";var m=o.ProgramLight[5](r[10]),v=o.ProgramLight[6](r[10]);return"\n        precision mediump float;\n        varying vec2 vPosition;\n        varying vec3 vScreenPos;\n\n        "+t[0]+"\n\n        float epsilon = 0.00005;\n        float minDist = 1.0;\n        float maxDist = 5.0;\n        const int marchingSteps = 30;\n\n        "+m+"\n\n        "+v+"\n\n        float sdfDist(vec3 point) {\n            "+r[0]+"\n        }\n\n        vec3 estimateNormal(vec3 point) {\n            return normalize(vec3(\n                sdfDist(vec3(point.x + epsilon, point.y, point.z)) - sdfDist(vec3(point.x - epsilon, point.y, point.z)),\n                sdfDist(vec3(point.x, point.y + epsilon, point.z)) - sdfDist(vec3(point.x, point.y - epsilon, point.z)),\n                sdfDist(vec3(point.x, point.y, point.z + epsilon)) - sdfDist(vec3(point.x, point.y, point.z - epsilon))\n            ));\n        }\n\n        float shortestDistance(vec3 eye, vec3 dir) {\n            float depth = minDist;\n            float end = maxDist;\n            for (int i = 0; i < marchingSteps; i++) {\n                float dist = sdfDist(eye + depth * dir);\n                if (dist < epsilon) {\n                    return depth;\n                }\n                depth += dist;\n                if (depth >= end) {\n                    /* Moved beyond end */\n                    return end;\n                }\n            }\n            return end;\n        }\n\n        void main() {\n            vec2 viewport = vec2(1.0, 1.0);\n            vec2 fragCoord = "+a+";\n            vec3 eye = vec3(0.0, 0.0, 5.0);\n            vec3 pixelEye = vec3(fragCoord, 4.0);\n            float dist = shortestDistance(pixelEye, vec3(0.0, 0.0, -1.0));\n            // All points should hit a shape in this shader\n            vec3 p = pixelEye + dist * vec3(0.0, 0.0, -1.0);\n            vec3 color = vec3(0.6, 0.6, 0.6);\n            vec3 N = estimateNormal(p);\n            // todo: Adjust estimateNormal?\n            N.y = N.y * -1.0;\n            float light = (lighting(p, vec3(vScreenPos.xy, p.z), N)).x;\n            color = color * light;\n            float alpha = "+f+";\n            gl_FragColor = vec4("+t[1]+", alpha);\n        }\n    "}t.makeVertexSource=f,t.makeFragmentSource=s,t.make=function(r,t,e,n,a,i,o,c,u,f,s,_){return[r,t,a?a[0]:1,i?i[0]:1,e,o?o[0]:0,c?c[0]:.4,u,f,s,n]},t.makeProgram=function(r){var t,e=r[4]?[["model",5],0]:0,a=r[5];return t="number"!=typeof a&&a.tag?[["uColor",3],e]:e,c.makeProgram(n.Shader[0](f(r)),n.Shader[0](s(r)),0,[t],0,0,n.VertexBuffer[3](0),0,0,0,0,0,0)},t.makeHash=function(r){var t,e=r[4]?1:0,n=r[5];return t="number"==typeof n?0:n.tag?[0]:[[n[0]]],[r[1],e,t,r[6],r[9],r[8],o.ProgramLight[0](r[10])]},t.makeNode=function(r,t,e,i,o,u,_,l,m){var v,d=e?e[0]:"sdfNode",g=_?_[0]:0,h=r[8],y=r[9]?1:h?+(h[0]<1):0,p=r[4],b=p?[["model",p[0]],0]:0,w=r[5];v="number"!=typeof w&&w.tag?[["uColor",w[0]],b]:b;var x=i?a.__(3,[i[0]]):a.__(0,[a.__(0,[r[2]]),a.__(0,[r[3]])]),k=r[7]?1:0,M=l?[0,0,[l[0]]]:[[n.Shader[0](f(r))],[n.Shader[0](s(r))],0];return c.makeNode(t,[d],M[0],M[1],M[2],0,[g],0,0,r[7],[v],0,0,0,[x],0,u,0,0,0,0,0,0,[y],0,[k],0,0,o,[1],[k],0)}},function(r,t,e){"use strict";var n=e(7),a=e(0),i=e(1),o=e(26),c=e(6),u=e(2);t.loadFiles=function(r,t){var e=n.length(r),f=[0],s=c.caml_make_vect(e,0);return n.iteri(function(r,n){switch(0|n.tag){case 0:var _=new XMLHttpRequest;return _.responseType="arraybuffer",_.open("GET","assets/"+n[0],!0),_.onreadystatechange=function(){return 4!==_.readyState||200!==_.status&&0!==_.status?0:(c.caml_array_set(s,r,a.__(1,[new Uint8Array(_.response)])),f[0]=f[0]+1|0,f[0]===e?i._1(t,s):0)},_.send(null),0;case 1:return o.Gl[29]("assets/"+n[0],0,function(n){return n?(c.caml_array_set(s,r,a.__(0,[n[0]])),f[0]=f[0]+1|0,f[0]===e?i._1(t,s):0):u.failwith("Could not load image")},0);case 2:return i._2(o.Gl[1][0],"assets/"+n[0],function(n){return c.caml_array_set(s,r,a.__(2,[n])),f[0]=f[0]+1|0,f[0]===e?i._1(t,s):0})}},r)}},function(r,t,e){"use strict";var n=e(0),a=e(1),i=e(58),o=e(6),c=e(2);t.request=function(r,t,e){return i.loadFiles([n.__(0,["fonts/"+r+".bin"]),[n.__(1,["fonts/"+r+"_"+t+".png"]),0]],function(r){var t=o.caml_array_get(r,0),n=o.caml_array_get(r,1);return"number"==typeof t||1!==t.tag||"number"==typeof n||n.tag?c.failwith("Font loading failed"):a._1(e,[t[0],n[0]])})}},function(r,t,e){"use strict";var n=e(20),a=e(7),i=e(15),o=e(6),c=e(8),u=e(2),f=o.caml_array_get;function s(r,t,e){for(var a="",c=t;;){var u=c,f=a,s=i.make(1,n.chr(o.caml_array_get(r,u)));if(!((u+1|0)<e))return f+s;c=u+1|0,a=f+s}}t.fromBase64=function(r){var t=r.length;t%4>0&&u.failwith("Invalid base64 string.");var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=o.caml_make_vect(e.length,32),a=[0];i.iteri(function(r,t){return o.caml_array_set(n,r,t),t>a[0]?(a[0]=t,0):0},e),45>a[0]&&(a[0]=45),95>a[0]&&(a[0]=95);var f=o.caml_make_vect(a[0],0);i.iteri(function(r,t){return o.caml_array_set(f,t,r)},e),o.caml_array_set(f,45,62),o.caml_array_set(f,95,63);var s=61===o.caml_array_get(r,t-2|0)?2:61===o.caml_array_get(r,t-1|0)?1:0,_=o.caml_make_vect((c.imul(t,3)/4|0)-s|0,0),l=0!=+(s>0)?t-4|0:t,m=function(t,e){for(;;){var n=e,a=t,i=o.caml_array_get(f,o.caml_array_get(r,a))<<18|o.caml_array_get(f,o.caml_array_get(r,a+1|0))<<12|o.caml_array_get(f,o.caml_array_get(r,a+2|0))<<6|o.caml_array_get(f,o.caml_array_get(r,a+3|0));if(o.caml_array_set(_,n,i>>16&255),o.caml_array_set(_,n+1|0,i>>8&255),o.caml_array_set(_,n+2|0,255&i),!((a+4|0)<l))return[a,n];e=n+3|0,t=a+4|0}}(0,0),v=m[1],d=m[0];if(2===s){var g=o.caml_array_get(f,o.caml_array_get(r,d))<<2|o.caml_array_get(f,o.caml_array_get(r,d+1|0))>>4;o.caml_array_set(_,v,255&g)}else if(1===s){var h=o.caml_array_get(f,o.caml_array_get(r,d))<<10|o.caml_array_get(f,o.caml_array_get(r,d+1|0))<<4|o.caml_array_get(f,o.caml_array_get(r,d+2|0))>>2;o.caml_array_set(_,v,h>>8&255),o.caml_array_set(_,v+1|0,255&h)}return _},t.readUInt32LE=function(r,t){return(o.caml_array_get(r,t)|o.caml_array_get(r,t+1|0)<<8|o.caml_array_get(r,t+2|0)<<16)+(o.caml_array_get(r,t+3|0)<<24)|0},t.readInt32LE=function(r,t){return o.caml_array_get(r,t)|o.caml_array_get(r,t+1|0)<<8|o.caml_array_get(r,t+2|0)<<16|o.caml_array_get(r,t+3|0)<<24},t.readUInt16LE=function(r,t){return o.caml_array_get(r,t)|o.caml_array_get(r,t+1|0)<<8},t.readInt16LE=function(r,t){var e=o.caml_array_get(r,t)|o.caml_array_get(r,t+1|0)<<8;return 32768&e?-65536|e:e},t.readUInt8=f,t.readInt8=function(r,t){var e=o.caml_array_get(r,t);return 128&e?c.imul(1+(255-e|0)|0,-1):e},t.utf8Slice=function(r,t,e){return a.fold_right(function(r,t){return t+i.make(1,n.chr(r))},function(t,n){for(;;){var a=n,i=t;if(i>=e)return a;var c=o.caml_array_get(r,i),u=-1,f=c>239?4:c>223?3:c>191?2:1;if((i+f|0)<=e){var s=f-1|0;if(!(s>3||s<0))switch(s){case 0:c<128&&(u=c);break;case 1:var _=o.caml_array_get(r,i+1|0);if(128==(192&_)){var l=(31&c)<<6|63&_;l>127&&(u=l)}break;case 2:var m=o.caml_array_get(r,i+1|0),v=o.caml_array_get(r,i+2|0);if(128==(192&m)&&128==(192&v)){var d=(15&c)<<12|(63&m)<<6|63&v;d>2047&&(d<55296||d>57343)&&(u=d)}break;case 3:var g=o.caml_array_get(r,i+1|0),h=o.caml_array_get(r,i+2|0),y=o.caml_array_get(r,i+3|0);if(128==(192&g)&&128==(12&h)&&128==(192&y)){var p=(15&c)<<18|(63&g)<<12|(63&h)<<6|63&y;p>65535&&p<1114112&&(u=p)}}}-1!==u?(n=[(u=u-65536|0)>>>10&1023|55296,[1023&(56320|u),a]],t=i+f|0):(n=[u=65533,a],t=i+1|0)}}(t,0),"")},t.readStringSlice=s,t.readStringNT=function(r,t){for(var e=t,n=r.length;e<n&&0!==o.caml_array_get(r,e);)e=e+1|0;return s(r,t,e)}},function(r,t,e){"use strict";var n=e(12),a=e(1),i=e(6),o=[0];function c(r,t){if(o){var e=o[0];r[0]=n.init(t,function(t){return t<r[1]?i.caml_array_get(r[0],t):e})}else r[0]=n.init(t,function(t){return t<r[1]?i.caml_array_get(r[0],t):0});return r[1]=t,0}var u=[o,function(r){return[o?i.caml_make_vect(r,o[0]):n.init(r,function(){return 0}),r,0]},c,function(r,t){return r[1]<t?c(r,t+(t/4|0)|0):0},function(r,t){return r[2]>=r[1]&&c(r,r[1]<<1),i.caml_array_set(r[0],r[2],t),r[2]=r[2]+1|0,0},function(r,t,e){return(r[2]+2|0)>r[1]&&c(r,r[1]<<1),i.caml_array_set(r[0],r[2],t),i.caml_array_set(r[0],r[2]+1|0,e),r[2]=r[2]+2|0,0},function(r,t,e,n){return(r[2]+3|0)>r[1]&&c(r,r[1]<<1),i.caml_array_set(r[0],r[2],t),i.caml_array_set(r[0],r[2]+1|0,e),i.caml_array_set(r[0],r[2]+2|0,n),r[2]=r[2]+3|0,0},function(r,t,e,n,a){return(r[2]+4|0)>r[1]&&c(r,r[1]<<1),i.caml_array_set(r[0],r[2],t),i.caml_array_set(r[0],r[2]+1|0,e),i.caml_array_set(r[0],r[2]+2|0,n),i.caml_array_set(r[0],r[2]+3|0,a),r[2]=r[2]+4|0,0},function(r){return n.sub(r[0],0,r[2])}];t.Make=function(r){var t=r[1]?[a._1(r[0],0)]:0,e=function(e,o){if(t){var c=t[0];e[0]=n.init(o,function(r){return r<e[1]?i.caml_array_get(e[0],r):c})}else e[0]=n.init(o,function(t){return t<e[1]?i.caml_array_get(e[0],t):a._1(r[0],0)});return e[1]=o,0};return[t,function(e){return[t?i.caml_make_vect(e,t[0]):n.init(e,function(){return a._1(r[0],0)}),e,0]},e,function(r,t){return r[1]<t?e(r,t+(t/4|0)|0):0},function(r,t){return r[2]>=r[1]&&e(r,r[1]<<1),i.caml_array_set(r[0],r[2],t),r[2]=r[2]+1|0,0},function(r,t,n){return(r[2]+2|0)>r[1]&&e(r,r[1]<<1),i.caml_array_set(r[0],r[2],t),i.caml_array_set(r[0],r[2]+1|0,n),r[2]=r[2]+2|0,0},function(r,t,n,a){return(r[2]+3|0)>r[1]&&e(r,r[1]<<1),i.caml_array_set(r[0],r[2],t),i.caml_array_set(r[0],r[2]+1|0,n),i.caml_array_set(r[0],r[2]+2|0,a),r[2]=r[2]+3|0,0},function(r,t,n,a,o){return(r[2]+4|0)>r[1]&&e(r,r[1]<<1),i.caml_array_set(r[0],r[2],t),i.caml_array_set(r[0],r[2]+1|0,n),i.caml_array_set(r[0],r[2]+2|0,a),i.caml_array_set(r[0],r[2]+3|0,o),r[2]=r[2]+4|0,0},function(r){return n.sub(r[0],0,r[2])}]},t.ArrayBInt=u},function(r,t,e){"use strict";var n=e(4),a=e(10),i=e(7),o=e(0),c=e(13),u=e(1),f=e(5),s=e(15),_=e(32),l=e(30),m=e(8),v=e(2),d=e(21);function g(r){var t=r[9]?["attribute vec3 color;\n","varying vec3 vColor;\n","vColor = color;\n"]:["","",""];return"\n    precision mediump float;\n    attribute vec2 position;\n    attribute vec2 uv;\n    "+t[0]+"\n    attribute float size;\n\n    uniform mat3 model;\n    uniform mat3 layout;\n    uniform vec2 pixelSize;\n\n    varying vec2 vUv;\n    varying float smoothFactor;\n    "+t[1]+"\n\n    void main() {\n        vUv = uv;\n      "+t[2]+"\n        // Bit trying and failing to get this somewhat right\n        // Can probably be calibrated better\n        smoothFactor = model[0][0] / pixelSize.x / size * 600.0;\n        vec2 pos = vec3(vec3(position, 1.0) * model * layout).xy;\n        gl_Position = vec4(pos, 0.0, 1.0);\n    }\n  "}function h(r){var t=r[9]?["varying vec3 vColor;\n","","vColor"]:["","uniform vec3 color;\n","color"];return"\n    #ifdef GL_OES_standard_derivatives\n    #extension GL_OES_standard_derivatives : enable\n    #endif\n    precision mediump float;\n    uniform sampler2D map;\n    "+t[1]+"\n    uniform float opacity;\n    varying vec2 vUv;\n    "+t[0]+"\n    varying float smoothFactor;\n\n    float aastep(float value) {\n      #ifdef GL_OES_standard_derivatives\n        float afwidth = length(vec2(dFdx(value), dFdy(value))) * 0.70710678118654757;\n      #else\n        float afwidth = (1.0 / 32.0) * (1.4142135623730951 / (2.0 * gl_FragCoord.w));\n      #endif\n      afwidth = afwidth * smoothFactor;\n      return smoothstep(0.5 - afwidth, 0.5 + afwidth, value);\n    }\n\n    void main() {\n        float discardLimit = 0.0001;\n        vec4 texColor = 1.0 - texture2D(map, vUv);\n        float alpha = aastep(texColor.x);\n        vec3 c = "+t[2]+" * alpha;\n        gl_FragColor = vec4(c, opacity * alpha);\n        if (alpha < discardLimit) {\n            discard;\n        }\n    }\n  "}var y=s.trim("#version 300 es\n    precision mediump float;\n    attribute vec2 position;\n    attribute vec2 uv;\n    varying vec2 vUv;\n\n    //uniform mat3 model;\n\n    void main() {\n        vUv = uv;\n        //vec2 pos = vec3(model * vec3(position, 1.0)).xy;\n        vec2 pos = position;\n        gl_Position = vec4((pos - vec2(40.0, 0.0)) / 50., 0.0, 1.0);\n    }\n"),p=s.trim("#version 300 es\n    #ifdef GL_OES_standard_derivatives\n    #extension GL_OES_standard_derivatives : enable\n    #endif\n    precision mediump float;\n    uniform sampler2D map;\n    varying vec2 vUv;\n\n    float median(float r, float g, float b) {\n        return max(min(r, g), min(max(r, g), b));\n    }\n\n    void main() {\n        float opacity = 0.5;\n        vec3 color = vec3(0.2, 0.5, 0.8);\n        vec3 sample = 1.0 - texture2D(map, vUv).rgb;\n        float sigDist = median(sample.r, sample.g, sample.b) - 0.5;\n        float alpha = clamp(sigDist/fwidth(sigDist) + 0.5, 0.0, 1.0);\n        gl_FragColor = vec4(color.xyz, alpha * opacity);\n    }\n"),b=[function(r){return[r[9]]},function(r){var t=0!==r[9]?[["model",5],[["opacity",0],0]]:[["model",5],[["color",3],[["opacity",0],0]]],e=r[9]?[n.VertexAttrib[0]("position",2),[n.VertexAttrib[0]("uv",2),[n.VertexAttrib[0]("size",0),[n.VertexAttrib[0]("color",3),0]]]]:[n.VertexAttrib[0]("position",2),[n.VertexAttrib[0]("uv",2),[n.VertexAttrib[0]("size",0),0]]];return f.makeProgram(n.Shader[0](g(r)),n.Shader[0](h(r)),0,[t],0,[[["map",0],0]],e,0,0,0,0,0,0)},2],w=d.Make(b);function x(r,t,e,a){var o=e?e[0]:.5,c=_.getPartInfo(r),u=i.map(function(r){return l.getTexture(t[0],r)},c[0]),s=0!=+(i.length(c[1])>1)?1:0,m=s?[["position",2],[["uv",2],[["size",0],[["color",3],0]]]]:[["position",2],[["uv",2],[["size",0],0]]],v=n.VertexBuffer[0]([],m,1),d=n.IndexBuffer[0]([],1),g=1/o;return[r,c,v,d,f.UMat3f[0](0),f.SceneVO[0](v,[d]),u,g,t,s]}function k(r,t,e,n,a,i,o,u){var f=n?n[0]:.2,s=a?a[0]:1,l=i?i[0]:0,m=o?o[0]:c.fromFloats(1,1,1);return x(_.block([l],0,[t],[f],[m],0,0,0,[_.text(r),0]),e,[f*s])}function M(r,t){return t[16]=1,l.requestMultiple(r[8][0],r[1][0],function(){var e=_.FontLayout[7](r[8],r[0],r[9]),i=e[0];n.VertexBuffer[6](r[2],i);var o=0!==r[9]?_.FontLayout[2]:_.FontLayout[1];n.IndexBuffer[4](r[3],n.IndexBuffer[2](m.div(i.length,o)));var c=-.5*e[1],u=a.Mat3[3](a.Mat3[4](1,r[7]),a.Mat3[5](0,c));return n.Uniform[10](r[4][1],u),t[16]=0,0})}function S(r,t,e,n,a,s,_){var l,m=e?e[0]:"fontDraw",d=n?n[0]:1,g=a?a[0]:0;if(0!==r[9])l=[["model",r[4]],[["opacity",f.UFloat[0](d)],0]];else{var h=r[1][1],y=h&&!h[1]?h[0]:v.failwith("Could not find font color");l=[["model",r[4]],[["color",f.UVec3f[3](c.toVec3(y))],[["opacity",f.UFloat[0](d)],0]]]}var p=i.mapi(function(r,t){return r?["map"+v.string_of_int(r+1|0),f.SceneTex[1](0,0,t)]:["map",f.SceneTex[1](0,0,t)]},r[6]),b=f.makeNode(t,[m],0,0,[u._1(w[1],r)],0,0,[p],0,[r[5]],[l],0,[1],0,[o.__(3,[r[7]])],0,s,0,0,0,0,0,[1],[1],0,0,[g],0,0,0,0,0);return M(r,b),b}t.vertexSource=g,t.fragmentSource=h,t.msdfVertexSource=y,t.msdfFragmentSource=p,t.StoreSpec=b,t.Programs=w,t.makeText=x,t.makeSimpleText=k,t.updateNode=M,t.makeNode=S,t.makePartNode=function(r,t,e,n,a,i,o,c,u){var f=e?e[0]:.5,s=i?i[0]:1,_=o?o[0]:0;return S(x(r,t,[f]),n,a,[s],[_],c)},t.makeSimpleNode=function(r,t,e,n,a,i,o,u,f,s,_,l){var m=n?n[0]:.2,v=a?a[0]:1,d=i?i[0]:0,g=o?o[0]:c.fromFloats(1,1,1),h=s?s[0]:1,y=_?_[0]:0;return S(k(r,t,e,[m],[v],[d],[g]),u,f,[h],[y],0)}},function(r,t,e){"use strict";var n=e(10),a=e(1),i=e(5),o=4*Math.atan(1),c=o/2;function u(r,t){switch(r){case 0:return function(r){return r/t};case 1:return function(r){return Math.sin(r/t*c)};case 2:return function(r){return Math.sin(r/t*c-c)+1};case 3:return function(r){return.5*Math.sin(r/t*o-c)+.5}}}t.pi=o,t.halfPi=c,t.getEasingFunction=u,t.anim=function(r,t,e,o,c,f,s,_,l){var m,v=o?o[0]:1,d=c?c[0]:2,g=f?f[0]:1,h=u(v,d);switch(0|t.tag){case 0:var y=t[1],p=t[0],b=y-p;if(r.tag){var w=r[1],x=r[0];m=[function(r,t){return i.setUniformFloat(r,x,w,p+b*a._1(h,t[5]))},function(r){return i.setUniformFloat(r,x,w,y)}]}else{var k=r[0];m=[function(r,t){return i.UFloat[3](r,k,p+b*a._1(h,t[5]))},function(r){return i.UFloat[3](r,k,y)}]}break;case 1:var M=t[1],S=t[0],C=n.Vec2[2](S),P=n.Vec2[3](S),T=n.Vec2[2](M)-C,A=n.Vec2[3](M)-P;if(r.tag){var D=r[1],V=r[0];m=[function(r,t){var e=a._1(h,t[5]);return i.setUniformVec2f(r,V,D,n.Vec2[5](C+T*e,P+A*e))},function(r){return i.setUniformVec2f(r,V,D,M)}]}else{var U=r[0];m=[function(r,t){var e=a._1(h,t[5]);return i.UVec2f[3](r,U,n.Vec2[5](C+T*e,P+A*e))},function(r){return i.UVec2f[3](r,U,M)}]}break;case 2:var N=t[1],L=t[0],B=n.Vec3[4](L),F=n.Vec3[5](L),I=n.Vec3[6](L),z=n.Vec3[4](N)-B,E=n.Vec3[5](N)-F,q=n.Vec3[6](N)-I;if(r.tag){var R=r[1],G=r[0];m=[function(r,t){var e=a._1(h,t[5]);return i.setUniformVec3f(r,G,R,n.Vec3[1](B+z*e,F+E*e,I+q*e))},function(r){return i.setUniformVec3f(r,G,R,N)}]}else{var H=r[0];m=[function(r,t){var e=a._1(h,t[5]);return i.UVec3f[4](r,H,n.Vec3[1](B+z*e,F+E*e,I+q*e))},function(r){return i.UVec3f[4](r,H,N)}]}}return i.makeAnim(m[0],m[1],d,e,s,[g],_,0)}},function(r,t,e){"use strict";var n=e(4),a=e(0),i=e(1),o=e(19),c=e(5);function u(r){return"\n        precision mediump float;\n        varying vec3 vPos;\n        varying vec3 vScreenPos;\n        varying vec3 vNormal;\n        "+o.ProgramLight[5](r)+"\n\n        "+o.ProgramLight[6](r)+"\n\n        void main() {\n            vec3 color = lighting(vPos, vScreenPos, vNormal);\n            gl_FragColor = vec4(color, 0.2);\n        }\n    "}var f=[function(r){return[o.ProgramLight[0](r)]},function(r){var t=u(r);return c.makeProgram(n.Shader[0]("\n        precision mediump float;\n        attribute vec3 position;\n        attribute vec3 normal;\n        uniform mat3 layout;\n        varying vec3 vPos;\n        varying vec3 vScreenPos;\n        varying vec3 vNormal;\n        void main() {\n            // Z currently not affected by layout\n            vec3 pos2 = vec3((vec3(position.xy, 1.0) * layout).xy, position.z);\n            vPos = position;\n            vScreenPos = pos2;\n            vNormal = normal;\n            gl_Position = vec4(pos2, 1.0);\n        }\n    "),n.Shader[0](t),[o.ProgramLight[3](r)],0,0,0,[n.VertexAttrib[0]("position",3),[n.VertexAttrib[0]("normal",3),0]],0,0,0,0,0,0)},3],s=e(21).Make(f);t.vertSource=function(){return"\n        precision mediump float;\n        attribute vec3 position;\n        attribute vec3 normal;\n        uniform mat3 layout;\n        varying vec3 vPos;\n        varying vec3 vScreenPos;\n        varying vec3 vNormal;\n        void main() {\n            // Z currently not affected by layout\n            vec3 pos2 = vec3((vec3(position.xy, 1.0) * layout).xy, position.z);\n            vPos = position;\n            vScreenPos = pos2;\n            vNormal = normal;\n            gl_Position = vec4(pos2, 1.0);\n        }\n    "},t.fragSource=u,t.StoreSpec=f,t.Programs=s,t.make=function(r,t,e,n){var u=t?t[0]:a.__(0,[a.__(0,[1]),a.__(0,[1])]);return c.makeNode(0,["node3d"],0,0,[i._1(s[1],e)],0,0,0,0,[r],[o.ProgramLight[3](e)],0,0,0,[u],0,0,0,0,0,0,0,0,[1],0,0,0,0,0,0,0,0)}},function(r,t,e){"use strict";var n=e(0),a=e(5);t.vertical=function(r,t,e,i,o,c,u,f,s,_){var l=t?t[0]:"verticalLayout",m=e?e[0]:n.__(3,[1]),v=u?u[0]:0,d=f?f[0]:0,g=s?s[0]:1;return a.makeNode(r,[l],0,0,0,0,[_],0,0,0,0,0,0,0,[m],c,o,[1],i,[d],[g],[0],0,0,0,0,[v],0,0,0,0,0)},t.horizontal=function(r,t,e,i,o,c){var u=t?t[0]:"horizontalLayout",f=e?e[0]:n.__(3,[1]),s=o?o[0]:0;return a.makeNode(r,[u],0,0,0,0,[c],0,0,0,0,0,0,0,[f],0,0,[0],i,0,0,[0],0,0,0,0,[s],0,0,0,0,0)},t.stacked=function(r,t,e,i,o,c,u,f){var s=t?t[0]:"stackedLayout",_=e?e[0]:n.__(3,[1]),l=i?i[0]:0,m=o?o[0]:0,v=c?c[0]:0;return a.makeNode(r,[s],0,0,0,0,[f],0,0,0,0,0,0,0,[_],0,u,[2],0,[m],[v],[0],0,0,0,0,[l],0,0,0,0,0)}},function(r,t,e){"use strict";var n=e(4),a=e(10),i=e(5),o=e(6);function c(r,t,e){var n=a.Vec3[1](t[0]-r[0],t[1]-r[1],t[2]-r[2]),i=a.Vec3[1](e[0]-r[0],e[1]-r[1],e[2]-r[2]);return a.Vec3[11](a.Vec3[13](n,i))}var u=[function(r,t,e){return[r,t,e]},c];function f(r,t,e,n){return[r,t,e,n]}function s(r){return c(r[0],r[1],r[3])}var _=[f,function(r,t,e,n,a){return f([r,t-n,a],[r+e,t-n,a],[r+e,t,a],[r,t,a])},s];function l(r){var t=r[1],e=r[0],n=s(t),a=s(t),i=c(t[1],e[1],t[2]),u=c(t[0],e[0],t[1]),f=c(t[3],e[3],t[0]),_=c(t[2],e[2],t[3]);return[t[0][0],t[0][1],t[0][2],o.caml_array_get(n,0),o.caml_array_get(n,1),o.caml_array_get(n,2),t[1][0],t[1][1],t[1][2],o.caml_array_get(n,0),o.caml_array_get(n,1),o.caml_array_get(n,2),t[2][0],t[2][1],t[2][2],o.caml_array_get(n,0),o.caml_array_get(n,1),o.caml_array_get(n,2),t[3][0],t[3][1],t[3][2],o.caml_array_get(n,0),o.caml_array_get(n,1),o.caml_array_get(n,2),t[1][0],t[1][1],t[1][2],o.caml_array_get(i,0),o.caml_array_get(i,1),o.caml_array_get(i,2),e[1][0],e[1][1],e[1][2],o.caml_array_get(i,0),o.caml_array_get(i,1),o.caml_array_get(i,2),e[2][0],e[2][1],e[2][2],o.caml_array_get(i,0),o.caml_array_get(i,1),o.caml_array_get(i,2),t[2][0],t[2][1],t[2][2],o.caml_array_get(i,0),o.caml_array_get(i,1),o.caml_array_get(i,2),e[0][0],e[0][1],e[0][2],o.caml_array_get(u,0),o.caml_array_get(u,1),o.caml_array_get(u,2),e[1][0],e[1][1],e[1][2],o.caml_array_get(u,0),o.caml_array_get(u,1),o.caml_array_get(u,2),t[1][0],t[1][1],t[1][2],o.caml_array_get(u,0),o.caml_array_get(u,1),o.caml_array_get(u,2),t[0][0],t[0][1],t[0][2],o.caml_array_get(u,0),o.caml_array_get(u,1),o.caml_array_get(u,2),e[0][0],e[0][1],e[0][2],o.caml_array_get(f,0),o.caml_array_get(f,1),o.caml_array_get(f,2),t[0][0],t[0][1],t[0][2],o.caml_array_get(f,0),o.caml_array_get(f,1),o.caml_array_get(f,2),t[3][0],t[3][1],t[3][2],o.caml_array_get(f,0),o.caml_array_get(f,1),o.caml_array_get(f,2),e[3][0],e[3][1],e[3][2],o.caml_array_get(f,0),o.caml_array_get(f,1),o.caml_array_get(f,2),e[2][0],e[2][1],e[2][2],o.caml_array_get(_,0),o.caml_array_get(_,1),o.caml_array_get(_,2),e[3][0],e[3][1],e[3][2],o.caml_array_get(_,0),o.caml_array_get(_,1),o.caml_array_get(_,2),t[3][0],t[3][1],t[3][2],o.caml_array_get(_,0),o.caml_array_get(_,1),o.caml_array_get(_,2),t[2][0],t[2][1],t[2][2],o.caml_array_get(_,0),o.caml_array_get(_,1),o.caml_array_get(_,2),e[0][0],e[0][1],e[0][2],o.caml_array_get(a,0),o.caml_array_get(a,1),o.caml_array_get(a,2),e[3][0],e[3][1],e[3][2],o.caml_array_get(a,0),o.caml_array_get(a,1),o.caml_array_get(a,2),e[2][0],e[2][1],e[2][2],o.caml_array_get(a,0),o.caml_array_get(a,1),o.caml_array_get(a,2),e[1][0],e[1][1],e[1][2],o.caml_array_get(a,0),o.caml_array_get(a,1),o.caml_array_get(a,2)]}var m=[function(r,t){return[r,t]},l,function(r,t,e){var a=t?t[0]:0,o=n.VertexBuffer[0](l(r),[["position",3],[["normal",3],0]],a),c=n.IndexBuffer[0](n.IndexBuffer[2](6),a);return i.SVertexObject[0](o,[c])}];t.Point=u,t.Quad=_,t.AreaBetweenQuads=m},function(r,t,e){"use strict";var n=e(4),a=e(5),i="\n    precision mediump float;\n    attribute vec2 position;\n    uniform mat3 translation;\n    uniform mat3 layout;\n    uniform mat3 sdfTilesMat;\n    varying vec2 vPosition;\n    varying vec2 vTexPos;\n    void main() {\n        vPosition = (vec3(position, 1.0) * translation).xy;\n        vec3 transformed = vec3(vPosition, 1.0) * layout;\n        vTexPos = (vec3(vPosition, 1.0) * sdfTilesMat).xy;\n        gl_Position = vec4(transformed.xy, 0.0, 1.0);\n    }\n",o="\n    precision mediump float;\n    varying vec2 vPosition;\n    varying vec2 vTexPos;\n\n    uniform vec3 elColor;\n    uniform sampler2D sdfTiles;\n\n    void main() {\n        vec3 sdfColor = texture2D(sdfTiles, vTexPos).xyz;\n        gl_FragColor = vec4(mix(elColor, sdfColor, 0.4), 1.0);\n    }\n";t.currElVertex=i,t.currElFragment=o,t.makeNode=function(r,t){return a.makeNode(["currEl"],0,[n.Shader[0](i)],[n.Shader[0](o)],0,0,0,[[["sdfTiles",a.SceneTex[0](0,0,t)],0]],0,[r[0]],[[["elColor",r[3]],[["translation",r[1]],0]]],0,0,0,0,0,0,0,0,0,0,0,0,0,0,[1],0,0,0,0,0,0)}},function(r,t,e){"use strict";var n=e(4),a=e(10),i=e(0),o=e(2),c="\n    precision mediump float;\n    attribute vec2 position;\n    uniform mat3 layout;\n    void main() {\n        vec2 pos = (vec3(position, 1.0) * layout).xy;\n        gl_Position = vec4(pos, 0.0, 1.0);\n    }\n",u="\n    precision mediump float;\n    uniform float elapsed;\n    const float stepSize = 5.0;\n    void main() {\n        float stepMod = mod(elapsed, stepSize * 3.0);\n        float r = smoothstep(0.0, stepSize, stepMod);\n        float g = smoothstep(stepSize, stepSize * 2.0, stepMod);\n        float b = smoothstep(stepSize * 2.0, stepSize * 3.0, stepMod);\n        gl_FragColor = vec4(r, g, b, 0.1);\n    }\n";t.vertexSource=c,t.fragmentSource=u,t.make=function(r){var t=i.__(5,[[a.Mat3[7](0)]]),e=i.__(0,[[0]]),f=n.Program[0](n.Shader[0](c),n.Shader[0](u),n.VertexBuffer[3](0),[n.Uniform[2]("layout",t),[n.Uniform[2]("elapsed",e),0]]),s=n.Program[3](f,r[0]);return[r,s?s[0]:o.failwith("Could not initialize stencilDraw"),t,e,n.VertexBuffer[8](n.VertexBuffer[4](0,0,0),r[0],r[1]),n.IndexBuffer[6](n.IndexBuffer[1](0),r[0],r[1])]},t.draw=function(r,t,e){return n.Uniform[10](r[2],t),n.Uniform[6](r[3],e),n.Canvas[13](r[0],r[1],r[4],r[5],[])}},function(r,t,e){"use strict";var n=e(4),a=e(2),i="\n    precision mediump float;\n    attribute vec2 position;\n    void main() {\n        gl_Position = vec4(position, 0.0, 1.0);\n    }\n",o="\n    precision mediump float;\n\n    void main() {\n        gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n    }\n";t.vertexSource=i,t.fragmentSource=o,t.make=function(r){var t=n.Program[0](n.Shader[0](i),n.Shader[0](o),n.VertexBuffer[3](0),0),e=n.Program[3](t,r[0]);return[r,e?e[0]:a.failwith("Could not initialize stencilDraw")]},t.draw=function(r,t,e){return n.Canvas[13](r[0],r[1],t,e,[])}},function(r,t,e){"use strict";function n(r,t,e,n){return[r,t,e,n]}var a=[n,function(){return[0,0,0,0]},function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]?+(r[3]===t[3]):0},function(r,t){return r[0]<=t[0]&&r[1]<=t[1]&&r[0]+r[2]>=t[0]+t[2]?+(r[1]+r[3]>=t[1]+t[3]):0},function(r,t){return t[0]<=r[0]+r[2]&&r[0]<=t[0]+t[2]&&t[1]<=r[1]+r[3]?+(r[1]<=t[1]+t[3]):0},function(r,t){var e=r[0]+r[2],a=r[1]+r[3],i=t[0]+t[2],o=t[1]+t[3],c=0!=+(e>i)?e:i,u=0!=+(a>o)?a:o;return r[0]<t[0]?r[1]<t[1]?n(r[0],r[1],c-r[0],u-r[1]):n(r[0],t[1],c-r[0],u-t[1]):r[1]<t[1]?n(t[0],r[1],c-t[0],u-r[1]):n(t[0],t[1],c-t[0],u-t[1])}];t.Rect=a},function(r,t,e){"use strict";var n=e(4),a=e(0),i=e(5),o="\n    precision mediump float;\n    attribute vec2 position;\n    void main() {\n        gl_Position = vec4(position, 0.0, 1.0);\n    }\n",c="\n    precision mediump float;\n    uniform float anim;\n\n    void main() {\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.5 * anim);\n    }\n";t.vertexSource=o,t.fragmentSource=c,t.makeNode=function(){return i.makeNode(["mask"],0,[n.Shader[0](o)],[n.Shader[0](c)],0,0,0,0,0,0,[[["anim",i.UFloat[0](0)],0]],0,0,0,[a.__(0,[a.__(0,[1]),a.__(0,[1])])],0,0,0,0,0,0,0,0,[1],0,0,[1],0,0,0,0,0)}},function(r,t,e){"use strict";var n=e(7),a=e(8);function i(r,t,e){var i=t[1],o=t[0],c=function(r){return[r[1],a.imul(r[0],-1)]},u=n.map(c,r),f=n.map(c,u),s=n.map(c,f),_=function(r){return[((r[0]-o|0)/2|0)-1|0,((r[1]-i|0)/-2|0)-1|0]};return[n.map(_,r),n.map(_,u),n.map(_,f),n.map(_,s),e]}var o=i([[-3,1],[[-1,1],[[1,1],[[3,1],0]]]],[1,1],2),c=i([[-2,2],[[-2,0],[[0,0],[[2,0],0]]]],[0,0],3),u=i([[-2,0],[[0,0],[[2,0],[[2,2],0]]]],[0,0],4),f=i([[-1,1],[[-1,-1],[[1,1],[[1,-1],0]]]],[1,1],5),s=i([[-2,0],[[0,0],[[0,2],[[2,2],0]]]],[0,0],6),_=i([[-2,0],[[0,0],[[0,2],[[2,0],0]]]],[0,0],7),l=i([[-2,2],[[0,2],[[0,0],[[2,0],0]]]],[0,0],8);t.make=i,t.lineTiles=o,t.leftLTiles=c,t.rightLTiles=u,t.cubeTiles=f,t.rightTurnTiles=s,t.triangleTiles=_,t.leftTurnTiles=l},function(r,t,e){"use strict";var n=e(9),a=e(17),i=e(3);function o(r,t){if(t<0||t>(r.length-20|0))throw[i.invalid_argument,"Marshal.data_size"];return a.not_implemented("caml_marshal_data_size not implemented by bucklescript yet\n")}function c(r,t){if(t<0||t>(r.length-20|0))throw[i.invalid_argument,"Marshal.from_bytes"];var e=a.not_implemented("caml_marshal_data_size not implemented by bucklescript yet\n");if(t>(r.length-(20+e|0)|0))throw[i.invalid_argument,"Marshal.from_bytes"];return a.not_implemented("caml_input_value_from_string not implemented by bucklescript yet\n")}t.to_channel=function(r,t,e){return a.not_implemented("caml_output_value not implemented by bucklescript yet\n")},t.to_buffer=function(r,t,e,n,o){if(t<0||e<0||t>(r.length-e|0))throw[i.invalid_argument,"Marshal.to_buffer: substring out of bounds"];return a.not_implemented("caml_output_value_to_buffer not implemented by bucklescript yet\n")},t.from_channel=function(){return a.not_implemented("caml_input_value not implemented by bucklescript yet\n")},t.from_bytes=c,t.from_string=function(r,t){return c(n.bytes_of_string(r),t)},t.header_size=20,t.data_size=o,t.total_size=function(r,t){return 20+o(r,t)|0}},function(r,t,e){"use strict";var n=e(73),a=e(6),i=e(17),o=e(3),c=a.caml_array_get,u=a.caml_array_set;function f(r){var t=void 0!==r.length&&248!=(0|r.tag)&&r.length>=1?r[0]:r;if(void 0===t.length||248!==t.tag)throw o.not_found;if(252===t[0].tag)return t;throw o.not_found}t.double_field=c,t.set_double_field=u,t.first_non_constant_constructor_tag=0,t.last_non_constant_constructor_tag=245,t.lazy_tag=246,t.closure_tag=247,t.object_tag=248,t.infix_tag=249,t.forward_tag=250,t.no_scan_tag=251,t.abstract_tag=251,t.string_tag=252,t.double_tag=253,t.double_array_tag=254,t.custom_tag=255,t.final_tag=255,t.int_tag=1e3,t.out_of_heap_tag=1001,t.unaligned_tag=1002,t.extension_name=function(r){try{return f(r)[0]}catch(r){throw r===o.not_found?[o.invalid_argument,"Obj.extension_name"]:r}},t.extension_id=function(r){try{return f(r)[1]}catch(r){throw r===o.not_found?[o.invalid_argument,"Obj.extension_id"]:r}},t.extension_slot=function(r){try{return f(r)}catch(r){throw r===o.not_found?[o.invalid_argument,"Obj.extension_slot"]:r}},t.marshal=function(){return i.not_implemented("caml_output_value_to_string not implemented by bucklescript yet\n")},t.unmarshal=function(r,t){return[n.from_bytes(r,t),t+n.total_size(r,t)|0]}},function(r,t,e){"use strict";var n=e(74),a=e(1),i=e(16).create("CamlinternalLazy.Undefined");function o(){throw i}function c(r){var t=r[0];r[0]=o;try{var e=a._1(t,0);return r[0]=e,r.tag=n.forward_tag,e}catch(t){throw r[0]=function(){throw t},t}}function u(r){var t=r[0];r[0]=o;var e=a._1(t,0);return r[0]=e,r.tag=n.forward_tag,e}t.Undefined=i,t.force_lazy_block=c,t.force_val_lazy_block=u,t.force=function(r){var t=0|r.tag;return t===n.forward_tag?r[0]:t!==n.lazy_tag?r:c(r)},t.force_val=function(r){var t=0|r.tag;return t===n.forward_tag?r[0]:t!==n.lazy_tag?r:u(r)}},function(r,t,e){"use strict";t.create=function(){return[0,0]},t.push=function(r,t){if(t[0]){var e=t[1],n=[r,e[1]];return t[0]=t[0]+1|0,e[1]=n,t[1]=n,0}var a=[];return a[0]=r,a[1]=a,t[0]=1,t[1]=a,0},t.unsafe_pop=function(r){r[0]=r[0]-1|0;var t=r[1],e=t[1];return e===t?r[1]=0:t[1]=e[1],e[0]},t.is_empty=function(r){return+(0===r[0])}},function(r,t,e){"use strict";var n=e(8),a=e(76),i=e(3);function o(r,t){return r<<t|r>>>(32-t|0)}function c(r,t){var e=t;e=o(e=n.imul(e,3432918353),15);var a=r^(e=n.imul(e,461845907));return 3864292196+((a=o(a,13))+(a<<2)|0)|0}function u(r){var t=r^r>>>16;return t=n.imul(t,2246822507),t^=t>>>13,(t=n.imul(t,3266489909))^t>>>16}function f(r,t){for(var e=t.length,n=(e/4|0)-1|0,a=r,i=0;i<=n;++i){var o=i<<2;a=c(a,t.charCodeAt(o)|t.charCodeAt(o+1|0)<<8|t.charCodeAt(o+2|0)<<16|t.charCodeAt(o+3|0)<<24)}var u=3&e;return 0!==u&&(a=c(a,3===u?t.charCodeAt(e-1|0)<<16|t.charCodeAt(e-2|0)<<8|t.charCodeAt(e-3|0):2===u?t.charCodeAt(e-1|0)<<8|t.charCodeAt(e-2|0):t.charCodeAt(e-1|0))),a^e}t.caml_hash_mix_int=c,t.caml_hash_mix_string=f,t.caml_hash_final_mix=u,t.caml_hash=function(r,t,e,n){var o=e;if("number"==typeof n){var s=0|n;return u(o=c(o,1+(s+s|0)|0))}if("string"==typeof n)return u(o=f(o,n));var _=[0,0],l=r;for(a.push(n,_),l=l-1|0;0!==_[0]&&l>0;){var m=a.unsafe_pop(_);if("number"==typeof m){var v=0|m;o=c(o,1+(v+v|0)|0),l=l-1|0}else if("string"==typeof m)o=f(o,m),l=l-1|0;else if("boolean"!=typeof m&&void 0!==m){if("symbol"==typeof m)throw[i.assert_failure,["caml_hash.ml",135,8]];if("function"!=typeof m){var d=m.length;if(void 0!==d){var g=d<<10|0|m.tag;if(248===g)o=c(o,m[1]);else{o=c(o,g);for(var h=d-1|0,y=h<l?h:l,p=0;p<=y;++p)a.push(m[p],_)}}}}}return u(o)}},function(r,t,e){"use strict";var n=e(11),a=e(18),i=n.caml_nativeint_compare;t.zero=0,t.one=1,t.minus_one=-1,t.succ=function(r){return r+1},t.pred=function(r){return r-1},t.abs=function(r){return r>=0?r:-r},t.size=54,t.max_int=9007199254740991,t.min_int=-9007199254740991,t.lognot=function(r){return-1^r},t.to_string=function(r){return a.caml_nativeint_format("%d",r)},t.compare=i},function(r,t,e){"use strict";function n(r,t,e,n,a,i){var o=((t+r|0)+n|0)+i|0;return(o<<a|o>>>(32-a|0)|0)+e|0}function a(r,t,e,a,i,o,c){return n(t&e|(-1^t)&a,r,t,i,o,c)}function i(r,t,e,a,i,o,c){return n(t&a|e&(-1^a),r,t,i,o,c)}function o(r,t,e,a,i,o,c){return n(t^e^a,r,t,i,o,c)}function c(r,t,e,a,i,o,c){return n(e^(t|-1^a),r,t,i,o,c)}function u(r,t){var e=r[0],n=r[1],u=r[2],f=r[3];return n=c(n=c(n=c(n=c(n=o(n=o(n=o(n=o(n=i(n=i(n=i(n=i(n=a(n=a(n=a(n=a(n,u=a(u,f=a(f,e=a(e,n,u,f,t[0],7,-680876936),n,u,t[1],12,-389564586),e,n,t[2],17,606105819),f,e,t[3],22,-1044525330),u=a(u,f=a(f,e=a(e,n,u,f,t[4],7,-176418897),n,u,t[5],12,1200080426),e,n,t[6],17,-1473231341),f,e,t[7],22,-45705983),u=a(u,f=a(f,e=a(e,n,u,f,t[8],7,1770035416),n,u,t[9],12,-1958414417),e,n,t[10],17,-42063),f,e,t[11],22,-1990404162),u=a(u,f=a(f,e=a(e,n,u,f,t[12],7,1804603682),n,u,t[13],12,-40341101),e,n,t[14],17,-1502002290),f,e,t[15],22,1236535329),u=i(u,f=i(f,e=i(e,n,u,f,t[1],5,-165796510),n,u,t[6],9,-1069501632),e,n,t[11],14,643717713),f,e,t[0],20,-373897302),u=i(u,f=i(f,e=i(e,n,u,f,t[5],5,-701558691),n,u,t[10],9,38016083),e,n,t[15],14,-660478335),f,e,t[4],20,-405537848),u=i(u,f=i(f,e=i(e,n,u,f,t[9],5,568446438),n,u,t[14],9,-1019803690),e,n,t[3],14,-187363961),f,e,t[8],20,1163531501),u=i(u,f=i(f,e=i(e,n,u,f,t[13],5,-1444681467),n,u,t[2],9,-51403784),e,n,t[7],14,1735328473),f,e,t[12],20,-1926607734),u=o(u,f=o(f,e=o(e,n,u,f,t[5],4,-378558),n,u,t[8],11,-2022574463),e,n,t[11],16,1839030562),f,e,t[14],23,-35309556),u=o(u,f=o(f,e=o(e,n,u,f,t[1],4,-1530992060),n,u,t[4],11,1272893353),e,n,t[7],16,-155497632),f,e,t[10],23,-1094730640),u=o(u,f=o(f,e=o(e,n,u,f,t[13],4,681279174),n,u,t[0],11,-358537222),e,n,t[3],16,-722521979),f,e,t[6],23,76029189),u=o(u,f=o(f,e=o(e,n,u,f,t[9],4,-640364487),n,u,t[12],11,-421815835),e,n,t[15],16,530742520),f,e,t[2],23,-995338651),u=c(u,f=c(f,e=c(e,n,u,f,t[0],6,-198630844),n,u,t[7],10,1126891415),e,n,t[14],15,-1416354905),f,e,t[5],21,-57434055),u=c(u,f=c(f,e=c(e,n,u,f,t[12],6,1700485571),n,u,t[3],10,-1894986606),e,n,t[10],15,-1051523),f,e,t[1],21,-2054922799),u=c(u,f=c(f,e=c(e,n,u,f,t[8],6,1873313359),n,u,t[15],10,-30611744),e,n,t[6],15,-1560198380),f,e,t[13],21,1309151649),u=c(u,f=c(f,e=c(e,n,u,f,t[4],6,-145523070),n,u,t[11],10,-1120210379),e,n,t[2],15,718787259),f,e,t[9],21,-343485551),r[0]=e+r[0]|0,r[1]=n+r[1]|0,r[2]=u+r[2]|0,r[3]=f+r[3]|0,0}var f=[1732584193,-271733879,-1732584194,271733878],s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];t.caml_md5_string=function(r,t,e){var n=r.slice(t,e),a=n.length;f[0]=1732584193,f[1]=-271733879,f[2]=-1732584194,f[3]=271733878;for(var i=0;i<=15;++i)s[i]=0;for(var o=a/64|0,c=1;c<=o;++c){for(var _=0;_<=15;++_){var l=((c<<6)-64|0)+(_<<2)|0;s[_]=((n.charCodeAt(l)+(n.charCodeAt(l+1|0)<<8)|0)+(n.charCodeAt(l+2|0)<<16)|0)+(n.charCodeAt(l+3|0)<<24)|0}u(f,s)}for(var m=n.slice(o<<6),v=0;v<=15;++v)s[v]=0;for(var d=m.length-1|0,g=0;g<=d;++g)s[g/4|0]=s[g/4|0]|m.charCodeAt(g)<<(g%4<<3);var h=d+1|0;if(s[h/4|0]=s[h/4|0]|128<<(h%4<<3),h>55){u(f,s);for(var y=0;y<=15;++y)s[y]=0}return s[14]=a<<3,u(f,s),String.fromCharCode(255&f[0],f[0]>>8&255,f[0]>>16&255,f[0]>>24&255,255&f[1],f[1]>>8&255,f[1]>>16&255,f[1]>>24&255,255&f[2],f[2]>>8&255,f[2]>>16&255,f[2]>>24&255,255&f[3],f[3]>>8&255,f[3]>>16&255,f[3]>>24&255)}},function(r,t,e){"use strict";var n=e(20),a=e(15),i=e(79),o=e(2),c=e(9),u=e(17),f=e(3);function s(r){return i.caml_md5_string(r,0,r.length)}function _(r,t,e){if(t<0||e<0||t>(r.length-e|0))throw[f.invalid_argument,"Digest.substring"];return i.caml_md5_string(r,t,e)}var l=o.output_string;function m(r){return r+(r<10?48:87)|0}var v=a.compare;t.compare=v,t.string=s,t.bytes=function(r){return s(c.bytes_to_string(r))},t.substring=_,t.subbytes=function(r,t,e){return _(c.bytes_to_string(r),t,e)},t.file=function(r){o.open_in_bin(r);var t,e=0;try{t=u.not_implemented("caml_md5_chan not implemented by bucklescript yet\n"),e=1}catch(r){throw u.not_implemented("caml_ml_close_channel not implemented by bucklescript yet\n"),r}if(1===e)return u.not_implemented("caml_ml_close_channel not implemented by bucklescript yet\n"),t},t.output=l,t.input=function(r){return o.really_input_string(r,16)},t.to_hex=function(r){for(var t=new Array(32),e=0;e<=15;++e){var n=c.get(r,e);t[e<<1]=m(n>>>4),t[1+(e<<1)|0]=m(15&n)}return c.bytes_to_string(t)},t.from_hex=function(r){if(32!==r.length)throw[f.invalid_argument,"Digest.from_hex"];for(var t=function(r){if(r>=65){if(r>=97){if(r>=103)throw[f.invalid_argument,"Digest.from_hex"];return 10+(r-97|0)|0}if(r>=71)throw[f.invalid_argument,"Digest.from_hex"];return 10+(r-65|0)|0}if(r>57||r<48)throw[f.invalid_argument,"Digest.from_hex"];return r-48|0},e=function(e){return(t(c.get(r,e))<<4)+t(c.get(r,e+1|0))|0},a=new Array(16),i=0;i<=15;++i)a[i]=n.chr(e(i<<1));return c.bytes_to_string(a)}},function(r,t,e){"use strict";var n=e(27),a=e(18),i=n.compare;t.zero=[0,0],t.one=[0,1],t.minus_one=[-1,4294967295],t.succ=function(r){return n.add(r,[0,1])},t.pred=function(r){return n.sub(r,[0,1])},t.abs=function(r){return n.ge(r,[0,0])?r:n.neg(r)},t.max_int=[2147483647,4294967295],t.min_int=[-2147483648,0],t.lognot=function(r){return n.xor(r,[-1,4294967295])},t.to_string=function(r){return a.caml_int64_format("%d",r)},t.compare=i},function(r,t,e){"use strict";var n=e(11),a=e(18),i=n.caml_int32_compare;t.zero=0,t.one=1,t.minus_one=-1,t.succ=function(r){return r+1|0},t.pred=function(r){return r-1|0},t.abs=function(r){return r>=0?r:0|-r},t.max_int=2147483647,t.min_int=-2147483648,t.lognot=function(r){return-1^r},t.to_string=function(r){return a.caml_int32_format("%d",r)},t.compare=i},function(r,t,e){"use strict";var n=e(3);t.get=function(r,t){if(t<0||t>=r.length)throw[n.invalid_argument,"index out of bounds"];return r[t]}},function(r,t,e){"use strict";var n=e(20),a=e(0),i=e(24),o=e(1),c=e(36),u=e(40),f=e(15),s=e(45),_=e(11),l=e(83),m=e(35),v=e(8),d=e(2),g=e(18),h=e(9),y=e(16),p=e(3),b=e(41);function w(r,t){var e=t>>>3,n=1<<(7&t);return r[e]=d.char_of_int(l.get(r,e)|n),0}var x=i.to_string;function k(r){for(var t=i.make(32,0),e=0;e<=31;++e)t[e]=d.char_of_int(255^h.get(r,e));return h.bytes_to_string(t)}function M(r,t){var e=t>>>3,n=1<<(7&t);return+(0!=(h.get(r,e)&n))}function S(r){return r?a.__(0,[1,r[0]]):0}function C(r,t){if("number"==typeof r)switch(r){case 0:return[a.__(0,[t])];case 1:return[a.__(1,[t])];case 2:return[a.__(9,[t])];case 3:return[a.__(19,[t])];case 4:return[a.__(22,[t])]}else switch(0|r.tag){case 0:return[a.__(2,[S(r[0]),t])];case 1:return[a.__(3,[S(r[0]),t])];case 2:return[a.__(4,[r[0],S(r[1]),0,t])];case 3:return[a.__(5,[r[0],S(r[1]),0,t])];case 4:return[a.__(6,[r[0],S(r[1]),0,t])];case 5:return[a.__(7,[r[0],S(r[1]),0,t])];case 6:return[a.__(8,[0,S(r[0]),(e=r[1],e?[e[0]]:0),t])];case 7:return[a.__(13,[r[0],r[1],t])];case 8:return[a.__(14,[r[0],r[1],t])];case 9:return[a.__(20,[r[0],r[1],t])];case 10:return[a.__(21,[r[0],t])]}var e}function P(r,t){var e=r[1].length,n=r[0]+t|0;if(n>e){var a=d.max(e<<1,n),o=h.caml_create_string(a);return i.blit(r[1],0,o,0,e),r[1]=o,0}return 0}function T(r,t){return P(r,1),r[1][r[0]]=t,r[0]=r[0]+1|0,0}function A(r,t){var e=t.length;return P(r,e),f.blit(t,0,r[1],r[0],e),r[0]=r[0]+e|0,0}function D(r){return i.sub_string(r[1],0,r[0])}function V(r){switch(r){case 0:case 1:case 2:return 100;case 3:case 4:case 5:return 105;case 6:case 7:return 120;case 8:case 9:return 88;case 10:case 11:return 111;case 12:return 117}}function U(r){switch(r){case 0:case 1:case 2:return 102;case 3:case 4:case 5:return 101;case 6:case 7:case 8:return 69;case 9:case 10:case 11:return 103;case 12:case 13:case 14:return 71;case 15:return 70}}function N(r){switch(r){case 0:return 108;case 1:return 110;case 2:return 78}}function L(r,t){var e,a,i=function(r,t){var e=d.char_of_int(t);return 37!==e?64!==e?T(r,e):(T(r,37),T(r,64)):(T(r,37),T(r,37))},o=function(t,e){for(;;){var n=e;if(!(n<256))return 0;if(M(t,d.char_of_int(n))){var a=t,u=n,f=d.char_of_int(u)-45|0;return f>48||f<0?f>=210?i(r,255):c(a,u+1|0):f>47||f<1?o(a,u+1|0):c(a,u+1|0)}e=n+1|0}},c=function(t,e){if(!M(t,d.char_of_int(e)))return i(r,e-1|0),o(t,e+1|0);var n=0,a=d.char_of_int(e)-45|0;if(a>48||a<0){if(a>=210)return i(r,254),i(r,255);n=1}else if(a>47||a<1){if(!M(t,d.char_of_int(e+1|0)))return i(r,e-1|0),o(t,e+1|0);n=1}else n=1;if(1===n){if(!M(t,d.char_of_int(e+1|0)))return i(r,e-1|0),i(r,e),o(t,e+2|0);for(var c=t,u=e-1|0,f=e+2|0;;){var s=f;if(256===s||!M(c,d.char_of_int(s)))return i(r,u),i(r,45),i(r,s-1|0),s<256?o(c,s+1|0):0;f=s+1|0}}};return T(r,91),e=M(t,0)?(T(r,94),k(t)):t,(a=function(r){var t=n.chr(r-1|0),a=n.chr(r+1|0);return M(e,r)?1-(M(e,t)&&M(e,a)):0})(93)&&T(r,93),o(e,1),a(45)&&T(r,45),T(r,93)}function B(r,t){return t?T(r,95):0}function F(r,t){return t?A(r,""+t[0]):0}function I(r,t){return"number"==typeof t?0:(function(r,t){switch(t){case 0:return T(r,45);case 1:return 0;case 2:T(r,48)}}(r,t[0]),t.tag?T(r,42):A(r,""+t[1]))}function z(r,t){return"number"==typeof t?0!==t?A(r,".*"):0:(T(r,46),A(r,""+t[0]))}function E(r,t){switch(t){case 1:case 4:return T(r,43);case 2:case 5:return T(r,32);case 7:case 9:case 11:return T(r,35);case 0:case 3:case 6:case 8:case 10:case 12:return 0}}function q(r,t,e,n,a){return T(r,37),B(r,t),E(r,e),I(r,n),z(r,a),T(r,V(e))}function R(r,t,e,n,a,i){return T(r,37),B(r,t),E(r,e),I(r,n),z(r,a),T(r,i),T(r,V(e))}function G(r,t){switch(t){case 1:case 4:case 7:case 10:case 13:return T(r,43);case 2:case 5:case 8:case 11:case 14:return T(r,32);case 0:case 3:case 6:case 9:case 12:case 15:return 0}}function H(r,t,e,n,a){return T(r,37),B(r,t),G(r,e),I(r,n),z(r,a),T(r,U(e))}function O(r){if("number"==typeof r)switch(r){case 0:return"@]";case 1:return"@}";case 2:return"@?";case 3:return"@\n";case 4:return"@.";case 5:return"@@";case 6:return"@%"}else switch(0|r.tag){case 0:case 1:return r[0];case 2:return"@"+h.bytes_to_string(i.make(1,r[0]))}}function K(r){return r[0][1]}function j(r,t){return 37!==t?T(r,t):A(r,"%%")}function W(r,t){for(var e=0,n=t.length-1|0;e<=n;++e)j(r,h.get(t,e));return 0}function $(r,t){for(;;){var e=t;if("number"==typeof e)return 0;switch(0|e.tag){case 0:A(r,"%c"),t=e[0];continue;case 1:A(r,"%s"),t=e[0];continue;case 2:A(r,"%i"),t=e[0];continue;case 3:A(r,"%li"),t=e[0];continue;case 4:A(r,"%ni"),t=e[0];continue;case 5:A(r,"%Li"),t=e[0];continue;case 6:A(r,"%f"),t=e[0];continue;case 7:A(r,"%B"),t=e[0];continue;case 8:A(r,"%{"),$(r,e[0]),A(r,"%}"),t=e[1];continue;case 9:A(r,"%("),$(r,e[0]),A(r,"%)"),t=e[2];continue;case 10:A(r,"%a"),t=e[0];continue;case 11:A(r,"%t"),t=e[0];continue;case 12:A(r,"%?"),t=e[0];continue;case 13:A(r,"%r"),t=e[0];continue;case 14:A(r,"%_r"),t=e[0];continue}}}function X(r){return r?1+X(r[0])|0:0}function Q(r){if("number"==typeof r)return 0;switch(0|r.tag){case 0:return a.__(0,[Q(r[0])]);case 1:return a.__(1,[Q(r[0])]);case 2:return a.__(2,[Q(r[0])]);case 3:return a.__(3,[Q(r[0])]);case 4:return a.__(4,[Q(r[0])]);case 5:return a.__(5,[Q(r[0])]);case 6:return a.__(6,[Q(r[0])]);case 7:return a.__(7,[Q(r[0])]);case 8:return a.__(8,[r[0],Q(r[1])]);case 9:return a.__(9,[r[1],r[0],Q(r[2])]);case 10:return a.__(10,[Q(r[0])]);case 11:return a.__(11,[Q(r[0])]);case 12:return a.__(12,[Q(r[0])]);case 13:return a.__(13,[Q(r[0])]);case 14:return a.__(14,[Q(r[0])])}}function Y(r){if("number"==typeof r)return[function(){return 0},function(){return 0},function(){return 0},function(){return 0}];switch(0|r.tag){case 0:var t=Y(r[0]),e=t[1],n=t[0];return[function(){return o._1(n,0),0},function(){return o._1(e,0),0},t[2],t[3]];case 1:var a=Y(r[0]),i=a[1],c=a[0];return[function(){return o._1(c,0),0},function(){return o._1(i,0),0},a[2],a[3]];case 2:var u=Y(r[0]),f=u[1],s=u[0];return[function(){return o._1(s,0),0},function(){return o._1(f,0),0},u[2],u[3]];case 3:var _=Y(r[0]),l=_[1],m=_[0];return[function(){return o._1(m,0),0},function(){return o._1(l,0),0},_[2],_[3]];case 4:var v=Y(r[0]),d=v[1],g=v[0];return[function(){return o._1(g,0),0},function(){return o._1(d,0),0},v[2],v[3]];case 5:var h=Y(r[0]),y=h[1],p=h[0];return[function(){return o._1(p,0),0},function(){return o._1(y,0),0},h[2],h[3]];case 6:var b=Y(r[0]),w=b[1],x=b[0];return[function(){return o._1(x,0),0},function(){return o._1(w,0),0},b[2],b[3]];case 7:var k=Y(r[0]),M=k[1],S=k[0];return[function(){return o._1(S,0),0},function(){return o._1(M,0),0},k[2],k[3]];case 8:var C=Y(r[1]),P=C[1],T=C[0];return[function(){return o._1(T,0),0},function(){return o._1(P,0),0},C[2],C[3]];case 9:var A=Y(r[2]),D=A[3],V=A[2],U=A[1],N=A[0],L=Y(Z(Q(r[0]),r[1])),B=L[3],F=L[2],I=L[1],z=L[0];return[function(){return o._1(N,0),o._1(z,0),0},function(){return o._1(I,0),o._1(U,0),0},function(){return o._1(V,0),o._1(F,0),0},function(){return o._1(B,0),o._1(D,0),0}];case 10:var E=Y(r[0]),q=E[1],R=E[0];return[function(){return o._1(R,0),0},function(){return o._1(q,0),0},E[2],E[3]];case 11:var G=Y(r[0]),H=G[1],O=G[0];return[function(){return o._1(O,0),0},function(){return o._1(H,0),0},G[2],G[3]];case 12:var K=Y(r[0]),j=K[1],W=K[0];return[function(){return o._1(W,0),0},function(){return o._1(j,0),0},K[2],K[3]];case 13:var $=Y(r[0]),X=$[3],J=$[2],rr=$[1],tr=$[0];return[function(){return o._1(tr,0),0},function(){return o._1(rr,0),0},function(){return o._1(J,0),0},function(){return o._1(X,0),0}];case 14:var er=Y(r[0]),nr=er[3],ar=er[2],ir=er[1],or=er[0];return[function(){return o._1(or,0),0},function(){return o._1(ir,0),0},function(){return o._1(ar,0),0},function(){return o._1(nr,0),0}]}}function Z(r,t){var e=0;if("number"==typeof r){if("number"==typeof t)return 0;switch(0|t.tag){case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5;break;default:throw[p.assert_failure,["camlinternalFormat.ml",816,23]]}}else switch(0|r.tag){case 0:if("number"==typeof t)e=8;else switch(0|t.tag){case 0:return a.__(0,[Z(r[0],t[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 1:if("number"==typeof t)e=8;else switch(0|t.tag){case 1:return a.__(1,[Z(r[0],t[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 2:if("number"==typeof t)e=8;else switch(0|t.tag){case 2:return a.__(2,[Z(r[0],t[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 3:if("number"==typeof t)e=8;else switch(0|t.tag){case 3:return a.__(3,[Z(r[0],t[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 4:if("number"==typeof t)e=8;else switch(0|t.tag){case 4:return a.__(4,[Z(r[0],t[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 5:if("number"==typeof t)e=8;else switch(0|t.tag){case 5:return a.__(5,[Z(r[0],t[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 6:if("number"==typeof t)e=8;else switch(0|t.tag){case 6:return a.__(6,[Z(r[0],t[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 7:if("number"==typeof t)e=8;else switch(0|t.tag){case 7:return a.__(7,[Z(r[0],t[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 8:if("number"==typeof t)throw[p.assert_failure,["camlinternalFormat.ml",802,26]];switch(0|t.tag){case 8:return a.__(8,[Z(r[0],t[0]),Z(r[1],t[1])]);case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5;break;default:throw[p.assert_failure,["camlinternalFormat.ml",802,26]]}break;case 9:if("number"==typeof t)throw[p.assert_failure,["camlinternalFormat.ml",812,28]];switch(0|t.tag){case 8:e=6;break;case 9:var n=Y(Z(Q(r[1]),t[0]));return o._1(n[1],0),o._1(n[3],0),a.__(9,[r[0],t[1],Z(r[2],t[2])]);case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5;break;default:throw[p.assert_failure,["camlinternalFormat.ml",812,28]]}break;case 10:if("number"==typeof t)throw[p.assert_failure,["camlinternalFormat.ml",780,21]];if(10===t.tag)return a.__(10,[Z(r[0],t[0])]);throw[p.assert_failure,["camlinternalFormat.ml",780,21]];case 11:if("number"==typeof t)throw[p.assert_failure,["camlinternalFormat.ml",784,21]];switch(0|t.tag){case 10:e=1;break;case 11:return a.__(11,[Z(r[0],t[0])]);default:throw[p.assert_failure,["camlinternalFormat.ml",784,21]]}break;case 12:if("number"==typeof t)throw[p.assert_failure,["camlinternalFormat.ml",788,19]];switch(0|t.tag){case 10:e=1;break;case 11:e=2;break;case 12:return a.__(12,[Z(r[0],t[0])]);default:throw[p.assert_failure,["camlinternalFormat.ml",788,19]]}break;case 13:if("number"==typeof t)throw[p.assert_failure,["camlinternalFormat.ml",792,22]];switch(0|t.tag){case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:return a.__(13,[Z(r[0],t[0])]);default:throw[p.assert_failure,["camlinternalFormat.ml",792,22]]}break;case 14:if("number"==typeof t)throw[p.assert_failure,["camlinternalFormat.ml",797,30]];switch(0|t.tag){case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:return a.__(14,[Z(r[0],t[0])]);default:throw[p.assert_failure,["camlinternalFormat.ml",797,30]]}}switch(e){case 1:throw[p.assert_failure,["camlinternalFormat.ml",781,21]];case 2:throw[p.assert_failure,["camlinternalFormat.ml",785,21]];case 3:throw[p.assert_failure,["camlinternalFormat.ml",789,19]];case 4:throw[p.assert_failure,["camlinternalFormat.ml",793,22]];case 5:throw[p.assert_failure,["camlinternalFormat.ml",798,30]];case 6:throw[p.assert_failure,["camlinternalFormat.ml",803,26]];case 7:throw[p.assert_failure,["camlinternalFormat.ml",813,28]];case 8:throw[p.assert_failure,["camlinternalFormat.ml",817,23]]}}function J(r){for(;;){var t=r,e=0;if("number"==typeof t)return 0;switch(0|t.tag){case 2:case 3:e=1;break;case 4:var n=J(t[3]),i=er(t[2],a.__(2,[n]));return tr(t[1],i);case 5:var o=J(t[3]),c=er(t[2],a.__(3,[o]));return tr(t[1],c);case 6:var u=J(t[3]),f=er(t[2],a.__(4,[u]));return tr(t[1],f);case 7:var s=J(t[3]),_=er(t[2],a.__(5,[s]));return tr(t[1],_);case 8:var l=J(t[3]),m=er(t[2],a.__(6,[l]));return tr(t[1],m);case 9:return a.__(7,[J(t[0])]);case 10:r=t[0];continue;case 13:return a.__(8,[t[1],J(t[2])]);case 14:var v=t[1];return a.__(9,[v,v,J(t[2])]);case 15:return a.__(10,[J(t[0])]);case 16:return a.__(11,[J(t[0])]);case 11:case 12:case 17:r=t[1];continue;case 18:return b.concat_fmtty(J(t[0][0][0]),J(t[1]));case 19:return a.__(13,[J(t[0])]);case 20:return a.__(1,[J(t[2])]);case 21:return a.__(2,[J(t[1])]);case 23:var d=t[0],g=t[1];return"number"==typeof d?3===d?a.__(14,[J(g)]):J(g):8===d.tag?b.concat_fmtty(d[1],J(g)):J(g);case 24:return rr(t[0],J(t[2]));default:return a.__(0,[J(t[0])])}if(1===e)return tr(t[0],a.__(1,[J(t[1])]))}}function rr(r,t){return r?a.__(12,[rr(r[0],t)]):t}function tr(r,t){return"number"!=typeof r&&r.tag?a.__(2,[t]):t}function er(r,t){return"number"==typeof r&&0!==r?a.__(2,[t]):t}var nr=y.create("CamlinternalFormat.Type_mismatch");function ar(r,t){if("number"==typeof r)return[0,t];if(r.tag){if("number"==typeof t)throw nr;if(2===t.tag)return[a.__(1,[r[0]]),t[0]];throw nr}return[a.__(0,[r[0],r[1]]),t]}function ir(r,t,e){var n=ar(r,e);if("number"==typeof t){if(0!==t){var a=n[1];if("number"==typeof a)throw nr;if(2===a.tag)return[n[0],1,a[0]];throw nr}return[n[0],0,n[1]]}return[n[0],[t[0]],n[1]]}function or(r,t,e){var n=cr(t,e);return[a.__(23,[r,n[0]]),n[1]]}function cr(r,t){if("number"==typeof r)return[0,t];switch(0|r.tag){case 0:if("number"==typeof t)throw nr;if(t.tag)throw nr;var e=cr(r[0],t[0]);return[a.__(0,[e[0]]),e[1]];case 1:if("number"==typeof t)throw nr;if(t.tag)throw nr;var n=cr(r[0],t[0]);return[a.__(1,[n[0]]),n[1]];case 2:var i=ar(r[0],t),c=i[1];if("number"==typeof c)throw nr;if(1===c.tag){var u=cr(r[1],c[0]);return[a.__(2,[i[0],u[0]]),u[1]]}throw nr;case 3:var f=ar(r[0],t),s=f[1];if("number"==typeof s)throw nr;if(1===s.tag){var l=cr(r[1],s[0]);return[a.__(3,[f[0],l[0]]),l[1]]}throw nr;case 4:var m=ir(r[1],r[2],t),v=m[2];if("number"==typeof v)throw nr;if(2===v.tag){var d=cr(r[3],v[0]);return[a.__(4,[r[0],m[0],m[1],d[0]]),d[1]]}throw nr;case 5:var g=ir(r[1],r[2],t),h=g[2];if("number"==typeof h)throw nr;if(3===h.tag){var y=cr(r[3],h[0]);return[a.__(5,[r[0],g[0],g[1],y[0]]),y[1]]}throw nr;case 6:var p=ir(r[1],r[2],t),w=p[2];if("number"==typeof w)throw nr;if(4===w.tag){var x=cr(r[3],w[0]);return[a.__(6,[r[0],p[0],p[1],x[0]]),x[1]]}throw nr;case 7:var k=ir(r[1],r[2],t),M=k[2];if("number"==typeof M)throw nr;if(5===M.tag){var S=cr(r[3],M[0]);return[a.__(7,[r[0],k[0],k[1],S[0]]),S[1]]}throw nr;case 8:var C=ir(r[1],r[2],t),P=C[2];if("number"==typeof P)throw nr;if(6===P.tag){var T=cr(r[3],P[0]);return[a.__(8,[r[0],C[0],C[1],T[0]]),T[1]]}throw nr;case 9:if("number"==typeof t)throw nr;if(7===t.tag){var A=cr(r[0],t[0]);return[a.__(9,[A[0]]),A[1]]}throw nr;case 10:var D=cr(r[0],t);return[a.__(10,[D[0]]),D[1]];case 11:var V=cr(r[1],t);return[a.__(11,[r[0],V[0]]),V[1]];case 12:var U=cr(r[1],t);return[a.__(12,[r[0],U[0]]),U[1]];case 13:if("number"==typeof t)throw nr;if(8===t.tag){var N=t[0];if(_.caml_notequal([r[1]],[N]))throw nr;var L=cr(r[2],t[1]);return[a.__(13,[r[0],N,L[0]]),L[1]]}throw nr;case 14:if("number"==typeof t)throw nr;if(9===t.tag){var B=t[0];if(_.caml_notequal([b.erase_rel(r[1])],[b.erase_rel(B)]))throw nr;var F=cr(r[2],b.erase_rel(t[2]));return[a.__(14,[r[0],B,F[0]]),F[1]]}throw nr;case 15:if("number"==typeof t)throw nr;if(10===t.tag){var I=cr(r[0],t[0]);return[a.__(15,[I[0]]),I[1]]}throw nr;case 16:if("number"==typeof t)throw nr;if(11===t.tag){var z=cr(r[0],t[0]);return[a.__(16,[z[0]]),z[1]]}throw nr;case 17:var E=cr(r[1],t);return[a.__(17,[r[0],E[0]]),E[1]];case 18:var q=r[0],R=r[1],G=t;if(q.tag){var H=q[0],O=cr(H[0],G),K=cr(R,O[1]);return[a.__(18,[a.__(1,[[O[0],H[1]]]),K[0]]),K[1]]}var j=q[0],W=cr(j[0],G),$=cr(R,W[1]);return[a.__(18,[a.__(0,[[W[0],j[1]]]),$[0]]),$[1]];case 19:if("number"==typeof t)throw nr;if(13===t.tag){var X=cr(r[0],t[0]);return[a.__(19,[X[0]]),X[1]]}throw nr;case 20:if("number"==typeof t)throw nr;if(1===t.tag){var J=cr(r[2],t[0]);return[a.__(20,[r[0],r[1],J[0]]),J[1]]}throw nr;case 21:if("number"==typeof t)throw nr;if(2===t.tag){var rr=cr(r[1],t[0]);return[a.__(21,[r[0],rr[0]]),rr[1]]}throw nr;case 23:var tr=r[0],er=r[1],ur=t;if("number"==typeof tr){if(3===tr){if("number"==typeof ur)throw nr;if(14===ur.tag){var fr=cr(er,ur[0]);return[a.__(23,[3,fr[0]]),fr[1]]}throw nr}return or(tr,er,ur)}switch(0|tr.tag){case 7:return or(a.__(7,[tr[0],tr[1]]),er,ur);case 8:var sr=function r(t,e,n){if("number"==typeof t)return[0,cr(e,n)];switch(0|t.tag){case 0:if("number"==typeof n)throw nr;if(n.tag)throw nr;var i=r(t[0],e,n[0]);return[a.__(0,[i[0]]),i[1]];case 1:if("number"==typeof n)throw nr;if(1===n.tag){var c=r(t[0],e,n[0]);return[a.__(1,[c[0]]),c[1]]}throw nr;case 2:if("number"==typeof n)throw nr;if(2===n.tag){var u=r(t[0],e,n[0]);return[a.__(2,[u[0]]),u[1]]}throw nr;case 3:if("number"==typeof n)throw nr;if(3===n.tag){var f=r(t[0],e,n[0]);return[a.__(3,[f[0]]),f[1]]}throw nr;case 4:if("number"==typeof n)throw nr;if(4===n.tag){var s=r(t[0],e,n[0]);return[a.__(4,[s[0]]),s[1]]}throw nr;case 5:if("number"==typeof n)throw nr;if(5===n.tag){var l=r(t[0],e,n[0]);return[a.__(5,[l[0]]),l[1]]}throw nr;case 6:if("number"==typeof n)throw nr;if(6===n.tag){var m=r(t[0],e,n[0]);return[a.__(6,[m[0]]),m[1]]}throw nr;case 7:if("number"==typeof n)throw nr;if(7===n.tag){var v=r(t[0],e,n[0]);return[a.__(7,[v[0]]),v[1]]}throw nr;case 8:if("number"==typeof n)throw nr;if(8===n.tag){var d=n[0];if(_.caml_notequal([t[0]],[d]))throw nr;var g=r(t[1],e,n[1]);return[a.__(8,[d,g[0]]),g[1]]}throw nr;case 9:if("number"==typeof n)throw nr;if(9===n.tag){var h=n[1],y=n[0];if(_.caml_notequal([b.erase_rel(t[0])],[b.erase_rel(y)]))throw nr;if(_.caml_notequal([b.erase_rel(t[1])],[b.erase_rel(h)]))throw nr;var p=Y(Z(Q(y),h));o._1(p[1],0),o._1(p[3],0);var w=r(b.erase_rel(t[2]),e,n[2]);return[a.__(9,[y,h,Q(w[0])]),w[1]]}throw nr;case 10:if("number"==typeof n)throw nr;if(10===n.tag){var x=r(t[0],e,n[0]);return[a.__(10,[x[0]]),x[1]]}throw nr;case 11:if("number"==typeof n)throw nr;if(11===n.tag){var k=r(t[0],e,n[0]);return[a.__(11,[k[0]]),k[1]]}throw nr;case 12:throw nr;case 13:if("number"==typeof n)throw nr;if(13===n.tag){var M=r(t[0],e,n[0]);return[a.__(13,[M[0]]),M[1]]}throw nr;case 14:if("number"==typeof n)throw nr;if(14===n.tag){var S=r(t[0],e,n[0]);return[a.__(14,[S[0]]),S[1]]}throw nr}}(tr[1],er,ur),_r=sr[1];return[a.__(23,[a.__(8,[tr[0],sr[0]]),_r[0]]),_r[1]];default:return or(tr,er,ur)}case 22:case 24:throw nr}}function ur(r,t){var e=cr(r,t);if("number"==typeof e[1])return e[0];throw nr}function fr(r,t){return ur(r,b.erase_rel(Q(t)))}function sr(r,t,e){var n=e.length,a=d.abs(t),o=t<0?0:r,c=a;if(c<=n)return e;var u=o,s=i.make(c,2===u?48:32);switch(u){case 0:f.blit(e,0,s,0,n);break;case 1:f.blit(e,0,s,c-n|0,n);break;case 2:n>0&&(43===h.get(e,0)||45===h.get(e,0)||32===h.get(e,0))?(s[0]=h.get(e,0),f.blit(e,1,s,1+(c-n|0)|0,n-1|0)):n>1&&48===h.get(e,0)&&(120===h.get(e,1)||88===h.get(e,1))?(s[1]=h.get(e,1),f.blit(e,2,s,2+(c-n|0)|0,n-2|0)):f.blit(e,0,s,c-n|0,n)}return h.bytes_to_string(s)}function _r(r,t){var e=d.abs(r),n=t.length,a=h.get(t,0),o=0;if(a>=58)if(a>=71){if(a>102||a<97)return t;o=2}else{if(!(a>=65))return t;o=2}else if(32!==a){if(!(a>=43))return t;switch(a-43|0){case 0:case 2:o=1;break;case 1:case 3:case 4:return t;case 5:if((e+2|0)>n&&n>1&&(120===h.get(t,1)||88===h.get(t,1))){var c=i.make(e+2|0,48);return c[1]=h.get(t,1),f.blit(t,2,c,4+(e-n|0)|0,n-2|0),h.bytes_to_string(c)}o=2;break;case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:o=2}}else o=1;switch(o){case 1:if((e+1|0)>n){var u=i.make(e+1|0,48);return u[0]=a,f.blit(t,1,u,2+(e-n|0)|0,n-1|0),h.bytes_to_string(u)}return t;case 2:if(e>n){var s=i.make(e,48);return f.blit(t,0,s,e-n|0,n),h.bytes_to_string(s)}return t}}function lr(r){return f.concat(f.escaped(r),['"',['"',0]])}function mr(r,t){var e;switch(r){case 0:e=["%",["d",0]];break;case 1:e=["%+",["d",0]];break;case 2:e=["% ",["d",0]];break;case 3:e=["%",["i",0]];break;case 4:e=["%+",["i",0]];break;case 5:e=["% ",["i",0]];break;case 6:e=["%",["x",0]];break;case 7:e=["%#",["x",0]];break;case 8:e=["%",["X",0]];break;case 9:e=["%#",["X",0]];break;case 10:e=["%",["o",0]];break;case 11:e=["%#",["o",0]];break;case 12:e=["%",["u",0]]}return f.concat(h.bytes_to_string(i.make(1,t)),e)}function vr(r,t){return g.caml_format_int(function(r){switch(r){case 0:return"%d";case 1:return"%+d";case 2:return"% d";case 3:return"%i";case 4:return"%+i";case 5:return"% i";case 6:return"%x";case 7:return"%#x";case 8:return"%X";case 9:return"%#X";case 10:return"%o";case 11:return"%#o";case 12:return"%u"}}(r),t)}function dr(r,t){return g.caml_int32_format(mr(r,108),t)}function gr(r,t){return g.caml_nativeint_format(mr(r,110),t)}function hr(r,t){return g.caml_int64_format(mr(r,76),t)}function yr(r,t,e){var n=d.abs(t),a=g.caml_format_float(function(r,t){if(15===r)return"%.12g";var e=d.abs(t),n=U(r),a=[0,new Array(16)];return T(a,37),G(a,r),T(a,46),A(a,""+e),T(a,n),D(a)}(r,n),e);if(15!==r)return a;var i=a.length,o=m.caml_classify_float(e);return 3!==o?o>=4?"nan":function(r){for(;;){var t=r;if(t===i)return 0;var e=h.get(a,t)-46|0;if(e>23||e<0){if(55!==e){r=t+1|0;continue}return 1}if(e>22||e<1)return 1;r=t+1|0}}(0)?a:a+".":e<0?"neg_infinity":"infinity"}function pr(r){return f.concat(n.escaped(r),["'",["'",0]])}function br(r){var t=[0,new Array(16)];return $(t,r),D(t)}function wr(r,t,e,n){for(;;){var i=n,c=e,u=r;if("number"==typeof i)return o._2(u,t,c);switch(0|i.tag){case 0:return function(r,e,n){return function(i){var o=a.__(5,[e,i]);return wr(r,t,o,n)}}(u,c,i[0]);case 1:return function(r,e,n){return function(i){var o=pr(i),c=a.__(4,[e,o]);return wr(r,t,c,n)}}(u,c,i[0]);case 2:return Mr(u,t,c,i[1],i[0],function(r){return r});case 3:return Mr(u,t,c,i[1],i[0],lr);case 4:return Sr(u,t,c,i[3],i[1],i[2],vr,i[0]);case 5:return Sr(u,t,c,i[3],i[1],i[2],dr,i[0]);case 6:return Sr(u,t,c,i[3],i[1],i[2],gr,i[0]);case 7:return Sr(u,t,c,i[3],i[1],i[2],hr,i[0]);case 8:var f=u,s=t,_=c,l=i[3],m=i[1],v=i[2],d=i[0];if("number"!=typeof m){if(m.tag){var h=m[0];return"number"==typeof v?0!==v?function(r,t,e,n,i,o){return function(c,u,f){var s=sr(o,c,yr(i,u,f));return wr(r,t,a.__(4,[e,s]),n)}}(f,s,_,l,d,h):function(r,t,e,n,i,o){return function(c,u){var f=yr(i,6,u),s=sr(o,c,f);return wr(r,t,a.__(4,[e,s]),n)}}(f,s,_,l,d,h):function(r,t,e,n,i,o,c){return function(u,f){var s=sr(o,u,yr(i,c,f));return wr(r,t,a.__(4,[e,s]),n)}}(f,s,_,l,d,h,v[0])}var y=m[1],w=m[0];return"number"==typeof v?0!==v?function(r,t,e,n,i,o,c){return function(u,f){var s=sr(o,c,yr(i,u,f));return wr(r,t,a.__(4,[e,s]),n)}}(f,s,_,l,d,w,y):function(r,t,e,n,i,o,c){return function(u){var f=yr(i,6,u),s=sr(o,c,f);return wr(r,t,a.__(4,[e,s]),n)}}(f,s,_,l,d,w,y):function(r,t,e,n,i,o,c,u){return function(f){var s=sr(o,c,yr(i,u,f));return wr(r,t,a.__(4,[e,s]),n)}}(f,s,_,l,d,w,y,v[0])}return"number"==typeof v?0!==v?function(r,t,e,n,i){return function(o,c){var u=yr(i,o,c);return wr(r,t,a.__(4,[e,u]),n)}}(f,s,_,l,d):function(r,t,e,n,i){return function(o){var c=yr(i,6,o);return wr(r,t,a.__(4,[e,c]),n)}}(f,s,_,l,d):function(r,t,e,n,i,o){return function(c){var u=yr(i,o,c);return wr(r,t,a.__(4,[e,u]),n)}}(f,s,_,l,d,v[0]);case 9:return function(r,e,n){return function(i){return wr(r,t,a.__(4,[e,i?"true":"false"]),n)}}(u,c,i[0]);case 10:n=i[0],e=a.__(7,[c]);continue;case 11:n=i[1],e=a.__(2,[c,i[0]]);continue;case 12:n=i[1],e=a.__(3,[c,i[0]]);continue;case 13:return function(r,e,n,i){return function(){return wr(r,t,a.__(4,[e,i]),n)}}(u,c,i[2],br(i[1]));case 14:var x=i[2];return function(r,e,n,a){return function(i){return wr(r,t,e,b.concat_fmt(fr(i[0],n),a))}}(u,c,i[1],x);case 15:return function(r,e,n){return function(i,c){return wr(r,t,a.__(6,[e,function(r){return o._2(i,r,c)}]),n)}}(u,c,i[0]);case 16:return function(r,e,n){return function(i){return wr(r,t,a.__(6,[e,i]),n)}}(u,c,i[0]);case 17:n=i[1],e=a.__(0,[c,i[0]]);continue;case 18:var k=i[0];if(k.tag){var M=function(r,t,e){return function(n,i){return wr(r,n,a.__(1,[t,a.__(1,[i])]),e)}}(u,c,i[1]);n=k[0][0],e=0,r=M;continue}var S=function(r,t,e){return function(n,i){return wr(r,n,a.__(1,[t,a.__(0,[i])]),e)}}(u,c,i[1]);n=k[0][0],e=0,r=S;continue;case 19:throw[p.assert_failure,["camlinternalFormat.ml",1449,4]];case 20:return function(r,e,n){return function(){return wr(r,t,n,e)}}(u,i[2],a.__(8,[c,"Printf: bad conversion %["]));case 21:return function(r,e,n){return function(i){var o=g.caml_format_int("%u",i),c=a.__(4,[e,o]);return wr(r,t,c,n)}}(u,c,i[1]);case 22:return function(r,e,n){return function(i){var o=a.__(5,[e,i]);return wr(r,t,o,n)}}(u,c,i[0]);case 23:var C=u,P=t,T=c,A=i[0],D=i[1];if("number"==typeof A){if(3===A)throw[p.assert_failure,["camlinternalFormat.ml",1517,39]];return kr(C,P,T,D)}return 8===A.tag?xr(C,P,T,A[1],D):kr(C,P,T,D);case 24:return Cr(u,t,c,i[2],i[0],o._1(i[1],0))}}}function xr(r,t,e,n,a){if("number"==typeof n)return kr(r,t,e,a);switch(0|n.tag){case 0:var i=n[0];return function(){return xr(r,t,e,i,a)};case 1:var o=n[0];return function(){return xr(r,t,e,o,a)};case 2:var c=n[0];return function(){return xr(r,t,e,c,a)};case 3:var u=n[0];return function(){return xr(r,t,e,u,a)};case 4:var f=n[0];return function(){return xr(r,t,e,f,a)};case 5:var s=n[0];return function(){return xr(r,t,e,s,a)};case 6:var _=n[0];return function(){return xr(r,t,e,_,a)};case 7:var l=n[0];return function(){return xr(r,t,e,l,a)};case 8:var m=n[1];return function(){return xr(r,t,e,m,a)};case 9:var v=n[2],d=Z(Q(n[0]),n[1]);return function(){return xr(r,t,e,b.concat_fmtty(d,v),a)};case 10:var g=n[0];return function(n,i){return xr(r,t,e,g,a)};case 11:var h=n[0];return function(){return xr(r,t,e,h,a)};case 12:var y=n[0];return function(){return xr(r,t,e,y,a)};case 13:throw[p.assert_failure,["camlinternalFormat.ml",1540,31]];case 14:throw[p.assert_failure,["camlinternalFormat.ml",1541,31]]}}function kr(r,t,e,n){return wr(r,t,a.__(8,[e,"Printf: bad conversion %_"]),n)}function Mr(r,t,e,n,i,c){if("number"==typeof i)return function(i){var u=o._1(c,i),f=a.__(4,[e,u]);return wr(r,t,f,n)};if(i.tag){var u=i[0];return function(i,f){var s=sr(u,i,o._1(c,f)),_=a.__(4,[e,s]);return wr(r,t,_,n)}}var f=i[1],s=i[0];return function(i){var u=sr(s,f,o._1(c,i)),_=a.__(4,[e,u]);return wr(r,t,_,n)}}function Sr(r,t,e,n,i,c,u,f){if("number"==typeof i){if("number"==typeof c)return 0!==c?function(i,c){var s=_r(i,o._2(u,f,c));return wr(r,t,a.__(4,[e,s]),n)}:function(i){var c=o._2(u,f,i);return wr(r,t,a.__(4,[e,c]),n)};var s=c[0];return function(i){var c=_r(s,o._2(u,f,i));return wr(r,t,a.__(4,[e,c]),n)}}if(i.tag){var _=i[0];if("number"==typeof c)return 0!==c?function(i,c,s){var l=sr(_,i,_r(c,o._2(u,f,s)));return wr(r,t,a.__(4,[e,l]),n)}:function(i,c){var s=sr(_,i,o._2(u,f,c));return wr(r,t,a.__(4,[e,s]),n)};var l=c[0];return function(i,c){var s=sr(_,i,_r(l,o._2(u,f,c)));return wr(r,t,a.__(4,[e,s]),n)}}var m=i[1],v=i[0];if("number"==typeof c)return 0!==c?function(i,c){var s=sr(v,m,_r(i,o._2(u,f,c)));return wr(r,t,a.__(4,[e,s]),n)}:function(i){var c=sr(v,m,o._2(u,f,i));return wr(r,t,a.__(4,[e,c]),n)};var d=c[0];return function(i){var c=sr(v,m,_r(d,o._2(u,f,i)));return wr(r,t,a.__(4,[e,c]),n)}}function Cr(r,t,e,n,i,c){if(i){var u=i[0];return function(a){return Cr(r,t,e,n,u,o._1(c,a))}}return wr(r,t,a.__(4,[e,c]),n)}function Pr(r,t){for(;;){var e=t,n=0;if("number"==typeof e)return 0;switch(0|e.tag){case 0:var a=O(e[1]);return Pr(r,e[0]),c.add_string(r,a);case 1:var i=e[1];if(Pr(r,e[0]),i.tag){c.add_string(r,"@["),t=i[0];continue}c.add_string(r,"@{"),t=i[0];continue;case 2:case 4:n=1;break;case 3:case 5:n=2;break;case 6:return Pr(r,e[0]),c.add_string(r,o._1(e[1],0));case 7:t=e[0];continue;case 8:throw Pr(r,e[0]),[p.invalid_argument,e[1]]}switch(n){case 1:return Pr(r,e[0]),c.add_string(r,e[1]);case 2:return Pr(r,e[0]),c.add_char(r,e[1])}}}function Tr(r){var t=c.create(256);return wr(function(r,e){Pr(t,e);var n=c.contents(t);throw[p.failure,n]},0,0,r[0])}function Ar(r){if(""===r)return[0,4];var t,e,n=r.length,i=function(){return o._1(Tr([a.__(11,["invalid box description ",a.__(3,[0,0])]),"invalid box description %S"]),r)},c=function(t){for(;;){var e=t;if(e===n)return e;var a=h.get(r,e);if(9===a)t=e+1|0;else{if(32!==a)return e;t=e+1|0}}},s=c(0),_=function(t,e){for(;;){var a=e;if(a===n)return a;var i=h.get(r,a);if(i>122||i<97)return a;e=a+1|0}}(0,s),l=f.sub(r,s,_-s|0),m=c(_),v=function(t,e){for(;;){var a=e;if(a===n)return a;var i=h.get(r,a);if(i>=48){if(i>=58)return a;e=a+1|0}else{if(45!==i)return a;e=a+1|0}}}(0,m);if(m===v)t=0;else try{t=g.caml_int_of_string(f.sub(r,m,v-m|0))}catch(r){var d=u.internalToOCamlException(r);if(d[0]!==p.failure)throw d;t=i()}switch(c(v)!==n&&i(),l){case"":case"b":e=4;break;case"h":e=0;break;case"hov":e=3;break;case"hv":e=2;break;case"v":e=1;break;default:e=i()}return[t,e]}function Dr(r,t){return"number"==typeof r?[0,t]:r.tag?[a.__(1,[r[0]]),t]:[a.__(0,[r[0],r[1]]),t]}function Vr(r,t,e){var n=function(r,t){return"number"==typeof r?0!==r?[1,t]:[0,t]:[[r[0]],t]}(t,e),i=n[1],o=n[0];return"number"==typeof r?[0,o,i]:r.tag?[a.__(1,[r[0]]),o,i]:[a.__(0,[r[0],r[1]]),o,i]}function Ur(r,t){var e=r?r[0]:1,n=function(r,e){return o._3(Tr([a.__(11,["invalid format ",a.__(3,[0,a.__(11,[": at character number ",a.__(4,[0,0,0,a.__(11,[", ",a.__(2,[0,0])])])])])]),"invalid format %S: at character number %d, %s"]),t,r,e)},c=function(r,e,n){return o._4(Tr([a.__(11,["invalid format ",a.__(3,[0,a.__(11,[": at character number ",a.__(4,[0,0,0,a.__(11,[", '",a.__(0,[a.__(11,["' without ",a.__(2,[0,0])])])])])])])]),"invalid format %S: at character number %d, '%c' without %s"]),t,r,e,n)},s=function(r,e,n){return o._4(Tr([a.__(11,["invalid format ",a.__(3,[0,a.__(11,[": at character number ",a.__(4,[0,0,0,a.__(11,[", ",a.__(2,[0,a.__(11,[" expected, read ",a.__(1,[0])])])])])])])]),"invalid format %S: at character number %d, %s expected, read %C"]),t,r,e,n)},l=function(r,t,n,a,i,o){for(;;){var c=i,u=a,f=n,s=0,_=0;if(0!==f)if(0!==u)_=2;else if(0!==c)s=1;else{if(100===o)return 1;if(105===o)return 4;s=1}else if(0!==u)if(0!==c)_=2;else{if(88===o)return 9;if(111===o)return 11;if(120===o)return 7;_=2}else if(0!==c){if(100===o)return 2;if(105===o)return 5;s=1}else{var l=o-88|0;if(l>32||l<0)s=1;else switch(l){case 0:return 8;case 12:return 0;case 17:return 3;case 23:return 10;case 29:return 12;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 18:case 19:case 20:case 21:case 22:case 24:case 25:case 26:case 27:case 28:case 30:case 31:s=1;break;case 32:return 6}}if(2===_){var v=0,d=o-88|0;if(d>32||d<0)s=1;else switch(d){case 0:if(e)return 9;s=1;break;case 23:if(e)return 11;s=1;break;case 12:case 17:case 29:v=3;break;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 18:case 19:case 20:case 21:case 22:case 24:case 25:case 26:case 27:case 28:case 30:case 31:s=1;break;case 32:if(e)return 7;s=1}if(3===v){if(e){a=0;continue}return m(r,t,o,"'#'")}}if(1===s){if(0!==f){if(0!==c){if(e){i=0;continue}return m(r,t,32,"'+'")}if(e){n=0;continue}return m(r,t,o,"'+'")}if(0!==c){if(e){i=0;continue}return m(r,t,o,"' '")}throw[p.assert_failure,["camlinternalFormat.ml",2719,28]]}}},m=function(r,e,n,i){var c=f.sub(t,r,e-r|0);return o._5(Tr([a.__(11,["invalid format ",a.__(3,[0,a.__(11,[": at character number ",a.__(4,[0,0,0,a.__(11,[", ",a.__(2,[0,a.__(11,[" is incompatible with '",a.__(0,[a.__(11,["' in sub-format ",a.__(3,[0,0])])])])])])])])])]),"invalid format %S: at character number %d, %s is incompatible with '%c' in sub-format %S"]),t,r,i,n,c)},g=function(r,e,a){for(;;){var i=a,o=r;o===e&&n(e,"unexpected end of format");var c=h.get(t,o);if(c>57||c<48)return[o,i];a=v.imul(i,10)+(c-48|0)|0,r=o+1|0}},y=function(r,e,i,o,c,u,f,s,_,l){e===i&&n(i,"unexpected end of format");var m=function(n){return D(r,e+1|0,i,c,u,f,s,_,l,n,h.get(t,e))};if("number"!=typeof _)return m(_);var v=0;if("number"==typeof l){if(0===l)return m(0);v=1}else v=1;return 1===v?m(0!==o?"number"==typeof l?a.__(1,[0]):a.__(0,[0,l[0]]):"number"==typeof l?a.__(1,[1]):a.__(0,[1,l[0]])):void 0},b=function(r,a,i,o,u,f,s,_,l){a===i&&n(i,"unexpected end of format");var m=h.get(t,a);if(46!==m)return D(r,a+1|0,i,u,f,s,_,l,0,l,m);var v=r,d=a+1|0,p=i,b=o,w=u,x=f,k=s,M=_,S=l;d===p&&n(p,"unexpected end of format");var C=function(r,t){var e=g(t,p,0);return y(v,e[0],p,r,w,x,k,M,S,[e[1]])},P=h.get(t,d),T=0,A=0;if(P>=48){if(!(P>=58))return C(b,d);T=1}else if(P>=42)switch(P-42|0){case 0:return y(v,d+1|0,p,b,w,x,k,M,S,1);case 1:case 3:A=2;break;case 2:case 4:case 5:T=1}else T=1;if(2===A){if(e)return C(b||+(45===P),d+1|0);T=1}return 1===T?e?y(v,d,p,b,w,x,k,M,S,[0]):c(d-1|0,46,"precision"):void 0},x=function(r,e,n){for(;;){var a=e;if(a===n)return C(r,a,0);var i=h.get(t,a);if(37!==i){if(64!==i){e=a+1|0;continue}var o=S(a+1|0,n);return C(r,a,o[0])}var c=M(a,n);return C(r,a,c[0])}},M=function(r,e){var a=r,i=r+1|0,o=e;return i===o&&n(o,"unexpected end of format"),95!==h.get(t,i)?V(a,i,o,0):V(a,i+1|0,o,1)},S=function(r,e){if(r===e)return[a.__(12,[64,0])];var n=h.get(t,r),i=0;if(n>=65)if(n>=94){var o=n-123|0;if(o>2||o<0)i=1;else switch(o){case 0:return B(1,r+1|0,e);case 1:i=1;break;case 2:var c=r+1|0,s=x(c,c,e);return[a.__(17,[1,s[0]])]}}else if(n>=91)switch(n-91|0){case 0:return B(0,r+1|0,e);case 1:i=1;break;case 2:var _=r+1|0,l=x(_,_,e);return[a.__(17,[0,l[0]])]}else i=1;else{if(10===n){var m=r+1|0,v=x(m,m,e);return[a.__(17,[3,v[0]])]}if(n>=32)switch(n-32|0){case 0:var d=r+1|0,g=x(d,d,e);return[a.__(17,[a.__(0,["@ ",1,0]),g[0]])];case 5:if((r+1|0)<e&&37===h.get(t,r+1|0)){var y=r+2|0,b=x(y,y,e);return[a.__(17,[6,b[0]])]}var w=x(r,r,e);return[a.__(12,[64,w[0]])];case 12:var k=r+1|0,M=x(k,k,e);return[a.__(17,[a.__(0,["@,",0,0]),M[0]])];case 14:var S=r+1|0,C=x(S,S,e);return[a.__(17,[4,C[0]])];case 27:var A,D=r+1|0,V=e;try{if(D===V||60!==h.get(t,D))throw p.not_found;var U=P(D+1|0,V),N=h.get(t,U),L=0;if(N>=48){if(N>=58)throw p.not_found;L=1}else{if(45!==N)throw p.not_found;L=1}if(1===L){var F=T(U,V),I=F[1],z=P(F[0],V),E=h.get(t,z)-45|0;if(E>12||E<0){if(17!==E)throw p.not_found;var q=f.sub(t,D-2|0,3+(z-D|0)|0);A=[z+1|0,a.__(0,[q,I,0])]}else{if(2===E||1===E)throw p.not_found;var R=T(z,V),G=P(R[0],V);if(62!==h.get(t,G))throw p.not_found;var H=f.sub(t,D-2|0,3+(G-D|0)|0);A=[G+1|0,a.__(0,[H,I,R[1]])]}}}catch(r){var O=u.internalToOCamlException(r);if(O===p.not_found)A=[D,a.__(0,["@;",1,0])];else{if(O[0]!==p.failure)throw O;A=[D,a.__(0,["@;",1,0])]}}var K=A[0],j=x(K,K,V);return[a.__(17,[A[1],j[0]])];case 28:var W,$=r+1|0,X=e;try{var Q=P($,X),Y=h.get(t,Q),Z=0;if(Y>=48?Y>=58?W=0:Z=1:45!==Y?W=0:Z=1,1===Z){var J=T(Q,X),rr=P(J[0],X);if(62!==h.get(t,rr))throw p.not_found;var tr=f.sub(t,$-2|0,3+(rr-$|0)|0);W=[[rr+1|0,a.__(1,[tr,J[1]])]]}}catch(r){var er=u.internalToOCamlException(r);if(er===p.not_found)W=0;else{if(er[0]!==p.failure)throw er;W=0}}if(W){var nr=W[0],ar=nr[0],ir=x(ar,ar,X);return[a.__(17,[nr[1],ir[0]])]}var or=x($,$,X);return[a.__(17,[a.__(2,[60]),or[0]])];case 1:case 2:case 3:case 4:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 29:case 30:i=1;break;case 31:var cr=r+1|0,ur=x(cr,cr,e);return[a.__(17,[2,ur[0]])];case 32:var fr=r+1|0,sr=x(fr,fr,e);return[a.__(17,[5,sr[0]])]}else i=1}if(1===i){var _r=r+1|0,lr=x(_r,_r,e);return[a.__(17,[a.__(2,[n]),lr[0]])]}},C=function(r,e,n){var i=e-r|0;return 0!==i?1!==i?[a.__(11,[f.sub(t,r,i),n])]:[a.__(12,[h.get(t,r),n])]:[n]},P=function(r,e){for(;;){var a=r;if(a===e&&n(e,"unexpected end of format"),32!==h.get(t,a))return a;r=a+1|0}},T=function(r,e){r===e&&n(e,"unexpected end of format");var a=h.get(t,r);if(a>=48){if(a>=58)throw[p.assert_failure,["camlinternalFormat.ml",2624,11]];return g(r,e,0)}if(45!==a)throw[p.assert_failure,["camlinternalFormat.ml",2624,11]];(r+1|0)===e&&n(e,"unexpected end of format");var i=h.get(t,r+1|0);if(i>57||i<48)return s(r+1|0,"digit",i);var o=g(r+1|0,e,0);return[o[0],0|-o[1]]},A=function(r,e,i){for(;;){var c=r;if(c===e&&o._3(Tr([a.__(11,["invalid format ",a.__(3,[0,a.__(11,[': unclosed sub-format, expected "',a.__(12,[37,a.__(0,[a.__(11,['" at character number ',a.__(4,[0,0,0,0])])])])])])]),'invalid format %S: unclosed sub-format, expected "%%%c" at character number %d']),t,i,e),37===h.get(t,c)){if((c+1|0)===e&&n(e,"unexpected end of format"),h.get(t,c+1|0)===i)return c;var u=h.get(t,c+1|0),f=0;if(u>=95)if(u>=123)if(u>=126)f=1;else switch(u-123|0){case 0:r=A(c+2|0,e,125)+2|0;continue;case 1:f=1;break;case 2:return s(c+1|0,"character ')'",125)}else{if(!(u>=96)){(c+2|0)===e&&n(e,"unexpected end of format");var _=h.get(t,c+2|0);if(40!==_){if(123!==_){r=c+3|0;continue}r=A(c+3|0,e,125)+2|0;continue}r=A(c+3|0,e,41)+2|0;continue}f=1}else{if(40===u){r=A(c+2|0,e,41)+2|0;continue}if(41===u)return s(c+1|0,"character '}'",41);f=1}1!==f||(r=c+2|0)}else r=c+1|0}},D=function(r,i,c,u,f,s,v,d,g,y,b){var w,k=0,M=0,S=0,C=[0],P=0,T=[0],D=function(t,n){return"number"==typeof n?n:n.tag?n[0]>=2?e?a.__(1,[1]):m(r,i,t,"0"):n:n[0]>=2?e?a.__(0,[1,n[1]]):m(r,i,t,"0"):n},V=function(t,n){if("number"==typeof n)return 0;if(n.tag)return m(r,i,t,"'*'");switch(n[0]){case 0:return e?[n[1]]:m(r,i,t,"'-'");case 1:return[n[1]];case 2:return e?[n[1]]:m(r,i,t,"'0'")}},B=0,F=0,I=0;if(b>=124)F=6;else switch(b){case 33:var z=x(i,i,c);w=[a.__(10,[z[0]])];break;case 40:var E=A(i,c,41),q=E+2|0,R=x(q,q,c)[0],G=J(x(i,i,E)[0]);if(C[0]=1,v){P=1;var H=V(95,d),O=a.__(8,[H,G]);w=[a.__(23,[O,R])]}else P=1,w=[a.__(14,[V(40,d),G,R])];break;case 44:w=x(i,i,c);break;case 37:case 64:F=4;break;case 67:var K=x(i,i,c)[0];C[0]=1,w=v?[a.__(23,[1,K])]:[a.__(1,[K])];break;case 78:var j=x(i,i,c)[0];if(C[0]=1,v){var W=a.__(10,[2]);w=[a.__(23,[W,j])]}else w=[a.__(21,[2,j])];break;case 83:P=1;var $=D(b,y),X=x(i,i,c)[0];if(C[0]=1,v){P=1;var Q=a.__(1,[V(95,y)]);w=[a.__(23,[Q,X])]}else{var Y=Dr($,X);w=[a.__(3,[Y[0],Y[1]])]}break;case 91:var Z=L(i,c),rr=Z[1],tr=Z[0],er=x(tr,tr,c)[0];if(C[0]=1,v){P=1;var nr=V(95,d),ar=a.__(9,[nr,rr]);w=[a.__(23,[ar,er])]}else P=1,w=[a.__(20,[V(91,d),rr,er])];break;case 32:case 35:case 43:case 45:case 95:F=5;break;case 97:var ir=x(i,i,c);w=[a.__(15,[ir[0]])];break;case 66:case 98:F=3;break;case 99:var or=function(r){return C[0]=1,v?[a.__(23,[0,r])]:[a.__(0,[r])]},cr=x(i,i,c)[0];P=1;var ur=V(99,d);w=ur?0!==ur[0]?e?or(cr):n(i,"non-zero widths are unsupported for %c conversions"):function(r){return C[0]=1,v?[a.__(23,[4,r])]:[a.__(22,[r])]}(cr):or(cr);break;case 69:case 70:case 71:case 101:case 102:case 103:F=2;break;case 76:case 108:case 110:I=8;break;case 114:var fr=x(i,i,c)[0];C[0]=1,w=v?[a.__(23,[3,fr])]:[a.__(19,[fr])];break;case 115:P=1;var sr=D(b,y),_r=x(i,i,c)[0];if(C[0]=1,v){P=1;var lr=a.__(0,[V(95,y)]);w=[a.__(23,[lr,_r])]}else{var mr=Dr(sr,_r);w=[a.__(2,[mr[0],mr[1]])]}break;case 116:var vr=x(i,i,c);w=[a.__(16,[vr[0]])];break;case 88:case 100:case 105:case 111:case 117:case 120:I=7;break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 30:case 31:case 34:case 36:case 38:case 39:case 41:case 42:case 46:case 47:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 58:case 59:case 60:case 61:case 62:case 63:case 65:case 68:case 72:case 73:case 74:case 75:case 77:case 79:case 80:case 81:case 82:case 84:case 85:case 86:case 87:case 89:case 90:case 92:case 93:case 94:case 96:case 104:case 106:case 107:case 109:case 112:case 113:case 118:case 119:case 121:case 122:F=6;break;case 123:var dr=A(i,c,125),gr=x(i,i,dr),hr=dr+2|0,yr=x(hr,hr,c)[0],pr=J(gr[0]);if(C[0]=1,v){P=1;var br=V(95,d),wr=a.__(7,[br,pr]);w=[a.__(23,[wr,yr])]}else P=1,w=[a.__(13,[V(123,d),pr,yr])]}switch(I){case 7:k=1,M=1,S=1;var xr=l(r,i,u,f,s,b),kr=x(i,i,c)[0];if(C[0]=1,v){P=1;var Mr=V(95,d),Sr=a.__(2,[xr,Mr]);w=[a.__(23,[Sr,kr])]}else{var Cr;P=1,T[0]=1;var Pr=0;"number"==typeof g&&0===g?Cr=d:Pr=9,9===Pr&&(Cr="number"==typeof d?0:d.tag?d[0]>=2?e?a.__(1,[1]):m(r,i,48,"precision"):d:d[0]>=2?e?a.__(0,[1,d[1]]):m(r,i,48,"precision"):d);var Ar=Vr(Cr,(T[0]=1,g),kr);w=[a.__(4,[xr,Ar[0],Ar[1],Ar[2]])]}break;case 8:if(i!==c&&U(h.get(t,i)))F=6;else{var Ur=x(i,i,c)[0],Nr=N(b);if(C[0]=1,v){var Lr=a.__(10,[Nr]);w=[a.__(23,[Lr,Ur])]}else w=[a.__(21,[Nr,Ur])]}}switch(F){case 2:k=1,S=1;var Br=function(r,t,n,a,i){for(;;){var o=a;if(0!==n){if(0!==o){if(e){a=0;continue}return m(r,t,32,"'+'")}var c=0;if(i>=72){var u=i-101|0;if(u>2||u<0)c=1;else switch(u){case 0:return 4;case 1:return 1;case 2:return 10}}else if(i>=69)switch(i-69|0){case 0:return 7;case 1:c=1;break;case 2:return 13}else c=1;if(1===c){if(e){n=0;continue}return m(r,t,i,"'+'")}}else if(0!==o){var f=0;if(i>=72){var s=i-101|0;if(s>2||s<0)f=1;else switch(s){case 0:return 5;case 1:return 2;case 2:return 11}}else if(i>=69)switch(i-69|0){case 0:return 8;case 1:f=1;break;case 2:return 14}else f=1;if(1===f){if(e){a=0;continue}return m(r,t,i,"' '")}}else if(i>=72){var _=i-101|0;if(_>2||_<0)throw[p.assert_failure,["camlinternalFormat.ml",2747,25]];switch(_){case 0:return 3;case 1:return 0;case 2:return 9}}else{if(!(i>=69))throw[p.assert_failure,["camlinternalFormat.ml",2747,25]];switch(i-69|0){case 0:return 6;case 1:return 15;case 2:return 12}}}}(r,i,u,s,b),Fr=x(i,i,c)[0];if(C[0]=1,v){P=1;var Ir=V(95,d),zr=(T[0]=1,"number"==typeof g?0!==g?m(r,i,95,"'*'"):0:[g[0]]),Er=a.__(6,[Ir,zr]);w=[a.__(23,[Er,Fr])]}else{P=1;var qr=Vr(d,(T[0]=1,g),Fr);w=[a.__(8,[Br,qr[0],qr[1],qr[2]])]}break;case 3:var Rr=x(i,i,c)[0];C[0]=1,w=v?[a.__(23,[2,Rr])]:[a.__(9,[Rr])];break;case 4:var Gr=x(i,i,c);w=[a.__(12,[b,Gr[0]])];break;case 5:w=o._3(Tr([a.__(11,["invalid format ",a.__(3,[0,a.__(11,[": at character number ",a.__(4,[0,0,0,a.__(11,[", flag ",a.__(1,[a.__(11,[" is only allowed after the '",a.__(12,[37,a.__(11,["', before padding and precision",0])])])])])])])])]),"invalid format %S: at character number %d, flag %C is only allowed after the '%%', before padding and precision"]),t,r,b);break;case 6:if(b>=108)if(b>=111)B=1;else switch(b-108|0){case 0:k=1,M=1,S=1;var Hr=l(r,i+1|0,u,f,s,h.get(t,i)),Or=i+1|0,Kr=x(Or,Or,c)[0];if(C[0]=1,v){P=1;var jr=V(95,d),Wr=a.__(3,[Hr,jr]);w=[a.__(23,[Wr,Kr])]}else{P=1;var $r=Vr(d,(T[0]=1,g),Kr);w=[a.__(5,[Hr,$r[0],$r[1],$r[2]])]}break;case 1:B=1;break;case 2:k=1,M=1,S=1;var Xr=l(r,i+1|0,u,f,s,h.get(t,i)),Qr=i+1|0,Yr=x(Qr,Qr,c)[0];if(C[0]=1,v){P=1;var Zr=V(95,d),Jr=a.__(4,[Xr,Zr]);w=[a.__(23,[Jr,Yr])]}else{P=1;var rt=Vr(d,(T[0]=1,g),Yr);w=[a.__(6,[Xr,rt[0],rt[1],rt[2]])]}}else if(76!==b)B=1;else{k=1,M=1,S=1;var tt=l(r,i+1|0,u,f,s,h.get(t,i)),et=i+1|0,nt=x(et,et,c)[0];if(C[0]=1,v){P=1;var at=V(95,d),it=a.__(5,[tt,at]);w=[a.__(23,[it,nt])]}else{P=1;var ot=Vr(d,(T[0]=1,g),nt);w=[a.__(7,[tt,ot[0],ot[1],ot[2]])]}}}if(1===B&&(w=o._3(Tr([a.__(11,["invalid format ",a.__(3,[0,a.__(11,[": at character number ",a.__(4,[0,0,0,a.__(11,[', invalid conversion "',a.__(12,[37,a.__(0,[a.__(12,[34,0])])])])])])])]),'invalid format %S: at character number %d, invalid conversion "%%%c"']),t,i-1|0,b)),e||(!k&&u&&m(r,i,b,"'+'"),!M&&f&&m(r,i,b,"'#'"),!S&&s&&m(r,i,b,"' '"),!P&&_.caml_notequal([d],[0])&&m(r,i,b,"`padding'"),!T[0]&&_.caml_notequal([g],[0])&&m(r,i,v?95:b,"`precision'"),v&&u&&m(r,i,95,"'+'")),!C[0]&&v){var ct=0;b>=38?44!==b&&64!==b?ct=1:e||(ct=1):33!==b?b>=37&&e||(ct=1):e||(ct=1),1===ct&&m(r,i,b,"'_'")}return w},V=function(r,i,u,f){for(var s=[0],_=[0],l=[0],v=[0],d=[0],y=function(r,n){return n[0]&&!e&&o._3(Tr([a.__(11,["invalid format ",a.__(3,[0,a.__(11,[": at character number ",a.__(4,[0,0,0,a.__(11,[", duplicate flag ",a.__(1,[0])])])])])]),"invalid format %S: at character number %d, duplicate flag %C"]),t,r,h.get(t,r)),n[0]=1,0},p=i;;){var w=p;w===u&&n(u,"unexpected end of format");var x=0,k=h.get(t,w)-32|0;if(k>16||k<0)x=1;else switch(k){case 0:y(w,v),p=w+1|0;continue;case 3:y(w,d),p=w+1|0;continue;case 11:y(w,l),p=w+1|0;continue;case 13:y(w,_),p=w+1|0;continue;case 1:case 2:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 12:case 14:case 15:x=1;break;case 16:y(w,s),p=w+1|0;continue}if(1===x){var M=r,S=w,C=u,P=s[0],T=_[0],A=l[0],D=d[0],V=v[0],U=f;S===C&&n(C,"unexpected end of format");var N=0!==P?0!==T?e?0:m(M,S,45,"0"):2:0!==T?0:1,L=h.get(t,S),B=0;if(L>=48){if(!(L>=58)){var F=g(S,C,0);return b(M,F[0],C,T,A,D,V,U,a.__(0,[N,F[1]]))}B=1}else{if(42===L)return b(M,S+1|0,C,T,A,D,V,U,a.__(1,[N]));B=1}if(1===B)switch(N){case 0:return e||c(S-1|0,45,"padding"),b(M,S,C,T,A,D,V,U,0);case 1:return b(M,S,C,T,A,D,V,U,0);case 2:return b(M,S,C,T,A,D,V,U,a.__(0,[1,0]))}}}},U=function(r){var t=r-88|0;if(t>32||t<0)return 0;switch(t){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 18:case 19:case 20:case 21:case 22:case 24:case 25:case 26:case 27:case 28:case 30:case 31:return 0;case 0:case 12:case 17:case 23:case 29:case 32:return 1}},N=function(r){var t=0;if(r>=108)if(r>=111)t=1;else switch(r-108|0){case 0:return 0;case 1:t=1;break;case 2:return 1}else{if(76===r)return 2;t=1}if(1===t)throw[p.assert_failure,["camlinternalFormat.ml",2686,34]]},L=function(r,e){r===e&&n(e,"unexpected end of format");var c=i.make(32,0),u=function(r,t){for(var e=r;e<=t;++e)w(c,d.char_of_int(e));return 0},f=function(r){return o._2(Tr([a.__(11,["invalid format ",a.__(3,[0,a.__(11,[": '",a.__(12,[37,a.__(11,["' alone is not accepted in character sets, use ",a.__(12,[37,a.__(12,[37,a.__(11,[" instead at position ",a.__(4,[0,0,0,a.__(12,[46,0])])])])])])])])])]),"invalid format %S: '%%' alone is not accepted in character sets, use %%%% instead at position %d."]),t,r)},s=function(r,e,a){for(;;){var i=a,o=r;o===e&&n(e,"unexpected end of format");var s=h.get(t,o),l=0,m=0;if(s>=46)if(64!==s){if(93===s)return w(c,i),o+1|0;l=1}else m=2;else if(37!==s)if(s>=45){var v=o+1|0,d=e,g=i;v===d&&n(d,"unexpected end of format");var y=h.get(t,v);if(37!==y)return 93!==y?(u(g,y),_(v+1|0,d)):(w(c,g),w(c,45),v+1|0);(v+1|0)===d&&n(d,"unexpected end of format");var p=h.get(t,v+1|0),b=0;if(37!==p){if(64!==p)return f(v);b=1}else b=1;if(1===b)return u(g,p),_(v+2|0,d)}else l=1;else m=2;if(2===m){if(37===i)return w(c,s),_(o+1|0,e);l=1}1!==l||(37===i&&f(o),w(c,i),a=s,r=o+1|0)}},_=function(r,e){for(;;){var a=r;a===e&&n(e,"unexpected end of format");var i=h.get(t,a);if(45!==i)return 93!==i?s(a+1|0,e,i):a+1|0;w(c,45),r=a+1|0}};r===e&&n(e,"unexpected end of format");var l=94!==h.get(t,r)?[r,0]:[r+1|0,1],m=function(r,e){r===e&&n(e,"unexpected end of format");var a=h.get(t,r);return s(r+1|0,e,a)}(l[0],e),v=i.to_string(c);return[m,l[1]?k(v):v]},B=function(r,e,n){try{if(e===n)throw p.not_found;if(60!==h.get(t,e))throw p.not_found;var i=f.index_from(t,e+1|0,62);if(i>=n)throw p.not_found;var o=f.sub(t,e,1+(i-e|0)|0),c=i+1|0,s=x(c,c,n),_=x(e,e,i+1|0)[0],l=[_,o],m=r?a.__(0,[l]):(function(r){if("number"==typeof r)return 0;if(11!==r.tag)return 0;if("number"!=typeof r[1])return 0;try{Ar(r[0])}catch(r){var t=u.internalToOCamlException(r);if(t[0]===p.failure)return 0;throw t}}(_),a.__(1,[l]));return[a.__(18,[m,s[0]])]}catch(t){if(t===p.not_found){var v=x(e,e,n),d=[0,""],g=r?a.__(0,[d]):a.__(1,[d]);return[a.__(18,[g,v[0]])]}throw t}};return x(0,0,t.length)}t.is_in_char_set=M,t.rev_char_set=k,t.create_char_set=function(){return i.make(32,0)},t.add_in_char_set=w,t.freeze_char_set=x,t.param_format_of_ignored_format=C,t.make_printf=wr,t.output_acc=function r(t,e){for(;;){var n=e,a=0;if("number"==typeof n)return 0;switch(0|n.tag){case 0:var i=O(n[1]);return r(t,n[0]),d.output_string(t,i);case 1:var c=n[1];if(r(t,n[0]),c.tag){d.output_string(t,"@["),e=c[0];continue}d.output_string(t,"@{"),e=c[0];continue;case 2:case 4:a=1;break;case 3:case 5:a=2;break;case 6:return r(t,n[0]),o._1(n[1],t);case 7:return r(t,n[0]),s.caml_ml_flush(t);case 8:throw r(t,n[0]),[p.invalid_argument,n[1]]}switch(a){case 1:return r(t,n[0]),d.output_string(t,n[1]);case 2:return r(t,n[0]),s.caml_ml_output_char(t,n[1])}}},t.bufput_acc=function r(t,e){for(;;){var n=e,a=0;if("number"==typeof n)return 0;switch(0|n.tag){case 0:var i=O(n[1]);return r(t,n[0]),c.add_string(t,i);case 1:var u=n[1];if(r(t,n[0]),u.tag){c.add_string(t,"@["),e=u[0];continue}c.add_string(t,"@{"),e=u[0];continue;case 2:case 4:a=1;break;case 3:case 5:a=2;break;case 6:return r(t,n[0]),o._1(n[1],t);case 7:e=n[0];continue;case 8:throw r(t,n[0]),[p.invalid_argument,n[1]]}switch(a){case 1:return r(t,n[0]),c.add_string(t,n[1]);case 2:return r(t,n[0]),c.add_char(t,n[1])}}},t.strput_acc=Pr,t.type_format=ur,t.fmt_ebb_of_string=Ur,t.format_of_string_fmtty=function(r,t){var e=Ur(0,r);try{return[ur(e[0],t),r]}catch(e){if(e===nr)return o._2(Tr([a.__(11,["bad input: format type mismatch between ",a.__(3,[0,a.__(11,[" and ",a.__(3,[0,0])])])]),"bad input: format type mismatch between %S and %S"]),r,br(t));throw e}},t.format_of_string_format=function(r,t){var e=Ur(0,r);try{return[ur(e[0],J(t[0])),r]}catch(e){if(e===nr)return o._2(Tr([a.__(11,["bad input: format type mismatch between ",a.__(3,[0,a.__(11,[" and ",a.__(3,[0,0])])])]),"bad input: format type mismatch between %S and %S"]),r,t[1]);throw e}},t.char_of_iconv=V,t.string_of_formatting_lit=O,t.string_of_formatting_gen=K,t.string_of_fmtty=br,t.string_of_fmt=function(r){var t=[0,new Array(16)];return function(r,t){for(var e=t,n=0;;){var a=n,i=e;if("number"==typeof i)return 0;switch(0|i.tag){case 0:T(r,37),B(r,a),T(r,99),n=0,e=i[0];continue;case 1:T(r,37),B(r,a),T(r,67),n=0,e=i[0];continue;case 2:T(r,37),B(r,a),I(r,i[0]),T(r,115),n=0,e=i[1];continue;case 3:T(r,37),B(r,a),I(r,i[0]),T(r,83),n=0,e=i[1];continue;case 4:q(r,a,i[0],i[1],i[2]),n=0,e=i[3];continue;case 5:R(r,a,i[0],i[1],i[2],108),n=0,e=i[3];continue;case 6:R(r,a,i[0],i[1],i[2],110),n=0,e=i[3];continue;case 7:R(r,a,i[0],i[1],i[2],76),n=0,e=i[3];continue;case 8:H(r,a,i[0],i[1],i[2]),n=0,e=i[3];continue;case 9:T(r,37),B(r,a),T(r,66),n=0,e=i[0];continue;case 10:A(r,"%!"),e=i[0];continue;case 11:W(r,i[0]),e=i[1];continue;case 12:j(r,i[0]),e=i[1];continue;case 13:T(r,37),B(r,a),F(r,i[0]),T(r,123),$(r,i[1]),T(r,37),T(r,125),n=0,e=i[2];continue;case 14:T(r,37),B(r,a),F(r,i[0]),T(r,40),$(r,i[1]),T(r,37),T(r,41),n=0,e=i[2];continue;case 15:T(r,37),B(r,a),T(r,97),n=0,e=i[0];continue;case 16:T(r,37),B(r,a),T(r,116),n=0,e=i[0];continue;case 17:W(r,O(i[0])),e=i[1];continue;case 18:W(r,"@{"),W(r,K(i[0])),e=i[1];continue;case 19:T(r,37),B(r,a),T(r,114),n=0,e=i[0];continue;case 20:T(r,37),B(r,a),F(r,i[0]),L(r,i[1]),n=0,e=i[2];continue;case 21:T(r,37),B(r,a),T(r,N(i[0])),n=0,e=i[1];continue;case 22:T(r,37),B(r,a),W(r,"0c"),n=0,e=i[0];continue;case 23:n=1,e=C(i[0],i[1])[0];continue;case 24:for(var o=1,c=X(i[0]);o<=c;++o)T(r,37),B(r,a),T(r,63);n=0,e=i[2];continue}}}(t,r),D(t)},t.open_box_of_string=Ar,t.symm=Q,t.trans=Z,t.recast=fr},function(r,t,e){"use strict";var n=e(1),a=e(36),i=e(2),o=e(84);function c(r,t,e){return o.make_printf(function(t,e){return o.output_acc(t,e),n._1(r,t)},t,0,e[0])}function u(r,t,e){return o.make_printf(function(t,e){return o.bufput_acc(t,e),n._1(r,t)},t,0,e[0])}function f(r,t,e){return o.make_printf(function(t,e){return n._1(r,t)},t,0,e[0])}function s(r,t){return c(function(){return 0},r,t)}function _(r,t){return o.make_printf(function(t,e){var i=a.create(64);return o.strput_acc(i,e),n._1(r,a.contents(i))},0,0,t[0])}var l=_;t.fprintf=s,t.printf=function(r){return s(i.stdout,r)},t.eprintf=function(r){return s(i.stderr,r)},t.sprintf=function(r){return _(function(r){return r},r)},t.bprintf=function(r,t){return u(function(){return 0},r,t)},t.ifprintf=function(r,t){return f(function(){return 0},r,t)},t.kfprintf=c,t.ikfprintf=f,t.ksprintf=_,t.kbprintf=u,t.kprintf=l},function(r,t,e){"use strict";t.keycodeMap=function(r){var t=r-8|0;if(t>214||t<0)return 65;switch(t){case 0:return 0;case 1:return 1;case 5:return 2;case 8:return 56;case 9:return 55;case 10:return 57;case 12:return 63;case 19:return 3;case 24:return 4;case 29:return 52;case 30:return 54;case 31:return 51;case 32:return 53;case 40:return 10;case 41:return 11;case 42:return 12;case 43:return 13;case 44:return 14;case 45:return 15;case 46:return 16;case 47:return 17;case 48:return 18;case 49:return 19;case 57:return 25;case 58:return 26;case 59:return 27;case 60:return 28;case 61:return 29;case 62:return 30;case 63:return 31;case 64:return 32;case 65:return 33;case 66:return 34;case 67:return 35;case 68:return 36;case 69:return 37;case 70:return 38;case 71:return 39;case 72:return 40;case 73:return 41;case 74:return 42;case 75:return 43;case 76:return 44;case 77:return 45;case 78:return 46;case 79:return 47;case 80:return 48;case 81:return 49;case 82:return 50;case 83:return 58;case 85:return 62;case 178:return 20;case 179:return 21;case 180:return 6;case 181:return 7;case 182:return 8;case 183:return 9;case 184:return 64;case 2:case 3:case 4:case 6:case 7:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 20:case 21:case 22:case 23:case 25:case 26:case 27:case 28:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 84:case 86:case 87:case 88:case 89:case 90:case 91:case 92:case 93:case 94:case 95:case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:case 123:case 124:case 125:case 126:case 127:case 128:case 129:case 130:case 131:case 132:case 133:case 134:case 135:case 136:case 137:case 138:case 139:case 140:case 141:case 142:case 143:case 144:case 145:case 146:case 147:case 148:case 149:case 150:case 151:case 152:case 153:case 154:case 155:case 156:case 157:case 158:case 159:case 160:case 161:case 162:case 163:case 164:case 165:case 166:case 167:case 168:case 169:case 170:case 171:case 172:case 173:case 174:case 175:case 176:case 177:case 185:case 186:case 187:case 188:case 189:case 190:case 191:case 192:case 193:case 194:case 195:case 196:case 197:case 198:case 199:case 200:case 201:case 202:case 203:case 204:case 205:case 206:case 207:case 208:case 209:case 210:return 65;case 211:return 22;case 212:return 23;case 213:return 24;case 214:return 5}}},function(r,t,e){"use strict";var n=e(4),a=e(10),i=e(38),o=e(7),c=e(71),u=e(12),f=e(0),s=e(13),_=e(19),l=e(33),m=e(5),v=e(22),d=e(23),g=e(67),h=e(66),y=e(65),p=e(64),b=e(63),w=e(14),x=e(62),k=e(32),M=e(29),S=e(56),C=e(55),P=e(30),T=e(54),A=e(53),D=e(52),V=e(6),U=e(8),N=e(2),L=e(51),B=e(50),F=e(49),I=e(47);function z(){return 0}function E(){var r=m.UMat3f[0](0),t=m.UVec3f[0](0);return[m.SVertexObject[1]([1],0),r,a.Vec2[6](0),t]}function q(r){var t=_.Directional[1](f.__(0,[a.Vec3[1](.4,.3,.3)]),0,0,0,0,0),e=_.PointLight[1](f.__(0,[d.pointLight]),0,0,0,[12],0);return _.ProgramLight[1](t,[e,0],r)}function R(r){var t=s.Hsl[5](s.fromFloats(.14,.09,.2)),e=s.Hsl[0](t);s.Hsl[1](e,20);var n=s.Hsl[0](e);return s.Hsl[4](n,.2),m.UVec3f[6](r[15],s.toVec3(s.Hsl[6](t))),m.UVec3f[6](r[16],s.toVec3(s.Hsl[6](e))),m.UVec3f[6](r[17],s.toVec3(s.Hsl[6](n))),r}function G(){var r=m.SVertexObject[1]([1],0),t=m.SVertexObject[1]([1],0),e=m.SVertexObject[0](n.VertexBuffer[0]([],[["position",2],[["fromDrop",0],0]],1),[n.IndexBuffer[0]([],1)]),a=V.caml_make_vect(U.imul(d.tileRows,d.tileCols),0),o=m.SceneTex[1](0,0,n.Texture[0](f.__(1,[[a],d.tileCols,d.tileRows]),0,1)),c=E(),u=m.UVec3f[0](0),s=i.setup(a),l=q(v.make(d.camera)),g=m.UVec4f[0](0),h=m.UVec3f[0](0),y=_.PointLight[1](f.__(1,[h]),[f.__(1,[c[3]])],0,[.4],[0],0),p=[l[0],[y,l[1]],l[2]],b=m.UVec3f[0](0),w=m.UVec3f[0](0),x=m.UVec3f[0](0);return R([a,0,k.FontLayout[0](P.make([1],0)),o,c,g,[E(),E(),E()],E(),r,e,u,t,l,h,p,b,w,x,s,m.UFloat[1](0)])}function H(r){var t=M.makeNode(d.tileCols,d.tileRows,r[12],[2],0,0,["sdfTiles"],0,0,0,0),e=S.makeNode(r[8]),n=C.makeNode(r[9]),a=I.makeNode(r[3]),i=A.makeNode(r[3],t),o=g.makeNode(r[4],t),c=F.makeNode(r[16],r[17],r[3],a,e,n,r[10],t,r[4],r[5],r[19]),u=T.makeNode(r[11]);return y.stacked(["boardLayout"],0,[f.__(3,[d.tileCols/d.tileRows])],0,0,0,0,[c,[i,[o,[u,0]]]])}function O(r){var t=h.AreaBetweenQuads[0](h.Quad[0](h.Point[0](-1,-.45,0),h.Point[0](1,-.7,0),h.Point[0](1,1,0),h.Point[0](-1,1,0)),h.Quad[0](h.Point[0](-.7,-.287,.5),h.Point[0](.8,-.34,.5),h.Point[0](.8,1,.5),h.Point[0](-.7,1,.5)));return y.stacked(0,0,[f.__(0,[f.__(0,[.22]),f.__(0,[1])])],0,0,[0],0,[p.make(h.AreaBetweenQuads[2](t,0,0),[f.__(0,[f.__(0,[1]),f.__(0,[.6])])],r[14],0),[L.makeNode(y.vertical(0,0,0,[f.__(1,[.015])],[f.__(2,[f.__(0,[0]),f.__(0,[0]),f.__(0,[0]),f.__(1,[.028])])],0,0,0,[0],[x.makeSimpleNode("HOLD","digitalt",r[2],[.27],0,[1],0,0,0,[.7],0,0),[B.makeNode(r[7],r[12]),0]]),[1],[1],[f.__(0,[f.__(0,[1]),f.__(0,[.6])])],0),0]])}function K(r){var t=h.AreaBetweenQuads[0](h.Quad[0](h.Point[0](-1,-.95,0),h.Point[0](1,-.7,0),h.Point[0](1,1,0),h.Point[0](-1,1,0)),h.Quad[0](h.Point[0](-.7,-.54,.5),h.Point[0](.8,-.5,.5),h.Point[0](.8,1,.5),h.Point[0](-.7,1,.5)));return y.stacked(0,0,[f.__(0,[f.__(0,[.22]),f.__(0,[1])])],0,0,[0],0,[p.make(h.AreaBetweenQuads[2](t,0,0),[f.__(0,[f.__(0,[1]),f.__(0,[.6])])],r[14],0),[L.makeNode(y.vertical(["nextElements"],0,0,[f.__(1,[.015])],[f.__(2,[f.__(0,[0]),f.__(0,[0]),f.__(0,[0]),f.__(1,[.028])])],0,0,0,[0],[x.makeSimpleNode("NEXT","digitalt",r[2],[.27],0,[1],0,["next"],0,[.7],0,0),[B.makeNode(V.caml_array_get(r[6],0),r[12]),[B.makeNode(V.caml_array_get(r[6],1),r[12]),[B.makeNode(V.caml_array_get(r[6],2),r[12]),0]]]]),[1],[1],[f.__(0,[f.__(0,[1]),f.__(0,[.6])])],0),0]])}function j(r){var t=k.block([1],0,["digitalt"],[.25],[s.fromFloats(1,1,1)],0,0,0,[k.styledText(0,0,[V.caml_array_get(i.colors,2)],0,"V"),[k.styledText(0,0,[V.caml_array_get(i.colors,3)],0,"i"),[k.styledText(0,0,[V.caml_array_get(i.colors,4)],0,"m"),[k.styledText(0,0,[V.caml_array_get(i.colors,5)],0,"t"),[k.styledText(0,0,[V.caml_array_get(i.colors,6)],0,"r"),[k.styledText(0,0,[V.caml_array_get(i.colors,7)],0,"i"),[k.styledText(0,0,[V.caml_array_get(i.colors,8)],0,"s"),[k.block(0,0,0,0,0,0,0,0,[k.styled(0,[.08],0,0,0,0,[k.text("Press N to play\n"),0]),[k.styled(0,[.06],0,0,0,0,[k.text("Press ? for help"),0]),0]]),0]]]]]]]]);return y.vertical(["startScreen"],0,0,0,0,0,0,0,[1],[x.makePartNode(t,r[2],[.5],0,0,0,0,0,0),0])}function W(r){var t=k.block([1],0,0,0,0,0,0,0,[k.styledText(0,[.235],0,0,"\n\n"),[k.styledText(0,[.26],0,0,"Pause"),0]]),e=k.block([1],0,0,0,0,0,0,0,[k.styledText(0,[.058],0,0,"\nPress Space to continue\nPress ? for help"),0]);return y.stacked(["pauseScreen"],0,0,[1],0,0,0,[y.vertical(0,0,0,0,0,0,0,0,0,[x.makePartNode(t,r[2],[.42],["pauseText"],0,[.6],0,0,0),[x.makePartNode(e,r[2],[.25],["pauseHelpText"],0,0,0,0,0),0]]),0])}function $(r){var t=k.block([1],0,0,0,0,0,0,0,[k.styledText(0,[.23],0,[1.4],"Game\nover"),0]),e=k.block([1],0,0,0,0,0,0,0,[k.styledText(0,[.045],0,[2.4],"\nPress N to start a new game\nPress ? for help"),0]);return y.stacked(["gameOverScreen"],0,0,[1],0,0,0,[y.vertical(0,0,0,0,0,0,0,0,0,[x.makePartNode(t,r[2],[.27],["gameOverText"],0,0,0,0,0),[x.makePartNode(e,r[2],[.15],["gameOverHelpText"],0,0,0,0,0),0]]),0])}function X(r){var t=k.blockStyle([2],[.45],0,0,0,0,0,0),e=k.blockStyle([0],[.55],0,0,[s.fromFloats(.75,.7,.8)],0,0,0),n=o.fold_left(function(r,n){return[k.block(0,0,0,0,0,0,0,[e],[k.text("- "+n[1]),0]),[k.block(0,0,0,0,0,0,0,[t],[k.text(n[0]),0]),r]]},0,[["Space","pause"],[["H","move left"],[["L","move right"],[["J","move down"],[["K","cancel down"],[["C","rotate clockwise"],[["S","rotate counter clockwise"],[[".","drop"],[["W","move block right"],[["B","move block left"],[["0","move leftmost"],[["$","move rightmost"],0]]]]]]]]]]]]),a=k.block(0,0,["digitalt"],[.12],0,0,0,0,[k.block(0,0,0,[.042],0,0,0,0,[k.text("\n"),o.rev(n)]),0]);return y.vertical(["helpScreen"],0,0,0,[f.__(1,[f.__(0,[.12]),f.__(0,[0])])],0,[1],0,0,[y.stacked(0,0,[f.__(3,[1/.23])],0,0,0,0,[x.makePartNode(k.block([1],0,0,0,0,0,0,0,[k.styled(0,[.12],0,0,0,0,[k.text("Help\n"),[k.styled(0,[.06],[s.fromFloats(.8,.85,.9)],0,0,0,[k.text("Press N to play"),0]),0]]),0]),r[2],[.23],["startHelp"],0,0,0,0,0),[x.makePartNode(k.block([1],0,0,0,0,0,0,0,[k.styled(0,[.12],0,0,0,0,[k.text("Help\n"),[k.styled(0,[.05],[s.fromFloats(.8,.85,.9)],0,0,0,[k.text("Press Space to continue"),0]),0]]),0]),r[2],[.23],["gameHelp"],0,0,[1],0,0),0]]),[x.makePartNode(a,r[2],[.47],0,0,0,0,0,0),0]])}function Q(r){var t=f.__(3,[24/26]);return y.stacked(["root"],0,[f.__(0,[f.__(0,[1]),f.__(0,[1])])],0,0,[1],0,[D.makeNode(r[15],[y.horizontal(["gameHorizontal"],0,[t],0,[1],[O(r),[H(r),[K(r),0]]]),0]),[c.makeNode(0),[j(r),[W(r),[X(r),[$(r),0]]]]]])}function Y(r,t){var e=m.make(r,t,Q(t),[0],0,0);m.queueDeps(e,e[5][2]);var n=b.anim(f.__(1,[m.getNodeUnsafe(e,"background"),"anim"]),f.__(0,[0,1]),0,[1],[1.5],0,0,0,0);return m.doAnim(e,n),e}function Z(r,t){return m.SVertexObject[2](r,t[0],[])}function J(r,t,e,n,c,f,_){var l=i.elTiles(t[0],t[4]),v=s.toArray(V.caml_array_get(i.colors,t[3])),d=t[1],g=t[2];m.UVec3f[4](r,e[3],v);var h=2/n,y=2/c,p=d*y-1,b=1+g*-h;a.Vec2[4](e[2],p,b);var x=_?a.Mat3[6](.65,.65,.325*p,.325*b):a.Mat3[5](p,b);if(m.UMat3f[2](r,e[1],x),f){var k=w.find(i.centerRadius,[t[0],t[4]]),M=p+k[0]*y,S=b+k[1]*h,C=k[2]*y,P=k[3]*h;m.UVec4f[3](r,f[0],a.Vec4[1](M,S,C,P))}var T=u.concat(o.map(function(r){var t=U.imul(r[1],-1)*h,e=r[0]*y;return[e,t-h,e+y,t-h,e+y,t,e,t]},l));return m.SVertexObject[2](r,e[0],T)}function rr(r,t,e,n){var a=2/d.tileRows,o=2/d.tileCols,c=u.fold_left(function(r,t){var e=t[0],c=r[1],f=r[0];if(e>i.beamNone){var s=f*o-1,_=-1+(f*o+o),l=1-(t[1]*a+a),m=1-e*a,v=n?[s,l,1,_,l,1,_,m,0,s,m,0]:[s,l,_,l,_,m,s,m];return[f+1|0,u.append(c,v)]}return[f+1|0,c]},[0,[]],t);return m.SVertexObject[2](r,e,c[1])}function tr(r,t,e){var n=2/d.tileRows,a=u.fold_left(function(r,t){return u.append(r,[-1,1-n*(t+1|0),1,1-n*(t+1|0),1,1-n*t,-1,1-n*t])},[],e);m.SVertexObject[2](r,t[11],a);var i=m.getNode(r,"tileBlink");return i?m.showNode(r,i[0]):0}function er(r){var t=m.getNode(r,"tileBlink");return t?m.hideNode(r,t[0]):0}function nr(r,t){if(r[18][4]){J(t,r[18][2],r[4],d.tileRows,d.tileCols,[r[5]],0),rr(t,r[18][13],r[8],0);var e=r[4][2],n=m.getNodeUnsafe(t,"grid")[29];if(n){var i=n[0];if(5===i.tag){var o=a.Mat3[2](i[0][0],a.Vec3[2](e,1));if(a.Vec3[9](o,.25),m.clearAnim(t,"elLightAnim"),r[18][5])m.UVec3f[4](t,r[13],o);else{var c,u=m.UVec3f[7](r[13]),_=r[18][17];if(_){var v=_[0];c=[v[5],v[3]]}else c=[0,0];var g=c[0]?(a.Vec3[8](u,a.Vec3[5](o)-(a.Vec3[5](o)-a.Vec3[5](u))/1.5),c[1]?b.anim(f.__(0,[r[13]]),f.__(2,[u,o]),["elLightAnim"],[2],[d.dropDownBeforeTouchDown],[2],0,0,0):b.anim(f.__(0,[r[13]]),f.__(2,[u,o]),["elLightAnim"],0,[d.dropDownBeforeTick/2],[2],0,0,0)):b.anim(f.__(0,[r[13]]),f.__(2,[u,o]),["elLightAnim"],0,[d.tickDuration/3],[3],0,0,0);m.doAnim(t,g)}}}}if(r[18][12]){var h=r[3][1][3];h&&(h[0][3]=1,m.queueUpdates(t,r[3][0]))}var y=r[18][17];if(y){var p=y[0];switch(p[0]){case 0:if(p[5]){var w=m.getNodeUnsafe(t,"dropBeams");rr(t,r[18][14],r[9],1),m.UVec3f[4](t,r[10],s.toVec3(r[18][15]));var x=b.anim(f.__(1,[w,"sinceDrop"]),f.__(0,[0,1]),0,[1],[d.dropAnimDuration],0,0,0,0);m.doAnim(t,x);var k=r[18].slice(),M=p.slice();k[17]=[(M[0]=1,M)],r[18]=k}else{tr(t,r,p[2]);var S=r[18].slice(),C=p.slice();S[17]=[(C[0]=2,C)],r[18]=S}break;case 1:var P=p[4]+t[4][2];if(p[3])if(P>=d.dropDownBeforeTouchDown){tr(t,r,p[2]);var T=r[18].slice();T[17]=[[2,p[1],p[2],p[3],P,p[5]]],r[18]=T}else{var A=r[18].slice(),D=p.slice();A[17]=[(D[4]=P,D)],r[18]=A}else if(P>=d.dropDownBeforeTick){m.UFloat[3](t,r[19],r[18][10]);var U=r[18].slice(),N=p.slice();U[17]=[(N[0]=3,N)],r[18]=U}else{var L=r[18].slice(),B=p.slice();L[17]=[(B[4]=P,B)],r[18]=L}break;case 2:var F=p[4]+t[4][2];if(F>=(0!==p[5]?d.dropDownBeforeTouchDown+d.blinkTime:d.blinkTime)){er(t),m.UFloat[3](t,r[19],r[18][10]);var I=r[18].slice(),z=p.slice();I[17]=[(z[0]=3,z)],r[18]=I}else{var E=r[18].slice(),q=p.slice();E[17]=[(q[4]=F,q)],r[18]=E}}}else if(r[18][5]){l.fold(function(e,n){return J(t,n,V.caml_array_get(r[6],e),3,4,0,1),e+1|0},0,r[18][18]);var R=r[18][3];R?J(t,R[0],r[7],3,4,0,1):Z(t,r[7])}var G=r[18].slice();return G[4]=0,G[5]=0,G[6]=0,G[12]=0,r[18]=G,r}function ar(r,t){var e=r.slice();return e[1]=t,e}function ir(r,t){var e=m.getNodeUnsafe(r,"mask");m.clearAnim(r,"maskAnim");var n=b.anim(f.__(1,[e,"anim"]),f.__(0,[0,t]),["maskAnim"],[1],[3],0,0,0,0);return m.showNode(r,e),m.doAnim(r,n)}function or(r,t,e){var n,a=r[18].slice();switch(r[18]=i.processAction((a[19]=e[2],a)),r[18][0]){case 1:var o=r[1];4!==o?0!==o?n=N.failwith("Starthelp should only be triggered from start screen"):(m.hideNodeByKey(t,"startScreen"),m.showNodeByKey(t,"helpScreen"),n=ar(r,4)):n=r;break;case 2:switch(r[1]){case 0:m.hideNodeByKey(t,"startScreen"),m.showNodeByKey(t,"helpScreen"),n=ar(r,3);break;case 1:m.hideNodeByKey(t,"gameHorizontal"),m.showNodeByKey(t,"helpScreen"),m.hideNodeByKey(t,"startHelp"),m.showNodeByKey(t,"gameHelp"),n=ar(r,3);break;case 2:m.hideNodeByKey(t,"gameHorizontal"),m.hideNodeByKey(t,"pauseScreen"),m.hideNodeByKey(t,"startHelp"),m.showNodeByKey(t,"gameHelp"),m.hideNodeByKey(t,"mask"),m.showNodeByKey(t,"helpScreen"),n=ar(r,3);break;case 3:n=r;break;case 4:n=N.failwith("Helpscreen from state not recognized");break;case 5:m.hideNodeByKey(t,"gameHorizontal"),m.hideNodeByKey(t,"gameOverScreen"),m.hideNodeByKey(t,"startHelp"),m.showNodeByKey(t,"gameHelp"),m.showNodeByKey(t,"helpScreen"),n=ar(r,3)}break;case 3:var c;switch(r[1]){case 0:m.hideNodeByKey(t,"startScreen"),m.showNodeByKey(t,"gameHorizontal"),c=ar(r,1);break;case 1:c=r;break;case 2:m.hideNodeByKey(t,"pauseScreen"),m.hideNodeByKey(t,"mask"),c=ar(r,1);break;case 3:m.hideNodeByKey(t,"helpScreen"),m.showNodeByKey(t,"gameHorizontal"),m.hideNodeByKey(t,"mask"),c=ar(r,1);break;case 4:m.hideNodeByKey(t,"helpScreen"),m.showNodeByKey(t,"gameHorizontal"),c=ar(r,1);break;case 5:m.hideNodeByKey(t,"gameOverScreen"),m.hideNodeByKey(t,"mask"),c=ar(r,1)}n=nr(c,t);break;case 4:var u=r[1];if(u>=3)n=N.failwith("Paused from other than game screen");else switch(u){case 0:n=N.failwith("Paused from other than game screen");break;case 1:ir(t,.6),m.showNodeByKey(t,"pauseScreen"),n=ar(r,2);break;case 2:n=r}break;case 0:case 5:n=r;break;case 6:var f=r[1];1!==f?n=f>=5?r:N.failwith("Game over from other than game screen"):(ir(t,1),m.showNodeByKey(t,"gameOverScreen"),n=ar(r,5))}return m.update(t),n}function cr(r,t){var e=r.slice(),n=r[18].slice();return n[1]=i.keyPressed(r[18],t),e[18]=n,e}var ur=n.Canvas[1](0),fr=ur[1],sr=ur[0];m.run(sr,fr,G,Y,or,[cr],[z],0),t.resize=z,t.makeElState=E,t.makeSceneLight=q,t.setBg=R,t.setup=G,t.createBoardNode=H,t.createLeftRow=O,t.createRightRow=K,t.createStartScreen=j,t.createPauseScreen=W,t.createGameOverScreen=$,t.createHelpScreen=X,t.createNextLevelScreen=function(r){return y.vertical(0,0,0,0,0,0,0,0,0,[x.makeSimpleNode("Level complete","digitalt",r[2],[.25],0,[1],0,["gameOver"],0,0,0,0),[x.makeSimpleNode("Press N to start new level","digitalt",r[2],[.08],0,[1],0,0,0,0,0,0),0]])},t.createRootNode=Q,t.createScene=Y,t.resetElState=Z,t.updateElTiles=J,t.updateBeams=rr,t.blinkInit=tr,t.blinkEnd=er,t.drawGame=nr,t.setScreenState=ar,t.showMask=ir,t.hideMask=function(r){return m.hideNodeByKey(r,"mask")},t.draw=or,t.keyPressed=cr,t.viewportX=sr,t.viewportY=fr}]);